{"version":3,"sources":["docs/js/main.js","../../src/core/directive.js","../../src/core/component.js","../../src/core/context.js","../../src/module/module.js","../../src/class/class.directive.js","../../src/event/event.directive.js","../../src/core/structure.js","../../src/for/for.item.js","../../src/for/for.structure.js","../../src/if/if.structure.js","../../src/inner-html/inner-html.directive.js","../../src/core/pipe.js","../../src/json/json.pipe.js","../../src/style/style.directive.js","../../src/core.module.js","../../src/platform/platform.js","../../src/platform/browser.js","../../test/js/local-storage/local-storage.service.js","../../test/js/store/store.service.js","../../test/js/app.component.js","../../test/js/date/date.pipe.js","../../test/js/colors/colors.js","../../test/js/todo-item/todo-item.component.js","../../test/js/app.module.js","../../test/js/main.js"],"names":["global","factory","exports","module","require","define","amd","self","rxjs","operators","this","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","_inheritsLoose","subClass","superClass","prototype","create","constructor","__proto__","_setPrototypeOf","o","p","setPrototypeOf","_construct","Parent","args","Class","Reflect","construct","sham","Proxy","Date","toString","call","e","isNativeReflectConstruct","a","push","apply","instance","Function","bind","arguments","Directive","Component","RESERVED_PROPERTIES","Context","_Component","descriptors","_this","mergeDescriptors","getPrototypeOf","defineProperties","ReferenceError","_assertThisInitialized","source","properties","getOwnPropertyNames","_loop","shift","indexOf","hasOwnProperty","getOwnPropertyDescriptor","value","_len","Array","_key","ID","CONTEXTS","NODES","Module","_proto","compile","node","parentInstance","componentNode","querySelectorsAll","meta","selectors","map","match","undefined","makeInstance","selector","filter","x","_this2","parentNode","isComponent","getParentInstance","initialized","context","makeContext","changes$","BehaviorSubject","unsubscribe$","Subject","pushChanges","next","parse","setTimeout","onView","makeHosts","inputs","makeInputs","outputs","makeOutputs","onInit","pipe","takeUntil","subscribe","changes","resolveInputsOutputs","onChanges","makeFunction","expression","params","parseExpression","join","rx1","replace","parsePipes","parseOptionalChaining","g1","trim","parsePipeParams","func","concat","segments","word","block","t","c","substr","previous","_len2","_key2","tokens","split","b","getInstance","document","window","getContextByNode","_this3","traverseUp","childNodes","child","nodeType","parseTextNode","_this4","expressions","nodeExpressions","parseTextNodeExpression","nodeValue","replacedText","reduce","resolve","textNode","createTextNode","replaceChild","matches","regex","lastIndex","pushFragment","from","to","fragment","substring","exec","index","expressionFunc","payload","hosts","keys","forEach","getHost","getContext","rxcompId","nodeContexts","makeInput","input","hasAttribute","getAttribute","_this5","makeOutput","_this6","outputFunction","output$","tap","event","_this7","inputFunction","destroy","remove","innerHTML","nodeInnerHTML","keepInstance","keepContext","traverseDown","deleteContext","rxcompNodeId","id","keepContexts","complete","onDestroy","matchSelectors","results","template","callback","result","j","traversePrevious","previousSibling","traverseNext","nextSibling","current","ClassDirective","_Directive","_getContext","classFunction","_getContext2","classList","add","EventDirective","event$","fromEvent","shareReplay","Structure","ForItem","_Context","$key","$value","count","Constructor","protoProps","staticProps","get","even","ForStructure","_Structure","forbegin","createComment","forend","insertBefore","removeAttribute","getExpressionTokens","forFunction","iterable","instances","isArray","array","total","Math","max","clonedNode","cloneNode","forItemContext","removeChild","forExpressions","keyValueMatches","indexExpressions","IfStructure","ifbegin","ifend","ifFunction","InnerHtmlDirective","Pipe","transform","JsonPipe","_Pipe","JSON","stringify","name","StyleDirective","styleFunction","style","setProperty","CoreModule","_Module","factories","pipes","declarations","ORDER","Browser","_Platform","Platform","bootstrap","moduleFactory","resolveMeta","querySelector","resolvePipes","resolveFactories","sortFactories","unshift","unwrapSelectors","assign","imports","exported","importedPipes","pipeFactory","_Array$prototype$conc","importedFactories","factoryList","sort","getExpressions","matchers","c1","a2","u3","v4","a5","e6","contains","nodeName","toLowerCase","excludes","matchSelector","unmatchSelector","includes","include","exclude","isBrowser","LocalStorageService","delete","isLocalStorageSupported","localStorage","removeItem","exist","console","log","set","cache","json","setItem","supported","StoreService","items","get$","store$","date","now","delay","add$","patch","item","getValue","of","patch$","find","delete$","splice","AppComponent","onInput","$event","onAddItem","onToggleItem","done","onRemoveItem","DatePipe","locale","options","dateStyle","timeStyle","toLocaleDateString","colors","hex","background","foreground","accent","hexToRgb","r","parseInt","slice","g","TodoItemComponent","alpha","onToggle","toggle","onRemove","AppModule"],"mappings":"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","file":"docs/js/main.min.js","sourcesContent":[null,"export default class Directive {\n\n}\n","export default class Component {\n\n}\n","// import { BehaviorSubject, Subject } from 'rxjs';\nimport Component from './component';\n\nconst RESERVED_PROPERTIES = ['constructor', 'rxcompId', 'onInit', 'onChanges', 'onDestroy', 'pushChanges', 'changes$', 'unsubscribe$'];\n\nexport default class Context extends Component {\n\n\tconstructor(instance, descriptors = {}) {\n\t\tsuper();\n\t\tdescriptors = Context.mergeDescriptors(instance, instance, descriptors);\n\t\tdescriptors = Context.mergeDescriptors(Object.getPrototypeOf(instance), instance, descriptors);\n\t\t/*\n\t\tconst subjects = {\n\t\t\tchanges$: {\n\t\t\t\tvalue: new BehaviorSubject(this),\n\t\t\t\twritable: false,\n\t\t\t\tenumerable: false,\n\t\t\t},\n\t\t\tunsubscribe$: {\n\t\t\t\tvalue: new Subject(),\n\t\t\t\twritable: false,\n\t\t\t\tenumerable: false,\n\t\t\t}\n\t\t};\n\t\t*/\n\t\tObject.defineProperties(this, descriptors);\n\t}\n\n\tstatic mergeDescriptors(source, instance, descriptors = {}) {\n\t\tconst properties = Object.getOwnPropertyNames(source);\n\t\twhile (properties.length) {\n\t\t\tlet key = properties.shift();\n\t\t\tif (RESERVED_PROPERTIES.indexOf(key) === -1 && !descriptors.hasOwnProperty(key)) {\n\t\t\t\t// console.log('Context.mergeDescriptors', key, source[key]);\n\t\t\t\tconst descriptor = Object.getOwnPropertyDescriptor(source, key);\n\t\t\t\tif (typeof descriptor.value == \"function\") {\n\t\t\t\t\tdescriptor.value = (...args) => {\n\t\t\t\t\t\treturn instance[key].apply(instance, args);\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\tdescriptors[key] = descriptor;\n\t\t\t}\n\t\t}\n\t\treturn descriptors;\n\t}\n\n}\n","import { BehaviorSubject, Subject } from 'rxjs';\nimport { takeUntil, tap } from 'rxjs/operators';\nimport Component from '../core/component';\nimport Context from '../core/context';\n\nlet ID = 0;\nconst CONTEXTS = {};\nconst NODES = {};\n\nexport default class Module {\n\n\tcompile(node, parentInstance) {\n\t\tlet componentNode;\n\t\tconst instances = Module.querySelectorsAll(node, this.meta.selectors, []).map(match => {\n\t\t\tif (componentNode && componentNode !== match.node) {\n\t\t\t\tparentInstance = undefined;\n\t\t\t}\n\t\t\tconst instance = this.makeInstance(match.node, match.factory, match.selector, parentInstance);\n\t\t\tif (match.factory.prototype instanceof Component) {\n\t\t\t\tcomponentNode = match.node;\n\t\t\t}\n\t\t\treturn instance;\n\t\t}).filter(x => x);\n\t\t// console.log('compile', instances, node, parentInstance);\n\t\treturn instances;\n\t}\n\n\tmakeInstance(node, factory, selector, parentInstance, args) {\n\t\tif (parentInstance || node.parentNode) {\n\t\t\tconst isComponent = factory.prototype instanceof Component;\n\t\t\tconst meta = factory.meta;\n\t\t\t// collect parentInstance scope\n\t\t\tparentInstance = parentInstance || this.getParentInstance(node.parentNode);\n\t\t\tif (!parentInstance) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// creating factory instance\n\t\t\tconst instance = new factory(...(args || []));\n\t\t\t// creating instance context\n\t\t\tconst context = Module.makeContext(this, instance, parentInstance, node, factory, selector);\n\t\t\t// injecting changes$ and unsubscribe$ subjects\n\t\t\tObject.defineProperties(instance, {\n\t\t\t\tchanges$: {\n\t\t\t\t\tvalue: new BehaviorSubject(instance),\n\t\t\t\t\twritable: false,\n\t\t\t\t\tenumerable: false,\n\t\t\t\t},\n\t\t\t\tunsubscribe$: {\n\t\t\t\t\tvalue: new Subject(),\n\t\t\t\t\twritable: false,\n\t\t\t\t\tenumerable: false,\n\t\t\t\t}\n\t\t\t});\n\t\t\tlet initialized;\n\t\t\t// injecting instance pushChanges method\n\t\t\tconst module = this;\n\t\t\tinstance.pushChanges = function() {\n\t\t\t\t// console.log(new Error(`pushChanges ${instance.constructor.name}`).stack);\n\t\t\t\tthis.changes$.next(this);\n\t\t\t\t// parse component text nodes\n\t\t\t\tif (isComponent) {\n\t\t\t\t\t// console.log('Module.parse', instance.constructor.name);\n\t\t\t\t\tinitialized ? module.parse(node, instance) : setTimeout(function() { module.parse(node, instance); });\n\t\t\t\t}\n\t\t\t\t// calling onView event\n\t\t\t\tif (typeof instance.onView === 'function') {\n\t\t\t\t\t// console.log('onView', instance.constructor.name);\n\t\t\t\t\tinstance.onView();\n\t\t\t\t}\n\t\t\t};\n\t\t\t// creating component input and outputs\n\t\t\t// if (isComponent && meta) {\n\t\t\tif (meta) {\n\t\t\t\tthis.makeHosts(meta, instance, node);\n\t\t\t\tcontext.inputs = this.makeInputs(meta, instance);\n\t\t\t\tcontext.outputs = this.makeOutputs(meta, instance);\n\t\t\t}\n\t\t\t// calling onInit event\n\t\t\tif (typeof instance.onInit === 'function') {\n\t\t\t\tinstance.onInit();\n\t\t\t}\n\t\t\tinitialized = true;\n\t\t\t// subscribe to parent changes\n\t\t\tif (parentInstance.changes$) {\n\t\t\t\tparentInstance.changes$.pipe(\n\t\t\t\t\t// filter(() => node.parentNode),\n\t\t\t\t\t// debounceTime(1),\n\t\t\t\t\ttakeUntil(instance.unsubscribe$)\n\t\t\t\t).subscribe(changes => {\n\t\t\t\t\t// resolve component input outputs\n\t\t\t\t\t// if (isComponent && meta) {\n\t\t\t\t\tif (meta) {\n\t\t\t\t\t\tthis.resolveInputsOutputs(instance, changes);\n\t\t\t\t\t}\n\t\t\t\t\t// calling onChanges event with parentInstance\n\t\t\t\t\tif (typeof instance.onChanges === 'function') {\n\t\t\t\t\t\t// console.log('onChanges', instance.constructor.name);\n\t\t\t\t\t\t// console.log('onChanges', instance.constructor.meta.selector, changes);\n\t\t\t\t\t\tinstance.onChanges(changes);\n\t\t\t\t\t}\n\t\t\t\t\t// push instance changes for subscribers\n\t\t\t\t\tinstance.pushChanges();\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn instance;\n\t\t}\n\t}\n\n\tmakeContext(instance, parentInstance, node, selector) {\n\t\tconst context = Module.makeContext(this, instance, parentInstance, node, instance.constructor, selector);\n\t\t// console.log('Module.makeContext', context, context.instance, context.node);\n\t\treturn context;\n\t}\n\n\tmakeFunction(expression, params = ['$instance']) {\n\t\tif (expression) {\n\t\t\texpression = Module.parseExpression(expression);\n\t\t\t// console.log(expression);\n\t\t\tconst args = params.join(',');\n\t\t\tconst expression_func = new Function(`with(this) {\n\t\t\t\treturn (function (${args}, $$module) {\n\t\t\t\t\tconst $$pipes = $$module.meta.pipes;\n\t\t\t\t\treturn ${expression};\n\t\t\t\t}.bind(this)).apply(this, arguments);\n\t\t\t}`);\n\t\t\t// console.log(expression_func);\n\t\t\treturn expression_func;\n\t\t} else {\n\t\t\treturn () => { return null; };\n\t\t}\n\t}\n\n\tstatic parseExpression(expression) {\n\t\tconst l = '┌';\n\t\tconst r = '┘';\n\t\tconst rx1 = /(\\()([^\\(\\)]*)(\\))/;\n\t\twhile (expression.match(rx1)) {\n\t\t\texpression = expression.replace(rx1, function(...g1) {\n\t\t\t\treturn `${l}${Module.parsePipes(g1[2])}${r}`;\n\t\t\t});\n\t\t}\n\t\texpression = Module.parsePipes(expression);\n\t\texpression = expression.replace(/(┌)|(┘)/g, function(...g2) {\n\t\t\treturn g2[1] ? '(' : ')';\n\t\t});\n\t\treturn Module.parseOptionalChaining(expression);\n\t}\n\n\tstatic parsePipes(expression) {\n\t\tconst l = '┌';\n\t\tconst r = '┘';\n\t\tconst rx1 = /(.*?)\\|([^\\|]*)/;\n\t\twhile (expression.match(rx1)) {\n\t\t\texpression = expression.replace(rx1, function(...g1) {\n\t\t\t\tconst value = g1[1].trim();\n\t\t\t\tconst params = Module.parsePipeParams(g1[2]);\n\t\t\t\tconst func = params.shift().trim();\n\t\t\t\treturn `$$pipes.${func}.transform┌${[value, ...params]}┘`;\n\t\t\t});\n\t\t}\n\t\treturn expression;\n\t}\n\n\tstatic parsePipeParams(expression) {\n\t\tconst segments = [];\n\t\tlet i = 0,\n\t\t\tword = '',\n\t\t\tblock = 0;\n\t\tconst t = expression.length;\n\t\twhile (i < t) {\n\t\t\tconst c = expression.substr(i, 1);\n\t\t\tif (c === '{' || c === '(' || c === '[') {\n\t\t\t\tblock++;\n\t\t\t}\n\t\t\tif (c === '}' || c === ')' || c === ']') {\n\t\t\t\tblock--;\n\t\t\t}\n\t\t\tif (c === ':' && block === 0) {\n\t\t\t\tif (word.length) {\n\t\t\t\t\tsegments.push(word.trim());\n\t\t\t\t}\n\t\t\t\tword = '';\n\t\t\t} else {\n\t\t\t\tword += c;\n\t\t\t}\n\t\t\ti++;\n\t\t}\n\t\tif (word.length) {\n\t\t\tsegments.push(word.trim());\n\t\t}\n\t\treturn segments;\n\t}\n\n\tstatic parseOptionalChaining(expression) {\n\t\tconst regex = /(\\w+(\\?\\.))+([\\.|\\w]+)/g;\n\t\tlet previous;\n\t\texpression = expression.replace(regex, function(...args) {\n\t\t\tconst tokens = args[0].split('?.');\n\t\t\tfor (let i = 0; i < tokens.length - 1; i++) {\n\t\t\t\tconst a = i > 0 ? `(${tokens[i]} = ${previous})` : tokens[i];\n\t\t\t\tconst b = tokens[i + 1];\n\t\t\t\tprevious = i > 0 ? `${a}.${b}` : `(${a} ? ${a}.${b} : void 0)`;\n\t\t\t}\n\t\t\treturn previous || '';\n\t\t});\n\t\treturn expression;\n\t}\n\n\tgetInstance(node) {\n\t\tif (node === document) {\n\t\t\treturn window;\n\t\t}\n\t\tconst context = getContextByNode(node);\n\t\tif (context) {\n\t\t\treturn context.instance;\n\t\t}\n\t}\n\n\tgetParentInstance(node) {\n\t\treturn Module.traverseUp(node, (node) => {\n\t\t\treturn this.getInstance(node);\n\t\t});\n\t}\n\n\tparse(node, instance) {\n\t\tfor (let i = 0; i < node.childNodes.length; i++) {\n\t\t\tconst child = node.childNodes[i];\n\t\t\tif (child.nodeType === 1) {\n\t\t\t\tconst context = getContextByNode(child);\n\t\t\t\tif (!context) {\n\t\t\t\t\tthis.parse(child, instance);\n\t\t\t\t}\n\t\t\t} else if (child.nodeType === 3) {\n\t\t\t\tthis.parseTextNode(child, instance);\n\t\t\t}\n\t\t}\n\t}\n\n\tparseTextNode(node, instance) {\n\t\tlet expressions = node.nodeExpressions;\n\t\tif (!expressions) {\n\t\t\texpressions = this.parseTextNodeExpression(node.nodeValue);\n\t\t}\n\t\tconst replacedText = expressions.reduce((p, c) => {\n\t\t\treturn p + (typeof c === 'function' ?\n\t\t\t\tthis.resolve(c, instance, instance) : c);\n\t\t}, '');\n\t\tif (node.nodeValue !== replacedText) {\n\t\t\tconst textNode = document.createTextNode(replacedText);\n\t\t\ttextNode.nodeExpressions = expressions;\n\t\t\tnode.parentNode.replaceChild(textNode, node);\n\t\t}\n\t}\n\n\tparseTextNodeExpression(expression) {\n\t\tconst expressions = [];\n\t\tconst regex = /\\{{2}((([^{}])|(\\{([^{}]|(\\{.*?\\}))+?\\}))*?)\\}{2}/g;\n\t\tlet lastIndex = 0,\n\t\t\tmatches;\n\t\tconst pushFragment = function(from, to) {\n\t\t\tconst fragment = expression.substring(from, to);\n\t\t\texpressions.push(fragment);\n\t\t};\n\t\twhile ((matches = regex.exec(expression)) !== null) {\n\t\t\tconst index = regex.lastIndex - matches[0].length;\n\t\t\tif (index > lastIndex) {\n\t\t\t\tpushFragment(index, lastIndex);\n\t\t\t}\n\t\t\tlastIndex = regex.lastIndex;\n\t\t\tconst fragment = this.makeFunction(matches[1]);\n\t\t\texpressions.push(fragment);\n\t\t}\n\t\tconst length = expression.length;\n\t\tif (length > lastIndex) {\n\t\t\tpushFragment(lastIndex, length);\n\t\t}\n\t\treturn expressions;\n\t}\n\n\tresolve(expressionFunc, changes, payload) {\n\t\treturn expressionFunc.apply(changes, [payload, this]);\n\t}\n\n\tmakeHosts(meta, instance, node) {\n\t\tif (meta.hosts) {\n\t\t\tObject.keys(meta.hosts).forEach(key => {\n\t\t\t\tconst factory = meta.hosts[key];\n\t\t\t\tinstance[key] = getHost(instance, factory, node);\n\t\t\t});\n\t\t}\n\t}\n\n\tmakeInput(instance, key) {\n\t\tconst { node } = getContext(instance);\n\t\tlet input, expression = null;\n\t\tif (node.hasAttribute(key)) {\n\t\t\texpression = `'${node.getAttribute(key).replace('{{','\\'+').replace('}}','+\\'')}'`;\n\t\t} else if (node.hasAttribute(`[${key}]`)) {\n\t\t\texpression = node.getAttribute(`[${key}]`);\n\t\t}\n\t\tif (expression !== null) {\n\t\t\tinput = this.makeFunction(expression);\n\t\t}\n\t\treturn input;\n\t}\n\n\tmakeInputs(meta, instance) {\n\t\tconst inputs = {};\n\t\tif (meta.inputs) {\n\t\t\tmeta.inputs.forEach((key, i) => {\n\t\t\t\tconst input = this.makeInput(instance, key);\n\t\t\t\tif (input) {\n\t\t\t\t\tinputs[key] = input;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\treturn inputs;\n\t}\n\n\tmakeOutput(instance, key) {\n\t\tconst context = getContext(instance);\n\t\tconst node = context.node;\n\t\tconst parentInstance = context.parentInstance;\n\t\tconst expression = node.getAttribute(`(${key})`);\n\t\tconst outputFunction = this.makeFunction(expression, ['$event']);\n\t\tconst output$ = new Subject().pipe(\n\t\t\ttap((event) => {\n\t\t\t\tthis.resolve(outputFunction, parentInstance, event);\n\t\t\t})\n\t\t);\n\t\toutput$.pipe(\n\t\t\ttakeUntil(instance.unsubscribe$)\n\t\t).subscribe();\n\t\tinstance[key] = output$;\n\t\treturn outputFunction;\n\t}\n\n\tmakeOutputs(meta, instance) {\n\t\tconst outputs = {};\n\t\tif (meta.outputs) {\n\t\t\tmeta.outputs.forEach((key, i) => outputs[key] = this.makeOutput(instance, key));\n\t\t}\n\t\treturn outputs;\n\t}\n\n\tresolveInputsOutputs(instance, changes) {\n\t\tconst context = getContext(instance);\n\t\tconst parentInstance = context.parentInstance;\n\t\tconst inputs = context.inputs;\n\t\tfor (let key in inputs) {\n\t\t\tconst inputFunction = inputs[key];\n\t\t\tconst value = this.resolve(inputFunction, parentInstance, instance);\n\t\t\tinstance[key] = value;\n\t\t}\n\t\t/*\n\t\tconst outputs = context.outputs;\n\t\tfor (let key in outputs) {\n\t\t\tconst inpuoutputFunctiontFunction = outputs[key];\n\t\t\tconst value = this.resolve(outputFunction, parentInstance, null);\n\t\t\t// console.log(`setted -> ${key}`, value);\n\t\t}\n\t\t*/\n\t}\n\n\tdestroy() {\n\t\tthis.remove(this.meta.node);\n\t\tthis.meta.node.innerHTML = this.meta.nodeInnerHTML;\n\t}\n\n\tremove(node, keepInstance) {\n\t\tconst keepContext = keepInstance ? getContext(keepInstance) : undefined;\n\t\tModule.traverseDown(node, (node) => {\n\t\t\tconst rxcompId = node.rxcompId;\n\t\t\tif (rxcompId) {\n\t\t\t\tconst keepContexts = Module.deleteContext(rxcompId, keepContext);\n\t\t\t\tif (keepContexts.length === 0) {\n\t\t\t\t\tdelete node.rxcompId;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\treturn node;\n\t}\n\n\tstatic makeContext(module, instance, parentInstance, node, factory, selector) {\n\t\tinstance.rxcompId = ++ID;\n\t\tconst context = { module, instance, parentInstance, node, factory, selector };\n\t\tconst rxcompNodeId = node.rxcompId = (node.rxcompId || instance.rxcompId);\n\t\tconst nodeContexts = NODES[rxcompNodeId] || (NODES[rxcompNodeId] = []);\n\t\tnodeContexts.push(context);\n\t\treturn CONTEXTS[instance.rxcompId] = context;\n\t}\n\n\tstatic deleteContext(id, keepContext) {\n\t\tconst keepContexts = [];\n\t\tconst nodeContexts = NODES[id];\n\t\tif (nodeContexts) {\n\t\t\tnodeContexts.forEach(context => {\n\t\t\t\tif (context === keepContext) {\n\t\t\t\t\tkeepContexts.push(keepContext);\n\t\t\t\t} else {\n\t\t\t\t\tconst instance = context.instance;\n\t\t\t\t\tinstance.unsubscribe$.next();\n\t\t\t\t\tinstance.unsubscribe$.complete();\n\t\t\t\t\tif (typeof instance.onDestroy === 'function') {\n\t\t\t\t\t\tinstance.onDestroy();\n\t\t\t\t\t\tdelete CONTEXTS[instance.rxcompId];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (keepContexts.length) {\n\t\t\t\tNODES[id] = keepContexts;;\n\t\t\t} else {\n\t\t\t\tdelete NODES[id];\n\t\t\t}\n\t\t}\n\t\treturn keepContexts;\n\t}\n\n\tstatic matchSelectors(node, selectors, results) {\n\t\tfor (let i = 0; i < selectors.length; i++) {\n\t\t\tconst match = selectors[i](node);\n\t\t\tif (match) {\n\t\t\t\tconst factory = match.factory;\n\t\t\t\tif (factory.prototype instanceof Component && factory.meta.template) {\n\t\t\t\t\tnode.innerHTML = factory.meta.template;\n\t\t\t\t}\n\t\t\t\tresults.push(match);\n\t\t\t}\n\t\t}\n\t\treturn results;\n\t}\n\n\tstatic querySelectorsAll(node, selectors, results) {\n\t\tif (node.nodeType === 1) {\n\t\t\tresults = this.matchSelectors(node, selectors, results);\n\t\t\tconst childNodes = node.childNodes;\n\t\t\tfor (let i = 0; i < childNodes.length; i++) {\n\t\t\t\tresults = this.querySelectorsAll(childNodes[i], selectors, results);\n\t\t\t}\n\t\t}\n\t\treturn results;\n\t}\n\n\tstatic traverseUp(node, callback, i = 0) {\n\t\tif (!node) {\n\t\t\treturn;\n\t\t}\n\t\tconst result = callback(node, i);\n\t\tif (result) {\n\t\t\treturn result;\n\t\t}\n\t\treturn this.traverseUp(node.parentNode, callback, i + 1);\n\t}\n\n\tstatic traverseDown(node, callback, i = 0) {\n\t\tif (!node) {\n\t\t\treturn;\n\t\t}\n\t\tlet result = callback(node, i);\n\t\tif (result) {\n\t\t\treturn result;\n\t\t}\n\t\tif (node.nodeType === 1) {\n\t\t\tlet j = 0,\n\t\t\t\tt = node.childNodes.length;\n\t\t\twhile (j < t && !result) {\n\t\t\t\tresult = this.traverseDown(node.childNodes[j], callback, i + 1);\n\t\t\t\tj++;\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tstatic traversePrevious(node, callback, i = 0) {\n\t\tif (!node) {\n\t\t\treturn;\n\t\t}\n\t\tconst result = callback(node, i);\n\t\tif (result) {\n\t\t\treturn result;\n\t\t}\n\t\treturn this.traversePrevious(node.previousSibling, callback, i + 1);\n\t}\n\n\tstatic traverseNext(node, callback, i = 0) {\n\t\tif (!node) {\n\t\t\treturn;\n\t\t}\n\t\tconst result = callback(node, i);\n\t\tif (result) {\n\t\t\treturn result;\n\t\t}\n\t\treturn this.traverseNext(node.nextSibling, callback, i + 1);\n\t}\n\n}\n\nexport function getContext(instance) {\n\treturn CONTEXTS[instance.rxcompId];\n}\n\nexport function getContextByNode(node) {\n\tlet context;\n\tconst nodeContexts = NODES[node.rxcompId];\n\tif (nodeContexts) {\n\t\tcontext = nodeContexts.reduce((previous, current) => {\n\t\t\tif (current.factory.prototype instanceof Component) {\n\t\t\t\treturn current;\n\t\t\t} else if (current.factory.prototype instanceof Context) {\n\t\t\t\treturn previous ? previous : current;\n\t\t\t} else {\n\t\t\t\treturn previous;\n\t\t\t}\n\t\t}, null);\n\t\t// console.log(node.rxcompId, context);\n\t}\n\treturn context;\n}\n\nexport function getHost(instance, factory, node) {\n\tif (!node) {\n\t\tnode = getContext(instance).node;\n\t}\n\tif (node.rxcompId) {\n\t\tconst nodeContexts = NODES[node.rxcompId];\n\t\tif (nodeContexts) {\n\t\t\t// console.log(nodeContexts);\n\t\t\tfor (let i = 0; i < nodeContexts.length; i++) {\n\t\t\t\tconst context = nodeContexts[i];\n\t\t\t\tif (context.instance !== instance) {\n\t\t\t\t\t// console.log(context.instance, instance);\n\t\t\t\t\tif (context.instance instanceof factory) {\n\t\t\t\t\t\treturn context.instance;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tif (node.parentNode) {\n\t\treturn getHost(instance, factory, node.parentNode);\n\t}\n}\n","import Directive from '../core/directive';\nimport { getContext } from '../module/module';\n\nexport default class ClassDirective extends Directive {\n\n\tonInit() {\n\t\tconst { module, node } = getContext(this);\n\t\tconst expression = node.getAttribute('[class]');\n\t\tthis.classFunction = module.makeFunction(expression);\n\t\t// console.log('ClassDirective.onInit', this.classList, expression);\n\t}\n\n\tonChanges(changes) {\n\t\tconst { module, node } = getContext(this);\n\t\tconst classList = module.resolve(this.classFunction, changes, this);\n\t\tfor (let key in classList) {\n\t\t\tclassList[key] ? node.classList.add(key) : node.classList.remove(key);\n\t\t}\n\t\t// console.log('ClassDirective.onChanges', classList);\n\t}\n\n}\n\nClassDirective.meta = {\n\tselector: `[[class]]`,\n};\n","import { fromEvent } from 'rxjs';\nimport { shareReplay, takeUntil } from 'rxjs/operators';\nimport Directive from '../core/directive';\nimport { getContext } from '../module/module';\n\nconst EVENTS = ['click', 'mousedown', 'mouseup', 'touchstart', 'touchmove', 'touchend', 'keydown', 'keyup', 'input', 'change', 'loaded'];\n\nexport default class EventDirective extends Directive {\n\n\tonInit() {\n\t\tconst { module, node, parentInstance, selector } = getContext(this);\n\t\tconst event = this.event = selector.replace(/\\[|\\]|\\(|\\)/g, '');\n\t\tconst event$ = this.event$ = fromEvent(node, event).pipe(shareReplay(1));\n\t\tconst expression = node.getAttribute(`(${event})`);\n\t\tif (expression) {\n\t\t\tconst outputFunction = module.makeFunction(expression, ['$event']);\n\t\t\tevent$.pipe(\n\t\t\t\ttakeUntil(this.unsubscribe$)\n\t\t\t).subscribe(event => {\n\t\t\t\t// console.log(parentInstance);\n\t\t\t\tmodule.resolve(outputFunction, parentInstance, event);\n\t\t\t});\n\t\t} else {\n\t\t\tparentInstance[`${event}$`] = event$;\n\t\t}\n\t\t// console.log('EventDirective.onInit', 'selector', selector, 'event', event);\n\t}\n\n}\n\nEventDirective.meta = {\n\tselector: `[(${EVENTS.join(')],[(')})]`,\n};\n","export default class Structure {\n\n}\n","import Context from '../core/context';\n\nexport default class ForItem extends Context {\n\n\t// !!! try with payload options { key, $key, value, $value, index, count } or use onInit()\n\n\tconstructor(key, $key, value, $value, index, count, parentInstance) {\n\t\t// console.log('ForItem', arguments);\n\t\tsuper(parentInstance);\n\t\t/*\n\t\tsuper(parentInstance, {\n\t\t\t[key]: {\n\t\t\t\tget: function() {\n\t\t\t\t\treturn this.$key;\n\t\t\t\t},\n\t\t\t\tset: function(key) {\n\t\t\t\t\tthis.$key = key;\n\t\t\t\t}\n\t\t\t},\n\t\t\t[value]: {\n\t\t\t\tget: function() {\n\t\t\t\t\treturn this.$value;\n\t\t\t\t},\n\t\t\t\tset: function(value) {\n\t\t\t\t\tthis.$value = value;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\t*/\n\t\tthis[key] = $key;\n\t\tthis[value] = $value;\n\t\tthis.index = index;\n\t\tthis.count = count;\n\t}\n\n\tget first() { return this.index === 0; }\n\n\tget last() { return this.index === this.count - 1; }\n\n\tget even() { return this.index % 2 === 0; }\n\n\tget odd() { return !this.even; }\n\n}\n","import Structure from '../core/structure';\nimport { getContext } from '../module/module';\nimport ForItem from './for.item';\n\nexport default class ForStructure extends Structure {\n\n\tonInit() {\n\t\tconst { module, node } = getContext(this);\n\t\tconst forbegin = this.forbegin = document.createComment(`*for begin`);\n\t\tforbegin.rxcompId = node.rxcompId;\n\t\tnode.parentNode.replaceChild(forbegin, node);\n\t\tconst forend = this.forend = document.createComment(`*for end`);\n\t\tforbegin.parentNode.insertBefore(forend, forbegin.nextSibling);\n\t\tconst expression = node.getAttribute('*for');\n\t\t// this.expression = expression;\n\t\tnode.removeAttribute('*for');\n\t\tconst tokens = this.tokens = this.getExpressionTokens(expression);\n\t\tthis.forFunction = module.makeFunction(tokens.iterable);\n\t\tthis.instances = [];\n\t}\n\n\tonChanges(changes) {\n\t\tconst context = getContext(this);\n\t\tconst module = context.module;\n\t\tconst node = context.node;\n\t\t// resolve\n\t\tconst tokens = this.tokens;\n\t\tlet result = module.resolve(this.forFunction, changes, this) || [];\n\t\tconst isArray = Array.isArray(result);\n\t\tconst array = isArray ? result : Object.keys(result);\n\t\tconst total = array.length;\n\t\tconst previous = this.instances.length;\n\t\t// let nextSibling = this.forbegin.nextSibling;\n\t\tfor (let i = 0; i < Math.max(previous, total); i++) {\n\t\t\tif (i < total) {\n\t\t\t\tconst key = isArray ? i : array[i];\n\t\t\t\tconst value = isArray ? array[key] : result[key];\n\t\t\t\tif (i < previous) {\n\t\t\t\t\t// update\n\t\t\t\t\tconst instance = this.instances[i];\n\t\t\t\t\tinstance[tokens.key] = key;\n\t\t\t\t\tinstance[tokens.value] = value;\n\t\t\t\t\t/*\n\t\t\t\t\tif (!nextSibling) {\n\t\t\t\t\t\tconst context = getContext(instance);\n\t\t\t\t\t\tconst node = context.node;\n\t\t\t\t\t\tthis.forend.parentNode.insertBefore(node, this.forend);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnextSibling = nextSibling.nextSibling;\n\t\t\t\t\t}\n\t\t\t\t\t*/\n\t\t\t\t} else {\n\t\t\t\t\t// create\n\t\t\t\t\tconst clonedNode = node.cloneNode(true);\n\t\t\t\t\tdelete clonedNode.rxcompId;\n\t\t\t\t\tthis.forend.parentNode.insertBefore(clonedNode, this.forend);\n\t\t\t\t\tconst args = [tokens.key, key, tokens.value, value, i, total, context.parentInstance]; // !!! context.parentInstance unused?\n\t\t\t\t\tconst instance = module.makeInstance(clonedNode, ForItem, context.selector, context.parentInstance, args);\n\t\t\t\t\tconst forItemContext = getContext(instance);\n\t\t\t\t\t// console.log('ForStructure', clonedNode, forItemContext.instance.constructor.name);\n\t\t\t\t\tmodule.compile(clonedNode, forItemContext.instance);\n\t\t\t\t\t// nextSibling = clonedNode.nextSibling;\n\t\t\t\t\tthis.instances.push(instance);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// remove\n\t\t\t\tconst instance = this.instances[i];\n\t\t\t\tconst { node } = getContext(instance);\n\t\t\t\tnode.parentNode.removeChild(node);\n\t\t\t\tmodule.remove(node);\n\t\t\t}\n\t\t}\n\t\tthis.instances.length = array.length;\n\t\t// console.log('ForStructure', this.instances, tokens);\n\t}\n\n\tgetExpressionTokens(expression) {\n\t\tif (expression === null) {\n\t\t\tthrow ('invalid for');\n\t\t}\n\t\tif (expression.trim().indexOf('let ') === -1 || expression.trim().indexOf(' of ') === -1) {\n\t\t\tthrow ('invalid for');\n\t\t}\n\t\tconst expressions = expression.split(';').map(x => x.trim()).filter(x => x !== '');\n\t\tconst forExpressions = expressions[0].split(' of ').map(x => x.trim());\n\t\tlet value = forExpressions[0].replace(/\\s*let\\s*/, '');\n\t\tconst iterable = forExpressions[1];\n\t\tlet key = 'index';\n\t\tconst keyValueMatches = value.match(/\\[(.+)\\s*,\\s*(.+)\\]/);\n\t\tif (keyValueMatches) {\n\t\t\tkey = keyValueMatches[1];\n\t\t\tvalue = keyValueMatches[2];\n\t\t}\n\t\tif (expressions.length > 1) {\n\t\t\tconst indexExpressions = expressions[1].split(/\\s*let\\s*|\\s*=\\s*index/).map(x => x.trim());\n\t\t\tif (indexExpressions.length === 3) {\n\t\t\t\tkey = indexExpressions[1];\n\t\t\t}\n\t\t}\n\t\treturn { key, value, iterable };\n\t}\n\n}\n\nForStructure.meta = {\n\tselector: '[*for]',\n};\n","import Structure from '../core/structure';\nimport { getContext } from '../module/module';\n\nexport default class IfStructure extends Structure {\n\n\tonInit() {\n\t\tconst { module, node } = getContext(this);\n\t\tconst ifbegin = this.ifbegin = document.createComment(`*if begin`);\n\t\tifbegin.rxcompId = node.rxcompId;\n\t\tnode.parentNode.replaceChild(ifbegin, node);\n\t\tconst ifend = this.ifend = document.createComment(`*if end`);\n\t\tifbegin.parentNode.insertBefore(ifend, ifbegin.nextSibling);\n\t\tconst expression = node.getAttribute('*if');\n\t\tthis.ifFunction = module.makeFunction(expression);\n\t\tconst clonedNode = node.cloneNode(true);\n\t\tclonedNode.removeAttribute('*if');\n\t\tthis.clonedNode = clonedNode;\n\t\tthis.node = clonedNode.cloneNode(true);\n\t\t// console.log('IfStructure.expression', expression);\n\t}\n\n\tonChanges(changes) {\n\t\tconst { module } = getContext(this);\n\t\t// console.log('IfStructure.onChanges', changes);\n\t\tconst value = module.resolve(this.ifFunction, changes, this);\n\t\tconst node = this.node;\n\t\tif (value) {\n\t\t\tif (!node.parentNode) {\n\t\t\t\tthis.ifend.parentNode.insertBefore(node, this.ifend);\n\t\t\t\tmodule.compile(node);\n\t\t\t}\n\t\t} else {\n\t\t\tif (node.parentNode) {\n\t\t\t\tmodule.remove(node, this);\n\t\t\t\tnode.parentNode.removeChild(node);\n\t\t\t\tthis.node = this.clonedNode.cloneNode(true);\n\t\t\t}\n\t\t}\n\t}\n\n}\n\nIfStructure.meta = {\n\tselector: '[*if]',\n};\n","import Directive from '../core/directive';\nimport { getContext } from '../module/module';\n\nexport default class InnerHtmlDirective extends Directive {\n\n\tonChanges(changes) {\n\t\tconst { node } = getContext(this);\n\t\tnode.innerHTML = this.innerHTML;\n\t}\n\n}\n\nInnerHtmlDirective.meta = {\n\tselector: `[innerHTML]`,\n\tinputs: ['innerHTML'],\n};\n","export default class Pipe {\n\n\tstatic transform(value) {\n\t\treturn value;\n\t}\n\n}\n","import Pipe from \"../core/pipe\";\n\nexport default class JsonPipe extends Pipe {\n\n\tstatic transform(value) {\n\t\treturn JSON.stringify(value, null, '\\t');\n\t}\n\n}\n\nJsonPipe.meta = {\n\tname: 'json',\n};\n","import Directive from '../core/directive';\nimport { getContext } from '../module/module';\n\nexport default class StyleDirective extends Directive {\n\n\tonInit() {\n\t\tconst { module, node } = getContext(this);\n\t\tconst expression = node.getAttribute('[style]');\n\t\tthis.styleFunction = module.makeFunction(expression);\n\t\t// console.log('StyleDirective.onInit', expression);\n\t}\n\n\tonChanges(changes) {\n\t\tconst { module, node } = getContext(this);\n\t\tconst style = module.resolve(this.styleFunction, changes, this);\n\t\tfor (let key in style) {\n\t\t\tnode.style.setProperty(key, style[key]);\n\t\t}\n\t\t// console.log('StyleDirective.onChanges', changes, style);\n\t}\n\n}\n\nStyleDirective.meta = {\n\tselector: `[[style]]`\n};\n","import ClassDirective from './class/class.directive';\nimport EventDirective from './event/event.directive';\nimport ForStructure from './for/for.structure';\nimport IfStructure from './if/if.structure';\nimport InnerHtmlDirective from './inner-html/inner-html.directive';\nimport JsonPipe from './json/json.pipe';\nimport Module from './module/module';\nimport StyleDirective from './style/style.directive';\n\nexport default class CoreModule extends Module {}\nconst factories = [\n\tClassDirective,\n\tEventDirective,\n\tForStructure,\n\tIfStructure,\n\tInnerHtmlDirective,\n\tStyleDirective,\n];\nconst pipes = [\n\tJsonPipe,\n];\nCoreModule.meta = {\n\tdeclarations: [\n\t\t...factories,\n\t\t...pipes,\n\t],\n\texports: [\n\t\t...factories,\n\t\t...pipes,\n\t]\n};\n","import Component from '../core/component';\nimport Directive from '../core/directive';\nimport Pipe from '../core/pipe';\nimport Structure from '../core/structure';\n\nconst ORDER = [Structure, Component, Directive];\n\nexport default class Platform {\n\n\tstatic bootstrap(moduleFactory) {\n\t\tconst meta = this.resolveMeta(moduleFactory);\n\t\tconst bootstrap = meta.bootstrap;\n\t\tif (!bootstrap) {\n\t\t\tthrow ('missing bootstrap');\n\t\t}\n\t\tconst node = meta.node = this.querySelector(bootstrap.meta.selector);\n\t\tif (!node) {\n\t\t\tthrow (`missing node ${bootstrap.meta.selector}`);\n\t\t}\n\t\tmeta.nodeInnerHTML = node.innerHTML;\n\t\tconst pipes = meta.pipes = this.resolvePipes(meta);\n\t\tconst factories = meta.factories = this.resolveFactories(meta);\n\t\tthis.sortFactories(factories);\n\t\tfactories.unshift(bootstrap);\n\t\tconst selectors = meta.selectors = this.unwrapSelectors(factories);\n\t\tconst module = new moduleFactory();\n\t\tmodule.meta = meta;\n\t\tconst instances = module.compile(node, window);\n\t\tconst root = instances[0];\n\t\t// if (root instanceof module.meta.bootstrap) {\n\t\troot.pushChanges();\n\t\t// }\n\t\treturn module;\n\t}\n\n\tstatic querySelector(selector) {\n\t\treturn document.querySelector(selector);\n\t}\n\n\tstatic resolveMeta(moduleFactory) {\n\t\tconst meta = Object.assign({ imports: [], declarations: [], pipes: [], exports: [] }, moduleFactory.meta);\n\t\tmeta.imports = meta.imports.map(moduleFactory => this.resolveMeta(moduleFactory));\n\t\treturn meta;\n\t}\n\n\tstatic resolvePipes(meta, exported) {\n\t\tconst importedPipes = meta.imports.map(meta => this.resolvePipes(meta, true));\n\t\tconst pipes = {};\n\t\tconst pipeList = (exported ? meta.exports : meta.declarations).filter(x => x.prototype instanceof Pipe);\n\t\tpipeList.forEach(pipeFactory => pipes[pipeFactory.meta.name] = pipeFactory);\n\t\treturn Object.assign({}, ...importedPipes, pipes);\n\t}\n\n\tstatic resolveFactories(meta, exported) {\n\t\tconst importedFactories = meta.imports.map(meta => this.resolveFactories(meta, true));\n\t\tconst factoryList = (exported ? meta.exports : meta.declarations).filter(x => (x.prototype instanceof Structure || x.prototype instanceof Component || x.prototype instanceof Directive));\n\t\treturn Array.prototype.concat.call(factoryList, ...importedFactories);\n\t}\n\n\tstatic sortFactories(factories) {\n\t\tfactories.sort((a, b) => {\n\t\t\tconst ai = ORDER.reduce((p, c, i) => a.prototype instanceof c ? i : p, -1);\n\t\t\tconst bi = ORDER.reduce((p, c, i) => b.prototype instanceof c ? i : p, -1);\n\t\t\t// return ai - bi;\n\t\t\tconst o = ai - bi;\n\t\t\tif (o === 0) {\n\t\t\t\treturn (a.meta.hosts ? 1 : 0) - (b.meta.hosts ? 1 : 0);\n\t\t\t}\n\t\t\treturn o;\n\t\t});\n\t}\n\n\tstatic getExpressions(selector) {\n\t\tlet matchers = [];\n\t\tselector.replace(/\\.([\\w\\-\\_]+)|\\[(.+?\\]*)(\\=)(.*?)\\]|\\[(.+?\\]*)\\]|([\\w\\-\\_]+)/g, function(value, c1, a2, u3, v4, a5, e6) {\n\t\t\tif (c1) {\n\t\t\t\tmatchers.push(function(node) {\n\t\t\t\t\treturn node.classList.contains(c1);\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (a2) {\n\t\t\t\tmatchers.push(function(node) {\n\t\t\t\t\treturn (node.hasAttribute(a2) && node.getAttribute(a2) === v4) ||\n\t\t\t\t\t\t(node.hasAttribute(`[${a2}]`) && node.getAttribute(`[${a2}]`) === v4);\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (a5) {\n\t\t\t\tmatchers.push(function(node) {\n\t\t\t\t\treturn node.hasAttribute(a5) || node.hasAttribute(`[${a5}]`);\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (e6) {\n\t\t\t\tmatchers.push(function(node) {\n\t\t\t\t\treturn node.nodeName.toLowerCase() === e6.toLowerCase();\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\treturn matchers;\n\t}\n\n\tstatic unwrapSelectors(factories) {\n\t\tconst selectors = [];\n\t\tfactories.forEach(factory => {\n\t\t\tfactory.meta.selector.split(',').forEach(selector => {\n\t\t\t\tselector = selector.trim();\n\t\t\t\tlet excludes = [];\n\t\t\t\tconst matchSelector = selector.replace(/\\:not\\((.+?)\\)/g, (value, unmatchSelector) => {\n\t\t\t\t\texcludes = this.getExpressions(unmatchSelector);\n\t\t\t\t\treturn '';\n\t\t\t\t});\n\t\t\t\tconst includes = this.getExpressions(matchSelector);\n\t\t\t\tselectors.push((node) => {\n\t\t\t\t\tconst include = includes.reduce((result, e) => {\n\t\t\t\t\t\treturn result && e(node);\n\t\t\t\t\t}, true);\n\t\t\t\t\tconst exclude = excludes.reduce((result, e) => {\n\t\t\t\t\t\treturn result || e(node);\n\t\t\t\t\t}, false);\n\t\t\t\t\tif (include && !exclude) {\n\t\t\t\t\t\treturn { node, factory, selector };\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t\treturn selectors;\n\t}\n\n\tstatic isBrowser() {\n\t\treturn window;\n\t}\n\n\t// static isServer() {}\n\n}\n","import Platform from './platform';\n\nexport default class Browser extends Platform {}\n","export default class LocalStorageService {\n\n\tstatic delete(name) {\n\t\tif (this.isLocalStorageSupported()) {\n\t\t\twindow.localStorage.removeItem(name);\n\t\t}\n\t}\n\n\tstatic exist(name) {\n\t\tif (this.isLocalStorageSupported()) {\n\t\t\treturn window.localStorage[name] !== undefined;\n\t\t}\n\t}\n\n\tstatic get(name) {\n\t\tlet value = null;\n\t\tif (this.isLocalStorageSupported() && window.localStorage[name] !== undefined) {\n\t\t\ttry {\n\t\t\t\tvalue = JSON.parse(window.localStorage[name]);\n\t\t\t} catch (e) {\n\t\t\t\tconsole.log('LocalStorageService.get.error parsing', name, e);\n\t\t\t}\n\t\t}\n\t\treturn value;\n\t}\n\n\tstatic set(name, value) {\n\t\tif (this.isLocalStorageSupported()) {\n\t\t\ttry {\n\t\t\t\tconst cache = [];\n\t\t\t\tconst json = JSON.stringify(value, function(key, value) {\n\t\t\t\t\tif (typeof value === 'object' && value !== null) {\n\t\t\t\t\t\tif (cache.indexOf(value) !== -1) {\n\t\t\t\t\t\t\t// Circular reference found, discard key\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcache.push(value);\n\t\t\t\t\t}\n\t\t\t\t\treturn value;\n\t\t\t\t});\n\t\t\t\twindow.localStorage.setItem(name, json);\n\t\t\t} catch (e) {\n\t\t\t\tconsole.log('LocalStorageService.set.error serializing', name, value, e);\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic isLocalStorageSupported() {\n\t\tif (this.supported) {\n\t\t\treturn true;\n\t\t}\n\t\tlet supported = false;\n\t\ttry {\n\t\t\tsupported = 'localStorage' in window && window.localStorage !== null;\n\t\t\tif (supported) {\n\t\t\t\twindow.localStorage.setItem('test', '1');\n\t\t\t\twindow.localStorage.removeItem('test');\n\t\t\t} else {\n\t\t\t\tsupported = false;\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tsupported = false;\n\t\t}\n\t\tthis.supported = supported;\n\t\treturn supported;\n\t}\n\n}\n","import { BehaviorSubject, of } from 'rxjs';\nimport { delay } from 'rxjs/operators';\nimport LocalStorageService from '../local-storage/local-storage.service';\n\nexport default class StoreService {\n\n\tstatic set(items) {\n\t\tLocalStorageService.set('items', items);\n\t\treturn this.get$().next(items);\n\t}\n\n\tstatic get$() {\n\t\tif (this.store$) {\n\t\t\treturn this.store$;\n\t\t}\n\t\tlet items = LocalStorageService.get('items');\n\t\tif (!items) {\n\t\t\titems = [\n\t\t\t\t{ id: 5, name: 'Cookies', date: new Date(Date.now()) },\n\t\t\t\t{ id: 4, name: 'Pizza', date: new Date(2019, 4, 4, 12) },\n\t\t\t\t{ id: 3, name: 'Pasta', date: new Date(2019, 3, 22, 12) },\n\t\t\t\t{ id: 2, name: 'Bread', date: new Date(2019, 0, 6, 12) },\n\t\t\t\t{ id: 1, name: 'Ham', date: new Date(2018, 11, 30, 12) },\n\t\t\t];\n\t\t\tLocalStorageService.set('items', items);\n\t\t}\n\t\tthis.store$ = new BehaviorSubject(items);\n\t\treturn this.store$.pipe(\n\t\t\tdelay(1) // simulate http\n\t\t);\n\t}\n\n\tstatic add$(patch) {\n\t\tconst item = Object.assign({\n\t\t\tid: Date.now(),\n\t\t\tdate: new Date(Date.now())\n\t\t}, patch);\n\t\tconst items = this.store$.getValue();\n\t\titems.unshift(item);\n\t\tthis.set(items);\n\t\treturn of(item).pipe(\n\t\t\tdelay(1) // simulate http\n\t\t);\n\t}\n\n\tstatic patch$(patch) {\n\t\tconst items = this.store$.getValue();\n\t\tconst item = items.find(x => x.id === patch.id);\n\t\tif (item) {\n\t\t\tObject.assign(item, patch);\n\t\t\tthis.set(items);\n\t\t}\n\t\treturn of(item).pipe(\n\t\t\tdelay(1) // simulate http\n\t\t);\n\t}\n\n\tstatic delete$(item) {\n\t\tconst items = this.store$.getValue();\n\t\tconst index = items.indexOf(item);\n\t\tif (index !== -1) {\n\t\t\titems.splice(index, 1);\n\t\t\tthis.set(items);\n\t\t}\n\t\treturn of(item).pipe(\n\t\t\tdelay(1) // simulate http\n\t\t);\n\t}\n\n}\n","import { takeUntil } from 'rxjs/operators';\nimport { Component, getContext } from '../../src/rxcomp';\nimport StoreService from './store/store.service';\n\nexport default class AppComponent extends Component {\n\n\tonInit() {\n\t\t// context\n\t\tconst context = getContext(this);\n\t\t// input\n\t\tthis.input = context.node.querySelector('.control--text');\n\t\t// items\n\t\tthis.items = [];\n\t\t// store service\n\t\tthis.store$ = StoreService.get$();\n\t\tthis.store$.pipe(\n\t\t\ttakeUntil(this.unsubscribe$)\n\t\t).subscribe(items => {\n\t\t\tthis.items = items;\n\t\t\t// onpush change detection strategy\n\t\t\tthis.pushChanges();\n\t\t});\n\t}\n\n\tonInput($event) {\n\t\t// console.log('AppComponent.onInput', $event, this);\n\t\tthis.pushChanges();\n\t}\n\n\tonAddItem($event) {\n\t\tif (this.input.value) {\n\t\t\tStoreService.add$({\n\t\t\t\tname: this.input.value,\n\t\t\t}).subscribe(item => {\n\t\t\t\t// console.log('AppComponent.onAddItem', item);\n\t\t\t\tthis.input.value = null;\n\t\t\t});\n\t\t}\n\t}\n\n\tonToggleItem(item) {\n\t\tStoreService.patch$({\n\t\t\tid: item.id,\n\t\t\tdone: !item.done,\n\t\t}).subscribe(item => {\n\t\t\t// console.log('AppComponent.onToggleItem', item);\n\t\t});\n\t}\n\n\tonRemoveItem(item) {\n\t\tStoreService.delete$(item).subscribe(item => {\n\t\t\t// console.log('AppComponent.onRemoveItem', item);\n\t\t});\n\t}\n\n}\n\nAppComponent.meta = {\n\tselector: '[app-component]',\n};\n","import { Pipe } from \"../../../src/rxcomp\";\n\nexport default class DatePipe extends Pipe {\n\n\tstatic transform(value, locale = 'it-IT-u-ca-gregory', options = {\n\t\tdateStyle: 'short',\n\t\ttimeStyle: 'short',\n\t}) {\n\t\tconst localeDateString = new Date(value).toLocaleDateString(locale, options);\n\t\treturn localeDateString;\n\t}\n\n}\n\nDatePipe.meta = {\n\tname: 'date',\n};\n","export const colors = [\n\t{ hex: '#ffffff', background: '#ffffff', foreground: '#003adc', accent: '#212121' },\n\t{ hex: '#212121', background: '#212121', foreground: '#ffffff', accent: '#003adc' },\n\t{ hex: '#ffffff', background: '#ffffff', foreground: '#212121', accent: '#003adc' },\n\t{ hex: '#003adc', background: '#003adc', foreground: '#ffffff', accent: '#212121' },\n];\n\nexport function hexToInt(hex) {\n\treturn parseInt(hex.replace(/^#/, ''), 16);\n}\n\nexport function randomHex() {\n\treturn colors[Math.floor(Math.random() * colors.length)].hex;\n}\n\nexport function randomColor() {\n\tconst hex = randomHex();\n\treturn hexToInt(hex);\n}\n\nexport function color(index, alpha) {\n\treturn hexToRgb(colors[index % colors.length].hex, alpha);\n}\n\nexport function background(index, alpha) {\n\treturn hexToRgb(colors[index % colors.length].background, alpha);\n}\n\nexport function foreground(index, alpha) {\n\treturn hexToRgb(colors[index % colors.length].foreground, alpha);\n}\n\nexport function accent(index, alpha) {\n\treturn hexToRgb(colors[index % colors.length].accent, alpha);\n}\n\nlet index = -1;\n\nexport function nextHex() {\n\tindex++;\n\treturn colors[index % colors.length].hex;\n}\n\nexport function nextColor() {\n\tconst hex = nextHex();\n\treturn hexToInt(hex);\n}\n\nexport function hexToRgb(hex, a) {\n\tconst r = parseInt(hex.slice(1, 3), 16);\n\tconst g = parseInt(hex.slice(3, 5), 16);\n\tconst b = parseInt(hex.slice(5, 7), 16);\n\tif (a) {\n\t\treturn `rgba(${r},${g},${b},${a})`;\n\t} else {\n\t\treturn `rgb(${r},${g},${b})`;\n\t}\n}\n","import { Component } from '../../../src/rxcomp';\nimport { accent, background, foreground } from '../colors/colors';\n\nexport default class TodoItemComponent extends Component {\n\n\t// onInit() {}\n\n\tonChanges(changes) {\n\t\t// console.log('onChanges', changes);\n\t\tthis.background = background(this.item.id);\n\t\tthis.foreground = foreground(this.item.id);\n\t\tthis.accent = accent(this.item.id);\n\t}\n\n\t// onView() {}\n\n\t// onDestroy() {}\n\n\tonToggle($event) {\n\t\t// console.log('onToggle', $event);\n\t\tthis.toggle.next($event);\n\t}\n\n\tonRemove($event) {\n\t\t// console.log('onRemove', $event);\n\t\tthis.remove.next($event);\n\t}\n\n}\n\nTodoItemComponent.meta = {\n\tselector: '[todo-item-component]',\n\tinputs: ['item'],\n\toutputs: ['toggle', 'remove'],\n\t// template syntax example\n\t/*\n\ttemplate: // html // `\n\t\t<div class=\"content\" [style]=\"{ background: background, color: foreground, '--accent': accent }\">\n\t\t\t<button type=\"button\" class=\"btn--toggle\" (click)=\"onToggle(item)\">\n\t\t\t\t<i class=\"icon--check\" *if=\"item.done\"></i>\n\t\t\t\t<i class=\"icon--circle\" *if=\"!item.done\"></i>\n\t\t\t\t<div class=\"title\" [innerHTML]=\"item.name\"></div>\n\t\t\t</button>\n\t\t\t<div class=\"date\" [style]=\"{ background: backgroundColor, color: color }\" [innerHTML]=\"item.date | date : 'en-US' : { month: 'short', day: '2-digit', year: 'numeric' }\"></div>\n\t\t\t<button type=\"button\" class=\"btn--remove\" (click)=\"onRemove(item)\"><i class=\"icon--remove\"></i></button>\n\t\t</div>\n\t`,\n\t*/\n};\n","import { CoreModule, Module } from '../../src/rxcomp';\nimport AppComponent from './app.component';\nimport DatePipe from './date/date.pipe';\nimport TodoItemComponent from './todo-item/todo-item.component';\n\nexport default class AppModule extends Module {}\n\nAppModule.meta = {\n\timports: [\n\t\tCoreModule\n\t],\n\tdeclarations: [\n\t\tTodoItemComponent,\n\t\tDatePipe,\n\t],\n\tbootstrap: AppComponent,\n};\n","import { Browser } from '../../src/rxcomp';\nimport AppModule from './app.module';\n\nBrowser.bootstrap(AppModule);\n"]}