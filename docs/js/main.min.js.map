{"version":3,"sources":["docs/js/main.js","../../src/core/directive.ts","../../src/core/component.ts","../../src/core/context.js","../../src/core/structure.js","../../src/module/module.ts","../../src/class/class.directive.js","../../src/event/event.directive.js","../../src/for/for.item.js","../../src/for/for.structure.js","../../src/href/href.directive.js","../../src/if/if.structure.js","../../src/inner-html/inner-html.directive.js","../../src/core/pipe.ts","../../src/json/json.pipe.js","../../src/src/src.directive.js","../../src/style/style.directive.js","../../src/core.module.js","../../src/platform/platform.js","../../src/platform/browser.js","../../test/js/local-storage/local-storage.service.js","../../test/js/store/store.service.ts","../../test/js/app.component.ts","../../test/js/date/date.pipe.js","../../test/js/colors/colors.js","../../test/js/todo-item/todo-item.component.js","../../test/js/app.module.ts","../../test/js/main.ts"],"names":["global","factory","exports","module","require","define","amd","self","rxjs","operators","this","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","_inheritsLoose","subClass","superClass","prototype","create","constructor","__proto__","Directive","extendStatics","d","b","setPrototypeOf","Array","p","hasOwnProperty","__extends","__","__spreadArrays","s","il","arguments","r","k","a","j","jl","Component","RESERVED_PROPERTIES","Context","_Component","instance","descriptors","_this","call","mergeDescriptors","getPrototypeOf","defineProperties","ReferenceError","_assertThisInitialized","source","properties","getOwnPropertyNames","_loop","shift","indexOf","getOwnPropertyDescriptor","value","_len","args","_key","apply","Structure","ID","CONTEXTS","NODES","Module","compile","node","parentInstance","componentNode","querySelectorsAll","meta","selectors","map","match","undefined","makeInstance","selector","filter","x","parentNode","isComponent_1","meta_1","getParentInstance","initialized_1","instance_1","bind","context","makeContext","changes$","BehaviorSubject","unsubscribe$","Subject","module_1","pushChanges","next","parse","setTimeout","onView","makeHosts","inputs","makeInputs","outputs","makeOutputs","onInit","pipe","takeUntil","subscribe","changes","resolveInputsOutputs","onChanges","makeFunction","expression","params","parseExpression","join","Function","getInstance","document","window","getContextByNode","traverseUp","childNodes","child","nodeType","parseTextNode","expressions","nodeExpressions","parseTextNodeExpression","nodeValue","replacedText","reduce","c","text","resolve","textNode","createTextNode","replaceChild","matches","regex","lastIndex","pushFragment","from","to","fragment","substring","push","exec","index","expressionFunc","payload","hosts","keys","forEach","getHost","getContext","rxcompId","nodeContexts","makeInput","input","hasAttribute","getAttribute","replace","makeOutput","outputFunction","output$","tap","event","inputFunction","destroy","remove","innerHTML","nodeInnerHTML","keepInstance","keepContext","traverseDown","deleteContext","rx1","g1","_i","parsePipes","g2","parseOptionalChaining","trim","parsePipeParams","func","segments","word","block","t","substr","previous","tokens","split","rxcompNodeId","id","keepContexts","complete","onDestroy","matchSelectors","results","template","concat","find","callback","result","traversePrevious","previousSibling","traverseNext","nextSibling","current","ClassDirective","_Directive","_proto","_getContext","classFunction","_getContext2","classList","add","EventDirective","event$","fromEvent","shareReplay","ForItem","_Context","$key","$value","count","Constructor","protoProps","staticProps","get","even","ForStructure","_Structure","forbegin","createComment","forend","insertBefore","removeAttribute","getExpressionTokens","forFunction","iterable","instances","isArray","array","total","Math","max","clonedNode","cloneNode","forItemContext","removeChild","forExpressions","keyValueMatches","indexExpressions","HrefDirective","setAttribute","href","IfStructure","ifbegin","ifend","ifFunction","InnerHtmlDirective","Pipe","transform","JsonPipe","_Pipe","JSON","stringify","name","SrcDirective","src","StyleDirective","styleFunction","style","setProperty","CoreModule","_Module","factories","pipes","declarations","ORDER","Browser","_Platform","Platform","bootstrap","moduleFactory","resolveMeta","querySelector","resolvePipes","resolveFactories","sortFactories","unshift","unwrapSelectors","assign","imports","exported","_this2","importedPipes","pipeFactory","_Array$prototype$conc","_this3","importedFactories","factoryList","sort","o","getExpressions","matchers","c1","a2","u3","v4","a5","e6","contains","nodeName","toLowerCase","_this4","excludes","matchSelector","unmatchSelector","includes","include","e","exclude","isBrowser","LocalStorageService","delete","isLocalStorageSupported","localStorage","removeItem","exist","console","log","set","cache","json","setItem","supported","StoreService","items","get$","store$","date","Date","now","delay","add$","patch","item","getValue","of","patch$","delete$","splice","AppComponent","_super","onInput","$event","onAddItem","onToggleItem","done","onRemoveItem","DatePipe","locale","options","dateStyle","timeStyle","toLocaleDateString","colors","hex","background","foreground","accent","hexToRgb","parseInt","slice","g","TodoItemComponent","alpha","onToggle","toggle","onRemove","AppModule"],"mappings":"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","file":"docs/js/main.min.js","sourcesContent":[null,"export default class Directive {\n\tstatic meta: any;\n}\n","import { Subject } from \"rxjs\";\n\nexport class ComponentMeta {\n\tselector: string;\n\tinputs?: string[];\n\toutputs?: string[];\n\ttemplate?: string;\n}\n\nexport default class Component {\n\tunsubscribe$: Subject<void>;\n\tpushChanges: Function;\n\tstatic meta: ComponentMeta;\n}\n","// import { BehaviorSubject, Subject } from 'rxjs';\nimport Component from './component';\n\nconst RESERVED_PROPERTIES = ['constructor', 'rxcompId', 'onInit', 'onChanges', 'onDestroy', 'pushChanges', 'changes$', 'unsubscribe$'];\n\nexport default class Context extends Component {\n\n\tconstructor(instance, descriptors = {}) {\n\t\tsuper();\n\t\tdescriptors = Context.mergeDescriptors(instance, instance, descriptors);\n\t\tdescriptors = Context.mergeDescriptors(Object.getPrototypeOf(instance), instance, descriptors);\n\t\t/*\n\t\tconst subjects = {\n\t\t\tchanges$: {\n\t\t\t\tvalue: new BehaviorSubject(this),\n\t\t\t\twritable: false,\n\t\t\t\tenumerable: false,\n\t\t\t},\n\t\t\tunsubscribe$: {\n\t\t\t\tvalue: new Subject(),\n\t\t\t\twritable: false,\n\t\t\t\tenumerable: false,\n\t\t\t}\n\t\t};\n\t\t*/\n\t\tObject.defineProperties(this, descriptors);\n\t}\n\n\tstatic mergeDescriptors(source, instance, descriptors = {}) {\n\t\tconst properties = Object.getOwnPropertyNames(source);\n\t\twhile (properties.length) {\n\t\t\tlet key = properties.shift();\n\t\t\tif (RESERVED_PROPERTIES.indexOf(key) === -1 && !descriptors.hasOwnProperty(key)) {\n\t\t\t\t// console.log('Context.mergeDescriptors', key, source[key]);\n\t\t\t\tconst descriptor = Object.getOwnPropertyDescriptor(source, key);\n\t\t\t\tif (typeof descriptor.value == \"function\") {\n\t\t\t\t\tdescriptor.value = (...args) => {\n\t\t\t\t\t\treturn instance[key].apply(instance, args);\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\tdescriptors[key] = descriptor;\n\t\t\t}\n\t\t}\n\t\treturn descriptors;\n\t}\n\n}\n","export default class Structure {\n\n}\n","import { BehaviorSubject, Subject } from 'rxjs';\nimport { takeUntil, tap } from 'rxjs/operators';\nimport Component from '../core/component';\nimport Context from '../core/context';\nimport Structure from '../core/structure';\n\nlet ID = 0;\nconst CONTEXTS = {};\nconst NODES = {};\n\nclass ModuleContext {\n\tmodule: Module;\n\tinstance: Function;\n\tparentInstance: Function;\n\tnode: HTMLElement;\n\tfactory: Function;\n\tselector: string;\n\tinputs?: {};\n\toutputs?: {};\n}\n\nexport default class Module {\n\n\tmeta: any;\n\n\tcompile(node, parentInstance) {\n\t\tlet componentNode;\n\t\tconst instances = Module.querySelectorsAll(node, this.meta.selectors, []).map(match => {\n\t\t\tif (componentNode && componentNode !== match.node) {\n\t\t\t\tparentInstance = undefined;\n\t\t\t}\n\t\t\tconst instance = this.makeInstance(match.node, match.factory, match.selector, parentInstance);\n\t\t\tif (match.factory.prototype instanceof Component) {\n\t\t\t\tcomponentNode = match.node;\n\t\t\t}\n\t\t\treturn instance;\n\t\t}).filter(x => x);\n\t\t// console.log('compile', instances, node, parentInstance);\n\t\treturn instances;\n\t}\n\n\tmakeInstance(node, factory, selector, parentInstance, args?: any) {\n\t\tif (parentInstance || node.parentNode) {\n\t\t\tconst isComponent = factory.prototype instanceof Component;\n\t\t\tconst meta = factory.meta;\n\t\t\t// console.log('meta', meta, factory);\n\t\t\t// collect parentInstance scope\n\t\t\tparentInstance = parentInstance || this.getParentInstance(node.parentNode);\n\t\t\tif (!parentInstance) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// creating factory instance\n\t\t\tconst instance = new factory(...(args || []));\n\t\t\t// creating instance context\n\t\t\tconst context = Module.makeContext(this, instance, parentInstance, node, factory, selector);\n\t\t\t// injecting changes$ and unsubscribe$ subjects\n\t\t\tObject.defineProperties(instance, {\n\t\t\t\tchanges$: {\n\t\t\t\t\tvalue: new BehaviorSubject(instance),\n\t\t\t\t\twritable: false,\n\t\t\t\t\tenumerable: false,\n\t\t\t\t},\n\t\t\t\tunsubscribe$: {\n\t\t\t\t\tvalue: new Subject(),\n\t\t\t\t\twritable: false,\n\t\t\t\t\tenumerable: false,\n\t\t\t\t}\n\t\t\t});\n\t\t\tlet initialized;\n\t\t\t// injecting instance pushChanges method\n\t\t\tconst module = this;\n\t\t\tinstance.pushChanges = function () {\n\t\t\t\t// console.log(new Error(`pushChanges ${instance.constructor.name}`).stack);\n\t\t\t\tthis.changes$.next(this);\n\t\t\t\t// parse component text nodes\n\t\t\t\tif (isComponent) {\n\t\t\t\t\t// console.log('Module.parse', instance.constructor.name);\n\t\t\t\t\tinitialized ? module.parse(node, instance) : setTimeout(function () { module.parse(node, instance); });\n\t\t\t\t}\n\t\t\t\t// calling onView event\n\t\t\t\tif (typeof instance.onView === 'function') {\n\t\t\t\t\t// console.log('onView', instance.constructor.name);\n\t\t\t\t\tinstance.onView();\n\t\t\t\t}\n\t\t\t};\n\t\t\t// creating component input and outputs\n\t\t\t// if (isComponent && meta) {\n\t\t\tif (meta) {\n\t\t\t\tthis.makeHosts(meta, instance, node);\n\t\t\t\tcontext.inputs = this.makeInputs(meta, instance);\n\t\t\t\tcontext.outputs = this.makeOutputs(meta, instance);\n\t\t\t}\n\t\t\t// calling onInit event\n\t\t\tif (typeof instance.onInit === 'function') {\n\t\t\t\tinstance.onInit();\n\t\t\t}\n\t\t\tinitialized = true;\n\t\t\t// subscribe to parent changes\n\t\t\tif (parentInstance.changes$) {\n\t\t\t\tparentInstance.changes$.pipe(\n\t\t\t\t\t// filter(() => node.parentNode),\n\t\t\t\t\t// debounceTime(1),\n\t\t\t\t\t/*\n\t\t\t\t\tdistinctUntilChanged(function(prev, curr) {\n\t\t\t\t\t\tconsole.log(isComponent, context.inputs);\n\t\t\t\t\t\tif (isComponent && meta && Object.keys(context.inputs).length === 0) {\n\t\t\t\t\t\t\treturn true; // same\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}),\n\t\t\t\t\t*/\n\t\t\t\t\ttakeUntil(instance.unsubscribe$)\n\t\t\t\t).subscribe(changes => {\n\t\t\t\t\t// resolve component input outputs\n\t\t\t\t\t// if (isComponent && meta) {\n\t\t\t\t\tif (meta) {\n\t\t\t\t\t\tthis.resolveInputsOutputs(instance, changes);\n\t\t\t\t\t}\n\t\t\t\t\t// calling onChanges event with parentInstance\n\t\t\t\t\tif (typeof instance.onChanges === 'function') {\n\t\t\t\t\t\t// console.log('onChanges', instance.constructor.name);\n\t\t\t\t\t\t// console.log('onChanges', instance.constructor.meta.selector, changes);\n\t\t\t\t\t\tinstance.onChanges(changes);\n\t\t\t\t\t}\n\t\t\t\t\t// push instance changes for subscribers\n\t\t\t\t\tinstance.pushChanges();\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn instance;\n\t\t}\n\t}\n\n\tmakeContext(instance, parentInstance, node, selector) {\n\t\tconst context = Module.makeContext(this, instance, parentInstance, node, instance.constructor, selector);\n\t\t// console.log('Module.makeContext', context, context.instance, context.node);\n\t\treturn context;\n\t}\n\n\tmakeFunction(expression, params = ['$instance']) {\n\t\tif (expression) {\n\t\t\texpression = Module.parseExpression(expression);\n\t\t\t// console.log(expression);\n\t\t\tconst args = params.join(',');\n\t\t\tconst expression_func = new Function(`with(this) {\n\t\t\t\treturn (function (${args}, $$module) {\n\t\t\t\t\tconst $$pipes = $$module.meta.pipes;\n\t\t\t\t\treturn ${expression};\n\t\t\t\t}.bind(this)).apply(this, arguments);\n\t\t\t}`);\n\t\t\t// console.log(expression_func);\n\t\t\treturn expression_func;\n\t\t} else {\n\t\t\treturn () => { return null; };\n\t\t}\n\t}\n\n\tgetInstance(node) {\n\t\tif (node === document) {\n\t\t\treturn window;\n\t\t}\n\t\tconst context = getContextByNode(node);\n\t\tif (context) {\n\t\t\treturn context.instance;\n\t\t}\n\t}\n\n\tgetParentInstance(node) {\n\t\treturn Module.traverseUp(node, (node) => {\n\t\t\treturn this.getInstance(node);\n\t\t});\n\t}\n\n\tparse(node, instance) {\n\t\tfor (let i = 0; i < node.childNodes.length; i++) {\n\t\t\tconst child = node.childNodes[i];\n\t\t\tif (child.nodeType === 1) {\n\t\t\t\tconst context = getContextByNode(child);\n\t\t\t\tif (!context) {\n\t\t\t\t\tthis.parse(child, instance);\n\t\t\t\t}\n\t\t\t} else if (child.nodeType === 3) {\n\t\t\t\tthis.parseTextNode(child, instance);\n\t\t\t}\n\t\t}\n\t}\n\n\tparseTextNode(node, instance) {\n\t\tlet expressions = node.nodeExpressions;\n\t\tif (!expressions) {\n\t\t\texpressions = this.parseTextNodeExpression(node.nodeValue);\n\t\t}\n\t\tconst replacedText = expressions.reduce((p, c) => {\n\t\t\tlet text;\n\t\t\tif (typeof c === 'function') {\n\t\t\t\ttext = this.resolve(c, instance, instance);\n\t\t\t\tif (text == undefined) { // !!! keep == loose equality\n\t\t\t\t\ttext = '';\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\ttext = c;\n\t\t\t}\n\t\t\treturn p + text;\n\t\t}, '');\n\t\tif (node.nodeValue !== replacedText) {\n\t\t\tconst textNode = document.createTextNode(replacedText) as any;\n\t\t\ttextNode.nodeExpressions = expressions;\n\t\t\tnode.parentNode.replaceChild(textNode, node);\n\t\t}\n\t}\n\n\tparseTextNodeExpression(expression) {\n\t\tconst expressions = [];\n\t\tconst regex = /\\{{2}((([^{}])|(\\{([^{}]|(\\{.*?\\}))+?\\}))*?)\\}{2}/g;\n\t\tlet lastIndex = 0,\n\t\t\tmatches;\n\t\tconst pushFragment = function (from, to) {\n\t\t\tconst fragment = expression.substring(from, to);\n\t\t\texpressions.push(fragment);\n\t\t};\n\t\twhile ((matches = regex.exec(expression)) !== null) {\n\t\t\tconst index = regex.lastIndex - matches[0].length;\n\t\t\tif (index > lastIndex) {\n\t\t\t\tpushFragment(index, lastIndex);\n\t\t\t}\n\t\t\tlastIndex = regex.lastIndex;\n\t\t\tconst fragment = this.makeFunction(matches[1]);\n\t\t\texpressions.push(fragment);\n\t\t}\n\t\tconst length = expression.length;\n\t\tif (length > lastIndex) {\n\t\t\tpushFragment(lastIndex, length);\n\t\t}\n\t\treturn expressions;\n\t}\n\n\tresolve(expressionFunc, changes, payload) {\n\t\t// console.log(expressionFunc, changes, payload);\n\t\treturn expressionFunc.apply(changes, [payload, this]);\n\t}\n\n\tmakeHosts(meta, instance, node) {\n\t\tif (meta.hosts) {\n\t\t\tObject.keys(meta.hosts).forEach(key => {\n\t\t\t\tconst factory = meta.hosts[key];\n\t\t\t\tinstance[key] = getHost(instance, factory, node);\n\t\t\t});\n\t\t}\n\t}\n\n\tmakeInput(instance, key) {\n\t\tconst { node } = getContext(instance);\n\t\tlet input, expression = null;\n\t\tif (node.hasAttribute(key)) {\n\t\t\t// const attribute = node.getAttribute(key).replace(/{{/g, '\"+').replace(/}}/g, '+\"');\n\t\t\tconst attribute = node.getAttribute(key).replace(/({{)|(}})|(\")/g, function (match, a, b, c) {\n\t\t\t\tif (a) {\n\t\t\t\t\treturn '\"+';\n\t\t\t\t}\n\t\t\t\tif (b) {\n\t\t\t\t\treturn '+\"';\n\t\t\t\t}\n\t\t\t\tif (c) {\n\t\t\t\t\treturn '\\\"';\n\t\t\t\t}\n\t\t\t});\n\t\t\texpression = `\"${attribute}\"`;\n\t\t} else if (node.hasAttribute(`[${key}]`)) {\n\t\t\texpression = node.getAttribute(`[${key}]`);\n\t\t}\n\t\tif (expression !== null) {\n\t\t\tinput = this.makeFunction(expression);\n\t\t}\n\t\treturn input;\n\t}\n\n\tmakeInputs(meta, instance) {\n\t\tconst inputs = {};\n\t\tif (meta.inputs) {\n\t\t\tmeta.inputs.forEach((key, i) => {\n\t\t\t\tconst input = this.makeInput(instance, key);\n\t\t\t\tif (input) {\n\t\t\t\t\tinputs[key] = input;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\treturn inputs;\n\t}\n\n\tmakeOutput(instance, key) {\n\t\tconst context = getContext(instance);\n\t\tconst node = context.node;\n\t\tconst parentInstance = context.parentInstance;\n\t\tconst expression = node.getAttribute(`(${key})`);\n\t\tconst outputFunction = this.makeFunction(expression, ['$event']);\n\t\tconst output$ = new Subject().pipe(\n\t\t\ttap((event) => {\n\t\t\t\tthis.resolve(outputFunction, parentInstance, event);\n\t\t\t})\n\t\t);\n\t\toutput$.pipe(\n\t\t\ttakeUntil(instance.unsubscribe$)\n\t\t).subscribe();\n\t\tinstance[key] = output$;\n\t\treturn outputFunction;\n\t}\n\n\tmakeOutputs(meta, instance) {\n\t\tconst outputs = {};\n\t\tif (meta.outputs) {\n\t\t\tmeta.outputs.forEach((key, i) => outputs[key] = this.makeOutput(instance, key));\n\t\t}\n\t\treturn outputs;\n\t}\n\n\tresolveInputsOutputs(instance, changes) {\n\t\tconst context = getContext(instance);\n\t\tconst parentInstance = context.parentInstance;\n\t\tconst inputs = context.inputs;\n\t\tfor (let key in inputs) {\n\t\t\tconst inputFunction = inputs[key];\n\t\t\tconst value = this.resolve(inputFunction, parentInstance, instance);\n\t\t\tinstance[key] = value;\n\t\t}\n\t\t/*\n\t\tconst outputs = context.outputs;\n\t\tfor (let key in outputs) {\n\t\t\tconst inpuoutputFunctiontFunction = outputs[key];\n\t\t\tconst value = this.resolve(outputFunction, parentInstance, null);\n\t\t\t// console.log(`setted -> ${key}`, value);\n\t\t}\n\t\t*/\n\t}\n\n\tdestroy() {\n\t\tthis.remove(this.meta.node);\n\t\tthis.meta.node.innerHTML = this.meta.nodeInnerHTML;\n\t}\n\n\tremove(node, keepInstance?: any) {\n\t\tconst keepContext = keepInstance ? getContext(keepInstance) : undefined;\n\t\tModule.traverseDown(node, (node) => {\n\t\t\tconst rxcompId = node.rxcompId;\n\t\t\tif (rxcompId) {\n\t\t\t\tconst keepContexts = Module.deleteContext(rxcompId, keepContext);\n\t\t\t\tif (keepContexts.length === 0) {\n\t\t\t\t\tdelete node.rxcompId;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\treturn node;\n\t}\n\n\tstatic parseExpression(expression) {\n\t\tconst l = '┌';\n\t\tconst r = '┘';\n\t\tconst rx1 = /(\\()([^\\(\\)]*)(\\))/;\n\t\twhile (expression.match(rx1)) {\n\t\t\texpression = expression.replace(rx1, function (...g1) {\n\t\t\t\treturn `${l}${Module.parsePipes(g1[2])}${r}`;\n\t\t\t});\n\t\t}\n\t\texpression = Module.parsePipes(expression);\n\t\texpression = expression.replace(/(┌)|(┘)/g, function (...g2) {\n\t\t\treturn g2[1] ? '(' : ')';\n\t\t});\n\t\treturn Module.parseOptionalChaining(expression);\n\t}\n\n\tstatic parsePipes(expression) {\n\t\tconst l = '┌';\n\t\tconst r = '┘';\n\t\tconst rx1 = /(.*?[^\\|])\\|([^\\|]+)/;\n\t\twhile (expression.match(rx1)) {\n\t\t\texpression = expression.replace(rx1, function (...g1) {\n\t\t\t\tconst value = g1[1].trim();\n\t\t\t\tconst params = Module.parsePipeParams(g1[2]);\n\t\t\t\tconst func = params.shift().trim();\n\t\t\t\treturn `$$pipes.${func}.transform┌${[value, ...params]}┘`;\n\t\t\t});\n\t\t}\n\t\treturn expression;\n\t}\n\n\tstatic parsePipeParams(expression) {\n\t\tconst segments = [];\n\t\tlet i = 0,\n\t\t\tword = '',\n\t\t\tblock = 0;\n\t\tconst t = expression.length;\n\t\twhile (i < t) {\n\t\t\tconst c = expression.substr(i, 1);\n\t\t\tif (c === '{' || c === '(' || c === '[') {\n\t\t\t\tblock++;\n\t\t\t}\n\t\t\tif (c === '}' || c === ')' || c === ']') {\n\t\t\t\tblock--;\n\t\t\t}\n\t\t\tif (c === ':' && block === 0) {\n\t\t\t\tif (word.length) {\n\t\t\t\t\tsegments.push(word.trim());\n\t\t\t\t}\n\t\t\t\tword = '';\n\t\t\t} else {\n\t\t\t\tword += c;\n\t\t\t}\n\t\t\ti++;\n\t\t}\n\t\tif (word.length) {\n\t\t\tsegments.push(word.trim());\n\t\t}\n\t\treturn segments;\n\t}\n\n\tstatic parseOptionalChaining(expression) {\n\t\tconst regex = /(\\w+(\\?\\.))+([\\.|\\w]+)/g;\n\t\tlet previous;\n\t\texpression = expression.replace(regex, function (...args) {\n\t\t\tconst tokens = args[0].split('?.');\n\t\t\tfor (let i = 0; i < tokens.length - 1; i++) {\n\t\t\t\tconst a = i > 0 ? `(${tokens[i]} = ${previous})` : tokens[i];\n\t\t\t\tconst b = tokens[i + 1];\n\t\t\t\tprevious = i > 0 ? `${a}.${b}` : `(${a} ? ${a}.${b} : void 0)`;\n\t\t\t}\n\t\t\treturn previous || '';\n\t\t});\n\t\treturn expression;\n\t}\n\n\tstatic makeContext(module, instance, parentInstance, node, factory, selector): ModuleContext {\n\t\tinstance.rxcompId = ++ID;\n\t\tconst context = { module, instance, parentInstance, node, factory, selector };\n\t\tconst rxcompNodeId = node.rxcompId = (node.rxcompId || instance.rxcompId);\n\t\tconst nodeContexts = NODES[rxcompNodeId] || (NODES[rxcompNodeId] = []);\n\t\tnodeContexts.push(context);\n\t\treturn CONTEXTS[instance.rxcompId] = context;\n\t}\n\n\tstatic deleteContext(id, keepContext) {\n\t\tconst keepContexts = [];\n\t\tconst nodeContexts = NODES[id];\n\t\tif (nodeContexts) {\n\t\t\tnodeContexts.forEach(context => {\n\t\t\t\tif (context === keepContext) {\n\t\t\t\t\tkeepContexts.push(keepContext);\n\t\t\t\t} else {\n\t\t\t\t\tconst instance = context.instance;\n\t\t\t\t\tinstance.unsubscribe$.next();\n\t\t\t\t\tinstance.unsubscribe$.complete();\n\t\t\t\t\tif (typeof instance.onDestroy === 'function') {\n\t\t\t\t\t\tinstance.onDestroy();\n\t\t\t\t\t\tdelete CONTEXTS[instance.rxcompId];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (keepContexts.length) {\n\t\t\t\tNODES[id] = keepContexts;;\n\t\t\t} else {\n\t\t\t\tdelete NODES[id];\n\t\t\t}\n\t\t}\n\t\treturn keepContexts;\n\t}\n\n\tstatic matchSelectors(node, selectors, results) {\n\t\tfor (let i = 0; i < selectors.length; i++) {\n\t\t\tconst match = selectors[i](node);\n\t\t\tif (match) {\n\t\t\t\tconst factory = match.factory;\n\t\t\t\tif (factory.prototype instanceof Component && factory.meta.template) {\n\t\t\t\t\tnode.innerHTML = factory.meta.template;\n\t\t\t\t}\n\t\t\t\tresults.push(match);\n\t\t\t\tif (factory.prototype instanceof Structure) {\n\t\t\t\t\t// console.log('Structure', node);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn results;\n\t}\n\n\tstatic querySelectorsAll(node, selectors, results) {\n\t\tif (node.nodeType === 1) {\n\t\t\tconst matches = this.matchSelectors(node, selectors, []);\n\t\t\tresults = results.concat(matches);\n\t\t\tconst structure = matches.find(x => x.factory.prototype instanceof Structure);\n\t\t\tif (structure) {\n\t\t\t\treturn results;\n\t\t\t}\n\t\t\tconst childNodes = node.childNodes;\n\t\t\tfor (let i = 0; i < childNodes.length; i++) {\n\t\t\t\tresults = this.querySelectorsAll(childNodes[i], selectors, results);\n\t\t\t}\n\t\t}\n\t\treturn results;\n\t}\n\n\tstatic traverseUp(node, callback, i = 0) {\n\t\tif (!node) {\n\t\t\treturn;\n\t\t}\n\t\tconst result = callback(node, i);\n\t\tif (result) {\n\t\t\treturn result;\n\t\t}\n\t\treturn this.traverseUp(node.parentNode, callback, i + 1);\n\t}\n\n\tstatic traverseDown(node, callback, i = 0) {\n\t\tif (!node) {\n\t\t\treturn;\n\t\t}\n\t\tlet result = callback(node, i);\n\t\tif (result) {\n\t\t\treturn result;\n\t\t}\n\t\tif (node.nodeType === 1) {\n\t\t\tlet j = 0,\n\t\t\t\tt = node.childNodes.length;\n\t\t\twhile (j < t && !result) {\n\t\t\t\tresult = this.traverseDown(node.childNodes[j], callback, i + 1);\n\t\t\t\tj++;\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tstatic traversePrevious(node, callback, i = 0) {\n\t\tif (!node) {\n\t\t\treturn;\n\t\t}\n\t\tconst result = callback(node, i);\n\t\tif (result) {\n\t\t\treturn result;\n\t\t}\n\t\treturn this.traversePrevious(node.previousSibling, callback, i + 1);\n\t}\n\n\tstatic traverseNext(node, callback, i = 0) {\n\t\tif (!node) {\n\t\t\treturn;\n\t\t}\n\t\tconst result = callback(node, i);\n\t\tif (result) {\n\t\t\treturn result;\n\t\t}\n\t\treturn this.traverseNext(node.nextSibling, callback, i + 1);\n\t}\n\n\tstatic meta: any;\n\n}\n\nexport function getContext(instance) {\n\treturn CONTEXTS[instance.rxcompId];\n}\n\nexport function getContextByNode(node) {\n\tlet context;\n\tconst nodeContexts = NODES[node.rxcompId];\n\tif (nodeContexts) {\n\t\tcontext = nodeContexts.reduce((previous, current) => {\n\t\t\tif (current.factory.prototype instanceof Component) {\n\t\t\t\treturn current;\n\t\t\t} else if (current.factory.prototype instanceof Context) {\n\t\t\t\treturn previous ? previous : current;\n\t\t\t} else {\n\t\t\t\treturn previous;\n\t\t\t}\n\t\t}, null);\n\t\t// console.log(node.rxcompId, context);\n\t}\n\treturn context;\n}\n\nexport function getHost(instance, factory, node) {\n\tif (!node) {\n\t\tnode = getContext(instance).node;\n\t}\n\tif (node.rxcompId) {\n\t\tconst nodeContexts = NODES[node.rxcompId];\n\t\tif (nodeContexts) {\n\t\t\t// console.log(nodeContexts);\n\t\t\tfor (let i = 0; i < nodeContexts.length; i++) {\n\t\t\t\tconst context = nodeContexts[i];\n\t\t\t\tif (context.instance !== instance) {\n\t\t\t\t\t// console.log(context.instance, instance);\n\t\t\t\t\tif (context.instance instanceof factory) {\n\t\t\t\t\t\treturn context.instance;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tif (node.parentNode) {\n\t\treturn getHost(instance, factory, node.parentNode);\n\t}\n}\n","import Directive from '../core/directive';\nimport { getContext } from '../module/module';\n\nexport default class ClassDirective extends Directive {\n\n\tonInit() {\n\t\tconst { module, node } = getContext(this);\n\t\tconst expression = node.getAttribute('[class]');\n\t\tthis.classFunction = module.makeFunction(expression);\n\t\t// console.log('ClassDirective.onInit', this.classList, expression);\n\t}\n\n\tonChanges(changes) {\n\t\tconst { module, node } = getContext(this);\n\t\tconst classList = module.resolve(this.classFunction, changes, this);\n\t\tfor (let key in classList) {\n\t\t\tclassList[key] ? node.classList.add(key) : node.classList.remove(key);\n\t\t}\n\t\t// console.log('ClassDirective.onChanges', classList);\n\t}\n\n}\n\nClassDirective.meta = {\n\tselector: `[[class]]`,\n};\n","import { fromEvent } from 'rxjs';\nimport { shareReplay, takeUntil } from 'rxjs/operators';\nimport Directive from '../core/directive';\nimport { getContext } from '../module/module';\n\nconst EVENTS = ['mousedown', 'mouseup', 'mousemove', 'click', 'dblclick', 'mouseover', 'mouseout', 'mouseenter', 'mouseleave', 'contextmenu', 'touchstart', 'touchmove', 'touchend', 'keydown', 'keyup', 'input', 'change', 'loaded'];\n\nexport default class EventDirective extends Directive {\n\n\tonInit() {\n\t\tconst { module, node, parentInstance, selector } = getContext(this);\n\t\tconst event = this.event = selector.replace(/\\[|\\]|\\(|\\)/g, '');\n\t\tconst event$ = this.event$ = fromEvent(node, event).pipe(shareReplay(1));\n\t\tconst expression = node.getAttribute(`(${event})`);\n\t\tif (expression) {\n\t\t\tconst outputFunction = module.makeFunction(expression, ['$event']);\n\t\t\tevent$.pipe(\n\t\t\t\ttakeUntil(this.unsubscribe$)\n\t\t\t).subscribe(event => {\n\t\t\t\t// console.log(parentInstance);\n\t\t\t\tmodule.resolve(outputFunction, parentInstance, event);\n\t\t\t});\n\t\t} else {\n\t\t\tparentInstance[`${event}$`] = event$;\n\t\t}\n\t\t// console.log('EventDirective.onInit', 'selector', selector, 'event', event);\n\t}\n\n}\n\nEventDirective.meta = {\n\tselector: `[(${EVENTS.join(')],[(')})]`,\n};\n","import Context from '../core/context';\n\nexport default class ForItem extends Context {\n\n\t// !!! try with payload options { key, $key, value, $value, index, count } or use onInit()\n\n\tconstructor(key, $key, value, $value, index, count, parentInstance) {\n\t\t// console.log('ForItem', arguments);\n\t\tsuper(parentInstance);\n\t\t/*\n\t\tsuper(parentInstance, {\n\t\t\t[key]: {\n\t\t\t\tget: function() {\n\t\t\t\t\treturn this.$key;\n\t\t\t\t},\n\t\t\t\tset: function(key) {\n\t\t\t\t\tthis.$key = key;\n\t\t\t\t}\n\t\t\t},\n\t\t\t[value]: {\n\t\t\t\tget: function() {\n\t\t\t\t\treturn this.$value;\n\t\t\t\t},\n\t\t\t\tset: function(value) {\n\t\t\t\t\tthis.$value = value;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\t*/\n\t\tthis[key] = $key;\n\t\tthis[value] = $value;\n\t\tthis.index = index;\n\t\tthis.count = count;\n\t}\n\n\tget first() { return this.index === 0; }\n\n\tget last() { return this.index === this.count - 1; }\n\n\tget even() { return this.index % 2 === 0; }\n\n\tget odd() { return !this.even; }\n\n}\n","import Structure from '../core/structure';\nimport { getContext } from '../module/module';\nimport ForItem from './for.item';\n\nexport default class ForStructure extends Structure {\n\n\tonInit() {\n\t\tconst { module, node } = getContext(this);\n\t\tconst forbegin = this.forbegin = document.createComment(`*for begin`);\n\t\tforbegin.rxcompId = node.rxcompId;\n\t\tnode.parentNode.replaceChild(forbegin, node);\n\t\tconst forend = this.forend = document.createComment(`*for end`);\n\t\tforbegin.parentNode.insertBefore(forend, forbegin.nextSibling);\n\t\tconst expression = node.getAttribute('*for');\n\t\t// this.expression = expression;\n\t\tnode.removeAttribute('*for');\n\t\tconst tokens = this.tokens = this.getExpressionTokens(expression);\n\t\tthis.forFunction = module.makeFunction(tokens.iterable);\n\t\tthis.instances = [];\n\t}\n\n\tonChanges(changes) {\n\t\tconst context = getContext(this);\n\t\tconst module = context.module;\n\t\tconst node = context.node;\n\t\t// resolve\n\t\tconst tokens = this.tokens;\n\t\tlet result = module.resolve(this.forFunction, changes, this) || [];\n\t\tconst isArray = Array.isArray(result);\n\t\tconst array = isArray ? result : Object.keys(result);\n\t\tconst total = array.length;\n\t\tconst previous = this.instances.length;\n\t\t// let nextSibling = this.forbegin.nextSibling;\n\t\tfor (let i = 0; i < Math.max(previous, total); i++) {\n\t\t\tif (i < total) {\n\t\t\t\tconst key = isArray ? i : array[i];\n\t\t\t\tconst value = isArray ? array[key] : result[key];\n\t\t\t\tif (i < previous) {\n\t\t\t\t\t// update\n\t\t\t\t\tconst instance = this.instances[i];\n\t\t\t\t\tinstance[tokens.key] = key;\n\t\t\t\t\tinstance[tokens.value] = value;\n\t\t\t\t\t/*\n\t\t\t\t\tif (!nextSibling) {\n\t\t\t\t\t\tconst context = getContext(instance);\n\t\t\t\t\t\tconst node = context.node;\n\t\t\t\t\t\tthis.forend.parentNode.insertBefore(node, this.forend);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnextSibling = nextSibling.nextSibling;\n\t\t\t\t\t}\n\t\t\t\t\t*/\n\t\t\t\t} else {\n\t\t\t\t\t// create\n\t\t\t\t\tconst clonedNode = node.cloneNode(true);\n\t\t\t\t\tdelete clonedNode.rxcompId;\n\t\t\t\t\tthis.forend.parentNode.insertBefore(clonedNode, this.forend);\n\t\t\t\t\tconst args = [tokens.key, key, tokens.value, value, i, total, context.parentInstance]; // !!! context.parentInstance unused?\n\t\t\t\t\tconst instance = module.makeInstance(clonedNode, ForItem, context.selector, context.parentInstance, args);\n\t\t\t\t\tconst forItemContext = getContext(instance);\n\t\t\t\t\t// console.log('ForStructure', clonedNode, forItemContext.instance.constructor.name);\n\t\t\t\t\tmodule.compile(clonedNode, forItemContext.instance);\n\t\t\t\t\t// nextSibling = clonedNode.nextSibling;\n\t\t\t\t\tthis.instances.push(instance);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// remove\n\t\t\t\tconst instance = this.instances[i];\n\t\t\t\tconst { node } = getContext(instance);\n\t\t\t\tnode.parentNode.removeChild(node);\n\t\t\t\tmodule.remove(node);\n\t\t\t}\n\t\t}\n\t\tthis.instances.length = array.length;\n\t\t// console.log('ForStructure', this.instances, tokens);\n\t}\n\n\tgetExpressionTokens(expression) {\n\t\tif (expression === null) {\n\t\t\tthrow ('invalid for');\n\t\t}\n\t\tif (expression.trim().indexOf('let ') === -1 || expression.trim().indexOf(' of ') === -1) {\n\t\t\tthrow ('invalid for');\n\t\t}\n\t\tconst expressions = expression.split(';').map(x => x.trim()).filter(x => x !== '');\n\t\tconst forExpressions = expressions[0].split(' of ').map(x => x.trim());\n\t\tlet value = forExpressions[0].replace(/\\s*let\\s*/, '');\n\t\tconst iterable = forExpressions[1];\n\t\tlet key = 'index';\n\t\tconst keyValueMatches = value.match(/\\[(.+)\\s*,\\s*(.+)\\]/);\n\t\tif (keyValueMatches) {\n\t\t\tkey = keyValueMatches[1];\n\t\t\tvalue = keyValueMatches[2];\n\t\t}\n\t\tif (expressions.length > 1) {\n\t\t\tconst indexExpressions = expressions[1].split(/\\s*let\\s*|\\s*=\\s*index/).map(x => x.trim());\n\t\t\tif (indexExpressions.length === 3) {\n\t\t\t\tkey = indexExpressions[1];\n\t\t\t}\n\t\t}\n\t\treturn { key, value, iterable };\n\t}\n\n}\n\nForStructure.meta = {\n\tselector: '[*for]',\n};\n","import Directive from '../core/directive';\nimport { getContext } from '../module/module';\n\nexport default class HrefDirective extends Directive {\n\n\tonChanges(changes) {\n\t\tconst { node } = getContext(this);\n\t\tnode.setAttribute('href', this.href);\n\t}\n\n}\n\nHrefDirective.meta = {\n\tselector: '[[href]]',\n\tinputs: ['href'],\n};\n","import Structure from '../core/structure';\nimport { getContext } from '../module/module';\n\nexport default class IfStructure extends Structure {\n\n\tonInit() {\n\t\tconst { module, node } = getContext(this);\n\t\tconst ifbegin = this.ifbegin = document.createComment(`*if begin`);\n\t\tifbegin.rxcompId = node.rxcompId;\n\t\tnode.parentNode.replaceChild(ifbegin, node);\n\t\tconst ifend = this.ifend = document.createComment(`*if end`);\n\t\tifbegin.parentNode.insertBefore(ifend, ifbegin.nextSibling);\n\t\tconst expression = node.getAttribute('*if');\n\t\tthis.ifFunction = module.makeFunction(expression);\n\t\tconst clonedNode = node.cloneNode(true);\n\t\tclonedNode.removeAttribute('*if');\n\t\tthis.clonedNode = clonedNode;\n\t\tthis.node = clonedNode.cloneNode(true);\n\t\t// console.log('IfStructure.expression', expression);\n\t}\n\n\tonChanges(changes) {\n\t\tconst { module } = getContext(this);\n\t\t// console.log('IfStructure.onChanges', changes);\n\t\tconst value = module.resolve(this.ifFunction, changes, this);\n\t\tconst node = this.node;\n\t\tif (value) {\n\t\t\tif (!node.parentNode) {\n\t\t\t\tthis.ifend.parentNode.insertBefore(node, this.ifend);\n\t\t\t\tmodule.compile(node);\n\t\t\t}\n\t\t} else {\n\t\t\tif (node.parentNode) {\n\t\t\t\tmodule.remove(node, this);\n\t\t\t\tnode.parentNode.removeChild(node);\n\t\t\t\tthis.node = this.clonedNode.cloneNode(true);\n\t\t\t}\n\t\t}\n\t}\n\n}\n\nIfStructure.meta = {\n\tselector: '[*if]',\n};\n","import Directive from '../core/directive';\nimport { getContext } from '../module/module';\n\nexport default class InnerHtmlDirective extends Directive {\n\n\tonChanges(changes) {\n\t\tconst { node } = getContext(this);\n\t\tnode.innerHTML = this.innerHTML == undefined ? '' : this.innerHTML; // !!! keep == loose equality\n\t}\n\n}\n\nInnerHtmlDirective.meta = {\n\tselector: `[innerHTML]`,\n\tinputs: ['innerHTML'],\n};\n","export default class Pipe {\n\n\tstatic transform(value) {\n\t\treturn value;\n\t}\n\n\tstatic meta: any;\n}\n","import Pipe from \"../core/pipe\";\n\nexport default class JsonPipe extends Pipe {\n\n\tstatic transform(value) {\n\t\treturn JSON.stringify(value, null, '\\t');\n\t}\n\n}\n\nJsonPipe.meta = {\n\tname: 'json',\n};\n","import Directive from '../core/directive';\nimport { getContext } from '../module/module';\n\nexport default class SrcDirective extends Directive {\n\n\tonChanges(changes) {\n\t\tconst { node } = getContext(this);\n\t\tnode.setAttribute('src', this.src);\n\t}\n\n}\n\nSrcDirective.meta = {\n\tselector: '[[src]]',\n\tinputs: ['src'],\n};\n","import Directive from '../core/directive';\nimport { getContext } from '../module/module';\n\nexport default class StyleDirective extends Directive {\n\n\tonInit() {\n\t\tconst { module, node } = getContext(this);\n\t\tconst expression = node.getAttribute('[style]');\n\t\tthis.styleFunction = module.makeFunction(expression);\n\t\t// console.log('StyleDirective.onInit', expression);\n\t}\n\n\tonChanges(changes) {\n\t\tconst { module, node } = getContext(this);\n\t\tconst style = module.resolve(this.styleFunction, changes, this);\n\t\tfor (let key in style) {\n\t\t\tnode.style.setProperty(key, style[key]);\n\t\t}\n\t\t// console.log('StyleDirective.onChanges', changes, style);\n\t}\n\n}\n\nStyleDirective.meta = {\n\tselector: `[[style]]`\n};\n","import ClassDirective from './class/class.directive';\nimport EventDirective from './event/event.directive';\nimport ForStructure from './for/for.structure';\nimport HrefDirective from './href/href.directive';\nimport IfStructure from './if/if.structure';\nimport InnerHtmlDirective from './inner-html/inner-html.directive';\nimport JsonPipe from './json/json.pipe';\nimport Module from './module/module';\nimport SrcDirective from './src/src.directive';\nimport StyleDirective from './style/style.directive';\n\nexport default class CoreModule extends Module {}\nconst factories = [\n\tClassDirective,\n\tEventDirective,\n\tForStructure,\n\tHrefDirective,\n\tIfStructure,\n\tInnerHtmlDirective,\n\tSrcDirective,\n\tStyleDirective,\n];\nconst pipes = [\n\tJsonPipe,\n];\nCoreModule.meta = {\n\tdeclarations: [\n\t\t...factories,\n\t\t...pipes,\n\t],\n\texports: [\n\t\t...factories,\n\t\t...pipes,\n\t]\n};\n","import Component from '../core/component';\nimport Directive from '../core/directive';\nimport Pipe from '../core/pipe';\nimport Structure from '../core/structure';\n\nconst ORDER = [Structure, Component, Directive];\n\nexport default class Platform {\n\n\tstatic bootstrap(moduleFactory) {\n\t\tconst meta = this.resolveMeta(moduleFactory);\n\t\tconst bootstrap = meta.bootstrap;\n\t\tif (!bootstrap) {\n\t\t\tthrow ('missing bootstrap');\n\t\t}\n\t\tconst node = meta.node = this.querySelector(bootstrap.meta.selector);\n\t\tif (!node) {\n\t\t\tthrow (`missing node ${bootstrap.meta.selector}`);\n\t\t}\n\t\tmeta.nodeInnerHTML = node.innerHTML;\n\t\tconst pipes = meta.pipes = this.resolvePipes(meta);\n\t\tconst factories = meta.factories = this.resolveFactories(meta);\n\t\tthis.sortFactories(factories);\n\t\tfactories.unshift(bootstrap);\n\t\tconst selectors = meta.selectors = this.unwrapSelectors(factories);\n\t\tconst module = new moduleFactory();\n\t\tmodule.meta = meta;\n\t\tconst instances = module.compile(node, window);\n\t\tconst root = instances[0];\n\t\t// if (root instanceof module.meta.bootstrap) {\n\t\troot.pushChanges();\n\t\t// }\n\t\treturn module;\n\t}\n\n\tstatic querySelector(selector) {\n\t\treturn document.querySelector(selector);\n\t}\n\n\tstatic resolveMeta(moduleFactory) {\n\t\tconst meta = Object.assign({ imports: [], declarations: [], pipes: [], exports: [] }, moduleFactory.meta);\n\t\tmeta.imports = meta.imports.map(moduleFactory => this.resolveMeta(moduleFactory));\n\t\treturn meta;\n\t}\n\n\tstatic resolvePipes(meta, exported) {\n\t\tconst importedPipes = meta.imports.map(meta => this.resolvePipes(meta, true));\n\t\tconst pipes = {};\n\t\tconst pipeList = (exported ? meta.exports : meta.declarations).filter(x => x.prototype instanceof Pipe);\n\t\tpipeList.forEach(pipeFactory => pipes[pipeFactory.meta.name] = pipeFactory);\n\t\treturn Object.assign({}, ...importedPipes, pipes);\n\t}\n\n\tstatic resolveFactories(meta, exported) {\n\t\tconst importedFactories = meta.imports.map(meta => this.resolveFactories(meta, true));\n\t\tconst factoryList = (exported ? meta.exports : meta.declarations).filter(x => (x.prototype instanceof Structure || x.prototype instanceof Component || x.prototype instanceof Directive));\n\t\treturn Array.prototype.concat.call(factoryList, ...importedFactories);\n\t}\n\n\tstatic sortFactories(factories) {\n\t\tfactories.sort((a, b) => {\n\t\t\tconst ai = ORDER.reduce((p, c, i) => a.prototype instanceof c ? i : p, -1);\n\t\t\tconst bi = ORDER.reduce((p, c, i) => b.prototype instanceof c ? i : p, -1);\n\t\t\t// return ai - bi;\n\t\t\tconst o = ai - bi;\n\t\t\tif (o === 0) {\n\t\t\t\treturn (a.meta.hosts ? 1 : 0) - (b.meta.hosts ? 1 : 0);\n\t\t\t}\n\t\t\treturn o;\n\t\t});\n\t}\n\n\tstatic getExpressions(selector) {\n\t\tlet matchers = [];\n\t\tselector.replace(/\\.([\\w\\-\\_]+)|\\[(.+?\\]*)(\\=)(.*?)\\]|\\[(.+?\\]*)\\]|([\\w\\-\\_]+)/g, function(value, c1, a2, u3, v4, a5, e6) {\n\t\t\tif (c1) {\n\t\t\t\tmatchers.push(function(node) {\n\t\t\t\t\treturn node.classList.contains(c1);\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (a2) {\n\t\t\t\tmatchers.push(function(node) {\n\t\t\t\t\treturn (node.hasAttribute(a2) && node.getAttribute(a2) === v4) ||\n\t\t\t\t\t\t(node.hasAttribute(`[${a2}]`) && node.getAttribute(`[${a2}]`) === v4);\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (a5) {\n\t\t\t\tmatchers.push(function(node) {\n\t\t\t\t\treturn node.hasAttribute(a5) || node.hasAttribute(`[${a5}]`);\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (e6) {\n\t\t\t\tmatchers.push(function(node) {\n\t\t\t\t\treturn node.nodeName.toLowerCase() === e6.toLowerCase();\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\treturn matchers;\n\t}\n\n\tstatic unwrapSelectors(factories) {\n\t\tconst selectors = [];\n\t\tfactories.forEach(factory => {\n\t\t\tfactory.meta.selector.split(',').forEach(selector => {\n\t\t\t\tselector = selector.trim();\n\t\t\t\tlet excludes = [];\n\t\t\t\tconst matchSelector = selector.replace(/\\:not\\((.+?)\\)/g, (value, unmatchSelector) => {\n\t\t\t\t\texcludes = this.getExpressions(unmatchSelector);\n\t\t\t\t\treturn '';\n\t\t\t\t});\n\t\t\t\tconst includes = this.getExpressions(matchSelector);\n\t\t\t\tselectors.push((node) => {\n\t\t\t\t\tconst include = includes.reduce((result, e) => {\n\t\t\t\t\t\treturn result && e(node);\n\t\t\t\t\t}, true);\n\t\t\t\t\tconst exclude = excludes.reduce((result, e) => {\n\t\t\t\t\t\treturn result || e(node);\n\t\t\t\t\t}, false);\n\t\t\t\t\tif (include && !exclude) {\n\t\t\t\t\t\treturn { node, factory, selector };\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t\treturn selectors;\n\t}\n\n\tstatic isBrowser() {\n\t\treturn window;\n\t}\n\n\t// static isServer() {}\n\n}\n","import Platform from './platform';\n\nexport default class Browser extends Platform {}\n","export default class LocalStorageService {\n\n\tstatic delete(name) {\n\t\tif (this.isLocalStorageSupported()) {\n\t\t\twindow.localStorage.removeItem(name);\n\t\t}\n\t}\n\n\tstatic exist(name) {\n\t\tif (this.isLocalStorageSupported()) {\n\t\t\treturn window.localStorage[name] !== undefined;\n\t\t}\n\t}\n\n\tstatic get(name) {\n\t\tlet value = null;\n\t\tif (this.isLocalStorageSupported() && window.localStorage[name] !== undefined) {\n\t\t\ttry {\n\t\t\t\tvalue = JSON.parse(window.localStorage[name]);\n\t\t\t} catch (e) {\n\t\t\t\tconsole.log('LocalStorageService.get.error parsing', name, e);\n\t\t\t}\n\t\t}\n\t\treturn value;\n\t}\n\n\tstatic set(name, value) {\n\t\tif (this.isLocalStorageSupported()) {\n\t\t\ttry {\n\t\t\t\tconst cache = [];\n\t\t\t\tconst json = JSON.stringify(value, function(key, value) {\n\t\t\t\t\tif (typeof value === 'object' && value !== null) {\n\t\t\t\t\t\tif (cache.indexOf(value) !== -1) {\n\t\t\t\t\t\t\t// Circular reference found, discard key\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcache.push(value);\n\t\t\t\t\t}\n\t\t\t\t\treturn value;\n\t\t\t\t});\n\t\t\t\twindow.localStorage.setItem(name, json);\n\t\t\t} catch (e) {\n\t\t\t\tconsole.log('LocalStorageService.set.error serializing', name, value, e);\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic isLocalStorageSupported() {\n\t\tif (this.supported) {\n\t\t\treturn true;\n\t\t}\n\t\tlet supported = false;\n\t\ttry {\n\t\t\tsupported = 'localStorage' in window && window.localStorage !== null;\n\t\t\tif (supported) {\n\t\t\t\twindow.localStorage.setItem('test', '1');\n\t\t\t\twindow.localStorage.removeItem('test');\n\t\t\t} else {\n\t\t\t\tsupported = false;\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tsupported = false;\n\t\t}\n\t\tthis.supported = supported;\n\t\treturn supported;\n\t}\n\n}\n","import { BehaviorSubject, of } from 'rxjs';\nimport { delay } from 'rxjs/operators';\nimport LocalStorageService from '../local-storage/local-storage.service';\n\nexport default class StoreService {\n\n\tstatic store$: BehaviorSubject<any>;\n\n\tstatic set(items) {\n\t\tLocalStorageService.set('items', items);\n\t\treturn this.get$().next(items);\n\t}\n\n\tstatic get$(): BehaviorSubject<any> {\n\t\tif (this.store$) {\n\t\t\treturn this.store$;\n\t\t}\n\t\tlet items = LocalStorageService.get('items');\n\t\tif (!items) {\n\t\t\titems = [\n\t\t\t\t{ id: 5, name: 'Cookies', date: new Date(Date.now()) },\n\t\t\t\t{ id: 4, name: 'Pizza', date: new Date(2019, 4, 4, 12) },\n\t\t\t\t{ id: 3, name: 'Pasta', date: new Date(2019, 3, 22, 12) },\n\t\t\t\t{ id: 2, name: 'Bread', date: new Date(2019, 0, 6, 12) },\n\t\t\t\t{ id: 1, name: 'Ham', date: new Date(2018, 11, 30, 12) },\n\t\t\t];\n\t\t\tLocalStorageService.set('items', items);\n\t\t}\n\t\tthis.store$ = new BehaviorSubject(items);\n\t\treturn this.store$.pipe(\n\t\t\tdelay(1) // simulate http\n\t\t) as BehaviorSubject<any>;\n\t}\n\n\tstatic add$(patch) {\n\t\tconst item = Object.assign({\n\t\t\tid: Date.now(),\n\t\t\tdate: new Date(Date.now())\n\t\t}, patch);\n\t\tconst items = this.store$.getValue();\n\t\titems.unshift(item);\n\t\tthis.set(items);\n\t\treturn of(item).pipe(\n\t\t\tdelay(1) // simulate http\n\t\t);\n\t}\n\n\tstatic patch$(patch) {\n\t\tconst items = this.store$.getValue();\n\t\tconst item = items.find(x => x.id === patch.id);\n\t\tif (item) {\n\t\t\tObject.assign(item, patch);\n\t\t\tthis.set(items);\n\t\t}\n\t\treturn of(item).pipe(\n\t\t\tdelay(1) // simulate http\n\t\t);\n\t}\n\n\tstatic delete$(item) {\n\t\tconst items = this.store$.getValue();\n\t\tconst index = items.indexOf(item);\n\t\tif (index !== -1) {\n\t\t\titems.splice(index, 1);\n\t\t\tthis.set(items);\n\t\t}\n\t\treturn of(item).pipe(\n\t\t\tdelay(1) // simulate http\n\t\t);\n\t}\n\n}\n","import { BehaviorSubject } from 'rxjs';\nimport { takeUntil } from 'rxjs/operators';\nimport { Component, getContext } from '../../src/rxcomp';\nimport StoreService from './store/store.service';\n\nexport default class AppComponent extends Component {\n\n\tinput: HTMLInputElement;\n\titems: any[];\n\tstore$: BehaviorSubject<any>\n\n\tonInit() {\n\t\t// context\n\t\tconst context = getContext(this);\n\t\t// input\n\t\tthis.input = context.node.querySelector('.control--text');\n\t\t// items\n\t\tthis.items = [];\n\t\t// store service\n\t\tthis.store$ = StoreService.get$();\n\t\tthis.store$.pipe(\n\t\t\ttakeUntil(this.unsubscribe$)\n\t\t).subscribe(items => {\n\t\t\tthis.items = items;\n\t\t\t// onpush change detection strategy\n\t\t\tthis.pushChanges();\n\t\t});\n\t}\n\n\tonInput($event) {\n\t\t// console.log('AppComponent.onInput', $event, this);\n\t\tthis.pushChanges();\n\t}\n\n\tonAddItem($event) {\n\t\tif (this.input.value) {\n\t\t\tStoreService.add$({\n\t\t\t\tname: this.input.value,\n\t\t\t}).subscribe(item => {\n\t\t\t\t// console.log('AppComponent.onAddItem', item);\n\t\t\t\tthis.input.value = null;\n\t\t\t});\n\t\t}\n\t}\n\n\tonToggleItem(item) {\n\t\tStoreService.patch$({\n\t\t\tid: item.id,\n\t\t\tdone: !item.done,\n\t\t}).subscribe(item => {\n\t\t\t// console.log('AppComponent.onToggleItem', item);\n\t\t});\n\t}\n\n\tonRemoveItem(item) {\n\t\tStoreService.delete$(item).subscribe(item => {\n\t\t\t// console.log('AppComponent.onRemoveItem', item);\n\t\t});\n\t}\n\n}\n\nAppComponent.meta = {\n\tselector: '[app-component]',\n};\n","import { Pipe } from \"../../../src/rxcomp\";\n\nexport default class DatePipe extends Pipe {\n\n\tstatic transform(value, locale = 'it-IT-u-ca-gregory', options = {\n\t\tdateStyle: 'short',\n\t\ttimeStyle: 'short',\n\t}) {\n\t\tconst localeDateString = new Date(value).toLocaleDateString(locale, options);\n\t\treturn localeDateString;\n\t}\n\n}\n\nDatePipe.meta = {\n\tname: 'date',\n};\n","export const colors = [\n\t{ hex: '#ffffff', background: '#ffffff', foreground: '#003adc', accent: '#212121' },\n\t{ hex: '#212121', background: '#212121', foreground: '#ffffff', accent: '#003adc' },\n\t{ hex: '#ffffff', background: '#ffffff', foreground: '#212121', accent: '#003adc' },\n\t{ hex: '#003adc', background: '#003adc', foreground: '#ffffff', accent: '#212121' },\n];\n\nexport function hexToInt(hex) {\n\treturn parseInt(hex.replace(/^#/, ''), 16);\n}\n\nexport function randomHex() {\n\treturn colors[Math.floor(Math.random() * colors.length)].hex;\n}\n\nexport function randomColor() {\n\tconst hex = randomHex();\n\treturn hexToInt(hex);\n}\n\nexport function color(index, alpha) {\n\treturn hexToRgb(colors[index % colors.length].hex, alpha);\n}\n\nexport function background(index, alpha) {\n\treturn hexToRgb(colors[index % colors.length].background, alpha);\n}\n\nexport function foreground(index, alpha) {\n\treturn hexToRgb(colors[index % colors.length].foreground, alpha);\n}\n\nexport function accent(index, alpha) {\n\treturn hexToRgb(colors[index % colors.length].accent, alpha);\n}\n\nlet index = -1;\n\nexport function nextHex() {\n\tindex++;\n\treturn colors[index % colors.length].hex;\n}\n\nexport function nextColor() {\n\tconst hex = nextHex();\n\treturn hexToInt(hex);\n}\n\nexport function hexToRgb(hex, a) {\n\tconst r = parseInt(hex.slice(1, 3), 16);\n\tconst g = parseInt(hex.slice(3, 5), 16);\n\tconst b = parseInt(hex.slice(5, 7), 16);\n\tif (a) {\n\t\treturn `rgba(${r},${g},${b},${a})`;\n\t} else {\n\t\treturn `rgb(${r},${g},${b})`;\n\t}\n}\n","import { Component } from '../../../src/rxcomp';\nimport { accent, background, foreground } from '../colors/colors';\n\nexport default class TodoItemComponent extends Component {\n\n\t// onInit() {}\n\n\tonChanges(changes) {\n\t\t// console.log('onChanges', changes);\n\t\tthis.background = background(this.item.id);\n\t\tthis.foreground = foreground(this.item.id);\n\t\tthis.accent = accent(this.item.id);\n\t}\n\n\t// onView() {}\n\n\t// onDestroy() {}\n\n\tonToggle($event) {\n\t\t// console.log('onToggle', $event);\n\t\tthis.toggle.next($event);\n\t}\n\n\tonRemove($event) {\n\t\t// console.log('onRemove', $event);\n\t\tthis.remove.next($event);\n\t}\n\n}\n\nTodoItemComponent.meta = {\n\tselector: '[todo-item-component]',\n\tinputs: ['item'],\n\toutputs: ['toggle', 'remove'],\n\t// template syntax example\n\t/*\n\ttemplate: // html // `\n\t\t<div class=\"content\" [style]=\"{ background: background, color: foreground, '--accent': accent }\">\n\t\t\t<button type=\"button\" class=\"btn--toggle\" (click)=\"onToggle(item)\">\n\t\t\t\t<i class=\"icon--check\" *if=\"item.done\"></i>\n\t\t\t\t<i class=\"icon--circle\" *if=\"!item.done\"></i>\n\t\t\t\t<div class=\"title\" [innerHTML]=\"item.name\"></div>\n\t\t\t</button>\n\t\t\t<div class=\"date\" [style]=\"{ background: backgroundColor, color: color }\" [innerHTML]=\"item.date | date : 'en-US' : { month: 'short', day: '2-digit', year: 'numeric' }\"></div>\n\t\t\t<button type=\"button\" class=\"btn--remove\" (click)=\"onRemove(item)\"><i class=\"icon--remove\"></i></button>\n\t\t</div>\n\t`,\n\t*/\n};\n","import { CoreModule, Module } from '../../src/rxcomp';\nimport AppComponent from './app.component';\nimport DatePipe from './date/date.pipe';\nimport TodoItemComponent from './todo-item/todo-item.component';\n\nexport default class AppModule extends Module {}\n\nAppModule.meta = {\n\timports: [\n\t\tCoreModule\n\t],\n\tdeclarations: [\n\t\tTodoItemComponent,\n\t\tDatePipe,\n\t],\n\tbootstrap: AppComponent,\n};\n","import { Browser } from '../../src/rxcomp';\nimport AppModule from './app.module';\n\nBrowser.bootstrap(AppModule);\n"]}