{"version":3,"sources":["docs/js/main.js","../../src/core/directive.js","../../src/core/component.js","../../src/core/context.js","../../src/core/structure.js","../../src/module/module.js","../../src/class/class.directive.js","../../src/event/event.directive.js","../../src/for/for.item.js","../../src/for/for.structure.js","../../src/if/if.structure.js","../../src/inner-html/inner-html.directive.js","../../src/json/json.pipe.js","../../src/style/style.directive.js","../../todomvc/js/local-storage/local-storage.service.js","../../todomvc/js/store/store.service.js","../../todomvc/js/app.component.js","../../todomvc/js/date/date.pipe.js","../../todomvc/js/colors/colors.js","../../todomvc/js/todo-item/todo-item.component.js","../../todomvc/js/main.js"],"names":["global","factory","exports","module","require","define","amd","self","rxjs","operators","this","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","_inheritsLoose","subClass","superClass","prototype","create","constructor","__proto__","_setPrototypeOf","o","p","setPrototypeOf","_construct","Parent","args","Class","Reflect","construct","sham","Proxy","Date","toString","call","e","isNativeReflectConstruct","a","push","apply","instance","Function","bind","arguments","Directive","Component","RESERVED_PROPERTIES","Context","_Component","descriptors","_this","mergeDescriptors","getPrototypeOf","defineProperties","ReferenceError","_assertThisInitialized","source","getOwnPropertyNames","forEach","indexOf","hasOwnProperty","getOwnPropertyDescriptor","value","_len","Array","_key","Structure","ID","CONTEXTS","NODES","ORDER","Module","options","bootstrap","pipes","x","meta","name","node","document","querySelector","selector","nodeInnerHTML","innerHTML","factories","sort","b","reduce","c","unshift","selectors","unwrapSelectors","compile","window","pushChanges","_proto","makeContext","parentInstance","makeInstance","parentNode","isComponent","getParentInstance","changes$","BehaviorSubject","unsubscribe$","Subject","next","parse","onView","context","inputs","makeInputs","outputs","makeOutputs","onInit","pipe","takeUntil","subscribe","changes","resolveInputsOutputs","onChanges","makeFunction","expression","params","join","transforms","getPipesSegments","shift","trim","transformOptionalChaining","transform","getPipeParamsSegments","makeInput","getContext","getAttribute","makeOutput","_this2","outputFunction","output$","tap","event","resolve","remove","ids","traverseDown","keys","id","complete","onDestroy","dataset","rxcompId","deleteContext","destroy","evaluate","text","_this3","replace","undefined","parse_func_","console","error","message","childNodes","child","nodeType","getContextByNode","nodeExpression","nodeValue","replacedText","textNode","createTextNode","replaceChild","expressionFunc","payload","_this4","_this5","_this6","inputFunction","getInstance","_this7","traverseUp","previous","tokens","split","_this8","querySelectorsAll","map","match","filter","use","segments","word","block","t","substr","className","classList","has","attribute","hasAttribute","nodeName","toLowerCase","matchSelectors","results","template","callback","result","j","traversePrevious","previousSibling","traverseNext","nextSibling","rxcompNodeId","nodeContexts","index","splice","current","ClassDirective","_Directive","classFunction","add","EventDirective","event$","fromEvent","shareReplay","ForItem","_Context","$key","$value","count","Constructor","protoProps","staticProps","get","even","ForStructure","_Structure","forbegin","createComment","forend","insertBefore","removeAttribute","getExpressionTokens","forFunction","iterable","instances","isArray","array","total","Math","max","clonedNode","cloneNode","forItemContext","removeChild","expressions","forExpressions","keyValueMatches","indexExpressions","IfStructure","ifbegin","ifend","ifFunction","InnerHtmlDirective","innerHtmlExpression","JsonPipe","JSON","stringify","StyleDirective","styleFunction","style","setProperty","LocalStorageService","delete","isLocalStorageSupported","localStorage","removeItem","exist","log","set","cache","json","setItem","supported","StoreService","items","get$","store$","date","now","delay","add$","patch","item","assign","getValue","of","patch$","find","delete$","AppComponent","input","onInput","$event","onAddItem","onToggleItem","done","onRemoveItem","DatePipe","locale","dateStyle","timeStyle","toLocaleDateString","colors","hex","background","foreground","accent","hexToRgb","r","parseInt","slice","g","TodoItemComponent","alpha","onToggle","toggle","onRemove"],"mappings":"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","file":"docs/js/main.min.js","sourcesContent":[null,"export default class Directive {\n\n}\n","export default class Component {\n\n}\n","// import { BehaviorSubject, Subject } from 'rxjs';\nimport Component from './component';\n\nconst RESERVED_PROPERTIES = ['constructor', 'rxcompId', 'onInit', 'onChanges', 'onDestroy', 'pushChanges', 'changes$', 'unsubscribe$'];\n\nexport default class Context extends Component {\n\n\tconstructor(instance, descriptors = {}) {\n\t\tsuper();\n\t\tdescriptors = Context.mergeDescriptors(instance, instance, descriptors);\n\t\tdescriptors = Context.mergeDescriptors(Object.getPrototypeOf(instance), instance, descriptors);\n\t\t/*\n\t\tconst subjects = {\n\t\t\tchanges$: {\n\t\t\t\tvalue: new BehaviorSubject(this),\n\t\t\t\twritable: false,\n\t\t\t\tenumerable: false,\n\t\t\t},\n\t\t\tunsubscribe$: {\n\t\t\t\tvalue: new Subject(),\n\t\t\t\twritable: false,\n\t\t\t\tenumerable: false,\n\t\t\t}\n\t\t};\n\t\t*/\n\t\tObject.defineProperties(this, descriptors);\n\t}\n\n\tstatic mergeDescriptors(source, instance, descriptors = {}) {\n\t\tconst properties = Object.getOwnPropertyNames(source);\n\t\tproperties.forEach(key => {\n\t\t\tif (RESERVED_PROPERTIES.indexOf(key) === -1 && !descriptors.hasOwnProperty(key)) {\n\t\t\t\t// console.log('Context.mergeDescriptors', key, source[key]);\n\t\t\t\tconst descriptor = Object.getOwnPropertyDescriptor(source, key);\n\t\t\t\tif (typeof descriptor.value == \"function\") {\n\t\t\t\t\tdescriptor.value = (...args) => {\n\t\t\t\t\t\tinstance[key].apply(instance, args);\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\tdescriptors[key] = descriptor;\n\t\t\t}\n\t\t});\n\t\treturn descriptors;\n\t}\n\n}\n","export default class Structure {\n\n}\n","import { BehaviorSubject, Subject } from 'rxjs';\nimport { takeUntil, tap } from 'rxjs/operators';\nimport Component from '../core/component';\nimport Context from '../core/context';\nimport Directive from '../core/directive';\nimport Structure from '../core/structure';\n\nlet ID = 0;\nconst CONTEXTS = {};\nconst NODES = {};\nconst ORDER = [Structure, Component, Directive];\n\nexport default class Module {\n\n\tconstructor(options) {\n\t\tif (!options) {\n\t\t\tthrow ('missing options');\n\t\t}\n\t\tif (!options.bootstrap) {\n\t\t\tthrow ('missing bootstrap');\n\t\t}\n\t\tthis.options = options;\n\t\tconst pipes = {};\n\t\tif (options.pipes) {\n\t\t\toptions.pipes.forEach(x => pipes[x.meta.name] = x);\n\t\t}\n\t\tthis.pipes = pipes;\n\t\tconst bootstrap = options.bootstrap;\n\t\tconst node = this.node = document.querySelector(bootstrap.meta.selector);\n\t\tthis.nodeInnerHTML = node.innerHTML;\n\t\tif (!node) {\n\t\t\tthrow (`missing node ${bootstrap.meta.selector}`);\n\t\t}\n\t\toptions.factories.sort((a, b) => {\n\t\t\tconst ai = ORDER.reduce((p, c, i) => a.prototype instanceof c ? i : p, -1);\n\t\t\tconst bi = ORDER.reduce((p, c, i) => b.prototype instanceof c ? i : p, -1);\n\t\t\treturn ai - bi;\n\t\t});\n\t\toptions.factories.unshift(bootstrap);\n\t\tthis.selectors = Module.unwrapSelectors(options.factories);\n\t\tconst instances = this.compile(node, window);\n\t\tconst instance = instances[0];\n\t\t// if (instance instanceof module.options.bootstrap) {\n\t\tinstance.pushChanges();\n\t\t// }\n\t}\n\n\tmakeContext(instance, parentInstance, node, selector) {\n\t\tconst context = Module.makeContext(this, instance, parentInstance, node, instance.constructor, selector);\n\t\t// console.log('Module.makeContext', context, context.instance, context.node);\n\t\treturn context;\n\t}\n\n\tmakeInstance(node, factory, selector, parentInstance, args) {\n\t\tif (parentInstance || node.parentNode) {\n\t\t\tconst isComponent = factory.prototype instanceof Component;\n\t\t\tconst meta = factory.meta;\n\t\t\t// collect parentInstance scope\n\t\t\tparentInstance = parentInstance || this.getParentInstance(node);\n\t\t\tif (!parentInstance) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// creating factory instance\n\t\t\tconst instance = new factory(...(args || []));\n\t\t\t// injecting changes$ and unsubscribe$ subjects\n\t\t\tObject.defineProperties(instance, {\n\t\t\t\tchanges$: {\n\t\t\t\t\tvalue: new BehaviorSubject(instance),\n\t\t\t\t\twritable: false,\n\t\t\t\t\tenumerable: false,\n\t\t\t\t},\n\t\t\t\tunsubscribe$: {\n\t\t\t\t\tvalue: new Subject(),\n\t\t\t\t\twritable: false,\n\t\t\t\t\tenumerable: false,\n\t\t\t\t}\n\t\t\t});\n\t\t\t// injecting instance pushChanges method\n\t\t\tconst module = this;\n\t\t\tinstance.pushChanges = function() {\n\t\t\t\t/*\n\t\t\t\tif (isComponent) {\n\t\t\t\t\tmodule.parse(node, instance);\n\t\t\t\t}\n\t\t\t\t*/\n\t\t\t\t/*\n\t\t\t\tconsole.log(new Error(`pushChanges ${instance.constructor.name}`).stack);\n\t\t\t\t*/\n\t\t\t\tthis.changes$.next(this);\n\t\t\t\t// parse component text nodes\n\t\t\t\tif (isComponent) {\n\t\t\t\t\t// console.log('Module.parse', instance.constructor.name);\n\t\t\t\t\tmodule.parse(node, instance);\n\t\t\t\t}\n\t\t\t\t// calling onView event\n\t\t\t\tif (typeof instance.onView === 'function') {\n\t\t\t\t\t// console.log('onView', instance.constructor.name);\n\t\t\t\t\tinstance.onView();\n\t\t\t\t}\n\t\t\t};\n\t\t\t// creating instance context\n\t\t\tconst context = Module.makeContext(this, instance, parentInstance, node, factory, selector);\n\t\t\t// creating component input and outputs\n\t\t\tif (isComponent && meta) {\n\t\t\t\tcontext.inputs = this.makeInputs(meta, instance);\n\t\t\t\tcontext.outputs = this.makeOutputs(meta, instance);\n\t\t\t}\n\t\t\t// calling onInit event\n\t\t\tif (typeof instance.onInit === 'function') {\n\t\t\t\tinstance.onInit();\n\t\t\t}\n\t\t\t// subscribe to parent changes\n\t\t\tif (parentInstance.changes$) {\n\t\t\t\tparentInstance.changes$.pipe(\n\t\t\t\t\t// filter(() => node.parentNode),\n\t\t\t\t\ttakeUntil(instance.unsubscribe$)\n\t\t\t\t).subscribe(changes => {\n\t\t\t\t\t// resolve component input outputs\n\t\t\t\t\tif (isComponent && meta) {\n\t\t\t\t\t\tthis.resolveInputsOutputs(instance, changes);\n\t\t\t\t\t}\n\t\t\t\t\t// calling onChanges event with parentInstance\n\t\t\t\t\tif (typeof instance.onChanges === 'function') {\n\t\t\t\t\t\t// console.log('onChanges', instance.constructor.name);\n\t\t\t\t\t\t// console.log('onChanges', instance.constructor.meta.selector, changes);\n\t\t\t\t\t\tinstance.onChanges(changes);\n\t\t\t\t\t}\n\t\t\t\t\t// push instance changes for subscribers\n\t\t\t\t\tinstance.pushChanges();\n\t\t\t\t});\n\t\t\t}\n\t\t\t/*\n\t\t\t// parse component text nodes\n\t\t\tif (isComponent) {\n\t\t\t\tthis.parse(node, instance);\n\t\t\t}\n\t\t\t*/\n\t\t\treturn instance;\n\t\t}\n\t}\n\n\tmakeFunction(expression, params = ['$instance']) {\n\t\tif (!expression) {\n\t\t\treturn () => { return null; };\n\t\t}\n\t\tconst args = params.join(',');\n\t\tconst pipes = this.pipes;\n\t\tconst transforms = Module.getPipesSegments(expression);\n\t\texpression = transforms.shift().trim();\n\t\texpression = this.transformOptionalChaining(expression);\n\t\t// console.log(pipes, transforms, expression);\n\t\t// console.log(transforms.length, params);\n\t\t// keyword 'this' represents changes from func.apply(changes, instance)\n\t\tif (transforms.length) {\n\t\t\texpression = transforms.reduce((expression, transform, i) => {\n\t\t\t\tconst params = Module.getPipeParamsSegments(transform);\n\t\t\t\tconst name = params.shift().trim();\n\t\t\t\tconst pipe = pipes[name];\n\t\t\t\tif (!pipe || typeof pipe.transform !== 'function') {\n\t\t\t\t\tthrow (`missing pipe ${name}`);\n\t\t\t\t}\n\t\t\t\treturn `$$pipes.${name}.transform(${expression},${params.join(',')})`;\n\t\t\t}, expression);\n\t\t\t// console.log('expression', expression);\n\t\t\tconst expression_func = new Function(`with(this) {\n\t\t\t\treturn (function (${args}, $$module) {\n\t\t\t\t\tconst $$pipes = $$module.pipes;\n\t\t\t\t\treturn ${expression};\n\t\t\t\t}.bind(this)).apply(this, arguments);\n\t\t\t}`);\n\t\t\treturn expression_func;\n\t\t} else {\n\t\t\t// console.log('expression', args, expression);\n\t\t\t// console.log('${expression.replace(/\\'/g,'\"')}', this);\n\t\t\tconst expression_func = new Function(`with(this) {\n\t\t\t\treturn (function (${args}, $$module) {\n\t\t\t\t\treturn ${expression};\n\t\t\t\t}.bind(this)).apply(this, arguments);\n\t\t\t}`);\n\t\t\treturn expression_func;\n\t\t}\n\t}\n\n\tmakeInput(instance, name) {\n\t\tconst context = Module.getContext(instance);\n\t\tconst node = context.node;\n\t\tconst expression = node.getAttribute(`[${name}]`);\n\t\treturn this.makeFunction(expression);\n\t}\n\n\tmakeOutput(instance, name) {\n\t\tconst context = Module.getContext(instance);\n\t\tconst node = context.node;\n\t\tconst parentInstance = context.parentInstance;\n\t\tconst expression = node.getAttribute(`(${name})`);\n\t\tconst outputFunction = this.makeFunction(expression, ['$event']);\n\t\tconst output$ = new Subject().pipe(\n\t\t\ttap((event) => {\n\t\t\t\tthis.resolve(outputFunction, parentInstance, event);\n\t\t\t})\n\t\t);\n\t\toutput$.pipe(\n\t\t\ttakeUntil(instance.unsubscribe$)\n\t\t).subscribe();\n\t\tinstance[name] = output$;\n\t\treturn outputFunction;\n\t}\n\n\tremove(node) {\n\t\tconst ids = [];\n\t\tModule.traverseDown(node, (node) => {\n\t\t\tObject.keys(CONTEXTS).forEach(id => {\n\t\t\t\tconst context = CONTEXTS[id];\n\t\t\t\tif (context.node === node) {\n\t\t\t\t\tconst instance = context.instance;\n\t\t\t\t\tinstance.unsubscribe$.next();\n\t\t\t\t\tinstance.unsubscribe$.complete();\n\t\t\t\t\tif (typeof instance.onDestroy === 'function') {\n\t\t\t\t\t\tinstance.onDestroy();\n\t\t\t\t\t}\n\t\t\t\t\tdelete node.dataset.rxcompId;\n\t\t\t\t\tids.push(id);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t\tids.forEach(id => Module.deleteContext(id));\n\t\t// console.log('Module.remove', ids);\n\t\treturn node;\n\t}\n\n\tdestroy() {\n\t\tthis.remove(this.node);\n\t\tthis.node.innerHTML = this.nodeInnerHTML;\n\t}\n\n\tevaluate(text, instance) {\n\t\tconst parse_eval_ = (...args) => {\n\t\t\tconst expression = args[1];\n\t\t\t// console.log('expression', expression);\n\t\t\ttry {\n\t\t\t\tconst parse_func_ = this.makeFunction(expression);\n\t\t\t\treturn this.resolve(parse_func_, instance, instance);\n\t\t\t} catch (e) {\n\t\t\t\tconsole.error(e);\n\t\t\t\treturn e.message;\n\t\t\t}\n\t\t};\n\t\treturn text.replace(/\\{{2}((([^{}])|(\\{([^{}]|(\\{.*?\\}))+?\\}))*?)\\}{2}/g, parse_eval_);\n\t\t// return text.replace(/\\{{2}((([^{}])|(\\{[^{}]+?\\}))*?)\\}{2}/g, parse_eval_);\n\t}\n\n\tparse(node, instance) {\n\t\t// console.log('parse', instance.constructor.name, node);\n\t\tfor (let i = 0; i < node.childNodes.length; i++) {\n\t\t\tconst child = node.childNodes[i];\n\t\t\tif (child.nodeType === 1) {\n\t\t\t\tconst context = Module.getContextByNode(child);\n\t\t\t\tif (!context) {\n\t\t\t\t\tthis.parse(child, instance);\n\t\t\t\t}\n\t\t\t} else if (child.nodeType === 3) {\n\t\t\t\tconst expression = child.nodeExpression || child.nodeValue;\n\t\t\t\tconst replacedText = this.evaluate(expression, instance);\n\t\t\t\t// console.log(instance.constructor.name, expression, replacedText);\n\t\t\t\tif (expression !== replacedText) {\n\t\t\t\t\tchild.nodeExpression = child.nodeExpression || expression;\n\t\t\t\t\tconst textNode = document.createTextNode(replacedText);\n\t\t\t\t\tnode.replaceChild(textNode, child);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tresolve(expressionFunc, changes, payload) {\n\t\treturn expressionFunc.apply(changes, [payload, this]);\n\t}\n\n\tmakeInputs(meta, instance) {\n\t\tconst inputs = {};\n\t\tif (meta.inputs) {\n\t\t\tmeta.inputs.forEach((key, i) => inputs[key] = this.makeInput(instance, key));\n\t\t}\n\t\treturn inputs;\n\t}\n\n\tmakeOutputs(meta, instance) {\n\t\tconst outputs = {};\n\t\tif (meta.outputs) {\n\t\t\tmeta.outputs.forEach((key, i) => outputs[key] = this.makeOutput(instance, key));\n\t\t}\n\t\treturn outputs;\n\t}\n\n\tresolveInputsOutputs(instance, changes) {\n\t\tconst context = Module.getContext(instance);\n\t\tconst parentInstance = context.parentInstance;\n\t\tconst inputs = context.inputs;\n\t\tObject.keys(inputs).forEach(key => {\n\t\t\tconst inputFunction = inputs[key];\n\t\t\tconst value = this.resolve(inputFunction, parentInstance, instance);\n\t\t\tinstance[key] = value;\n\t\t});\n\t\t/*\n\t\tconst outputs = context.outputs;\n\t\tObject.keys(outputs).forEach(key => {\n\t\t\tconst inpuoutputFunctiontFunction = outputs[key];\n\t\t\tconst value = this.resolve(outputFunction, parentInstance, null);\n\t\t\t// console.log(`setted -> ${key}`, value);\n\t\t});\n\t\t*/\n\t}\n\n\tgetInstance(node) {\n\t\tif (node === document) {\n\t\t\treturn window;\n\t\t}\n\t\tconst context = Module.getContextByNode(node);\n\t\tif (context) {\n\t\t\treturn context.instance;\n\t\t}\n\t}\n\n\tgetParentInstance(node) {\n\t\treturn Module.traverseUp(node, (node) => {\n\t\t\treturn this.getInstance(node);\n\t\t});\n\t}\n\n\ttransformOptionalChaining(expression) {\n\t\tconst regex = /(\\w+(\\?\\.))+([\\.|\\w]+)/g;\n\t\tlet previous;\n\t\texpression = expression.replace(regex, (...args) => {\n\t\t\tconst tokens = args[0].split('?.');\n\t\t\tfor (let i = 0; i < tokens.length - 1; i++) {\n\t\t\t\tconst a = i > 0 ? `(${tokens[i]} = ${previous})` : tokens[i];\n\t\t\t\tconst b = tokens[i + 1];\n\t\t\t\tprevious = i > 0 ? `${a}.${b}` : `(${a} ? ${a}.${b} : void 0)`;\n\t\t\t\t// log(previous);\n\t\t\t}\n\t\t\treturn previous || '';\n\t\t});\n\t\treturn expression;\n\t}\n\n\tcompile(node, parentInstance) {\n\t\tconst instances = Module.querySelectorsAll(node, this.selectors, []).map(match => {\n\t\t\tconst instance = this.makeInstance(match.node, match.factory, match.selector, parentInstance);\n\t\t\tif (match.factory.prototype instanceof Component) {\n\t\t\t\tparentInstance = undefined;\n\t\t\t}\n\t\t\treturn instance;\n\t\t}).filter(x => x);\n\t\t// console.log('compile', instances, node, parentInstance);\n\t\treturn instances;\n\t}\n\n\tstatic use(options) {\n\t\tconst module = new Module(options);\n\t\treturn module;\n\t}\n\n\tstatic getPipesSegments(expression) {\n\t\tconst segments = [];\n\t\tlet i = 0,\n\t\t\tword = '',\n\t\t\tblock = 0;\n\t\tconst t = expression.length;\n\t\twhile (i < t) {\n\t\t\tconst c = expression.substr(i, 1);\n\t\t\tif (c === '{' || c === '(' || c === '[') {\n\t\t\t\tblock++;\n\t\t\t}\n\t\t\tif (c === '}' || c === ')' || c === ']') {\n\t\t\t\tblock--;\n\t\t\t}\n\t\t\tif (c === '|' && block === 0) {\n\t\t\t\tif (word.length) {\n\t\t\t\t\tsegments.push(word);\n\t\t\t\t}\n\t\t\t\tword = '';\n\t\t\t} else {\n\t\t\t\tword += c;\n\t\t\t}\n\t\t\ti++;\n\t\t}\n\t\tif (word.length) {\n\t\t\tsegments.push(word);\n\t\t}\n\t\treturn segments;\n\t}\n\n\tstatic getPipeParamsSegments(expression) {\n\t\tconst segments = [];\n\t\tlet i = 0,\n\t\t\tword = '',\n\t\t\tblock = 0;\n\t\tconst t = expression.length;\n\t\twhile (i < t) {\n\t\t\tconst c = expression.substr(i, 1);\n\t\t\tif (c === '{' || c === '(' || c === '[') {\n\t\t\t\tblock++;\n\t\t\t}\n\t\t\tif (c === '}' || c === ')' || c === ']') {\n\t\t\t\tblock--;\n\t\t\t}\n\t\t\tif (c === ':' && block === 0) {\n\t\t\t\tif (word.length) {\n\t\t\t\t\tsegments.push(word);\n\t\t\t\t}\n\t\t\t\tword = '';\n\t\t\t} else {\n\t\t\t\tword += c;\n\t\t\t}\n\t\t\ti++;\n\t\t}\n\t\tif (word.length) {\n\t\t\tsegments.push(word);\n\t\t}\n\t\treturn segments;\n\t}\n\n\tstatic unwrapSelectors(factories) {\n\t\tconst selectors = [];\n\t\tfactories.forEach(factory => {\n\t\t\tfactory.meta.selector.split(',').forEach(selector => {\n\t\t\t\tselector = selector.trim();\n\t\t\t\tif (selector.indexOf('.') === 0) {\n\t\t\t\t\tconst className = selector.replace(/\\./g, '');\n\t\t\t\t\tselectors.push((node) => {\n\t\t\t\t\t\tconst match = node.classList.has(className);\n\t\t\t\t\t\treturn match ? { node, factory, selector } : false;\n\t\t\t\t\t});\n\t\t\t\t} else if (selector.match(/\\[(.+)\\]/)) {\n\t\t\t\t\tconst attribute = selector.substr(1, selector.length - 2);\n\t\t\t\t\tselectors.push((node) => {\n\t\t\t\t\t\tconst match = node.hasAttribute(attribute);\n\t\t\t\t\t\treturn match ? { node, factory, selector } : false;\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tselectors.push((node) => {\n\t\t\t\t\t\tconst match = node.nodeName.toLowerCase() === selector.toLowerCase();\n\t\t\t\t\t\treturn match ? { node, factory, selector } : false;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t\treturn selectors;\n\t}\n\n\tstatic matchSelectors(node, selectors, results) {\n\t\tselectors.forEach(selector => {\n\t\t\tconst match = selector(node);\n\t\t\tif (match) {\n\t\t\t\tconst factory = match.factory;\n\t\t\t\tif (factory.prototype instanceof Component && factory.meta.template) {\n\t\t\t\t\tnode.innerHTML = factory.meta.template;\n\t\t\t\t}\n\t\t\t\tresults.push(match);\n\t\t\t}\n\t\t});\n\t\treturn results;\n\t}\n\n\tstatic querySelectorsAll(node, selectors, results) {\n\t\tif (node.nodeType === 1) {\n\t\t\tresults = this.matchSelectors(node, selectors, results);\n\t\t}\n\t\tconst childNodes = node.childNodes;\n\t\tif (childNodes) {\n\t\t\tfor (let i = 0; i < childNodes.length; i++) {\n\t\t\t\tresults = this.querySelectorsAll(childNodes[i], selectors, results);\n\t\t\t}\n\t\t}\n\t\treturn results;\n\t}\n\n\tstatic traverseUp(node, callback, i = 0) {\n\t\tif (!node) {\n\t\t\treturn;\n\t\t}\n\t\tconst result = callback(node, i);\n\t\tif (result) {\n\t\t\treturn result;\n\t\t}\n\t\treturn this.traverseUp(node.parentNode, callback, i + 1);\n\t}\n\n\tstatic traverseDown(node, callback, i = 0) {\n\t\tif (!node) {\n\t\t\treturn;\n\t\t}\n\t\tlet result = callback(node, i);\n\t\tif (result) {\n\t\t\treturn result;\n\t\t}\n\t\tif (node.nodeType === 1) {\n\t\t\tlet j = 0,\n\t\t\t\tt = node.childNodes.length;\n\t\t\twhile (j < t && !result) {\n\t\t\t\tresult = this.traverseDown(node.childNodes[j], callback, i + 1);\n\t\t\t\tj++;\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tstatic traversePrevious(node, callback, i = 0) {\n\t\tif (!node) {\n\t\t\treturn;\n\t\t}\n\t\tconst result = callback(node, i);\n\t\tif (result) {\n\t\t\treturn result;\n\t\t}\n\t\treturn this.traversePrevious(node.previousSibling, callback, i + 1);\n\t}\n\n\tstatic traverseNext(node, callback, i = 0) {\n\t\tif (!node) {\n\t\t\treturn;\n\t\t}\n\t\tconst result = callback(node, i);\n\t\tif (result) {\n\t\t\treturn result;\n\t\t}\n\t\treturn this.traverseNext(node.nextSibling, callback, i + 1);\n\t}\n\n\tstatic getContext(instance) {\n\t\treturn CONTEXTS[instance.rxcompId];\n\t}\n\n\tstatic makeContext(module, instance, parentInstance, node, factory, selector) {\n\t\tinstance.rxcompId = ++ID;\n\t\tconst context = { module, instance, parentInstance, node, factory, selector };\n\t\tconst rxcompNodeId = node.dataset.rxcompId = (node.dataset.rxcompId || ++ID);\n\t\tconst nodeContexts = NODES[rxcompNodeId] || (NODES[rxcompNodeId] = []);\n\t\tnodeContexts.push(context);\n\t\treturn CONTEXTS[instance.rxcompId] = context;\n\t}\n\n\tstatic deleteContext(id) {\n\t\tconst context = CONTEXTS[id];\n\t\tconst nodeContexts = NODES[context.node.dataset.rxcompId];\n\t\tif (nodeContexts) {\n\t\t\tconst index = nodeContexts.indexOf(context);\n\t\t\tif (index !== -1) {\n\t\t\t\tnodeContexts.splice(index, 1);\n\t\t\t}\n\t\t}\n\t\tdelete CONTEXTS[id];\n\t}\n\n\tstatic getContextByNode(node) {\n\t\tlet context;\n\t\tconst nodeContexts = NODES[node.dataset.rxcompId];\n\t\tif (nodeContexts) {\n\t\t\tcontext = nodeContexts.reduce((previous, current) => {\n\t\t\t\tif (current.node === node && current.factory.prototype instanceof Component) {\n\t\t\t\t\tif (previous && current.factory.prototype instanceof Context) {\n\t\t\t\t\t\treturn previous;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn current;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\treturn previous;\n\t\t\t\t}\n\t\t\t}, null);\n\t\t}\n\t\treturn context;\n\t}\n\n}\n","import Directive from '../core/directive';\nimport Module from '../module/module';\n\nexport default class ClassDirective extends Directive {\n\n\tonInit() {\n\t\tconst context = Module.getContext(this);\n\t\tconst module = context.module;\n\t\tconst node = context.node;\n\t\tconst expression = node.getAttribute('[class]');\n\t\tthis.classFunction = module.makeFunction(expression);\n\t\t// this.classList = [...node.classList.keys()];\n\t\t// console.log('ClassDirective.onInit', this.classList, expression);\n\t}\n\n\tonChanges(changes) {\n\t\tconst context = Module.getContext(this);\n\t\tconst module = context.module;\n\t\tconst node = context.node;\n\t\tconst classList = module.resolve(this.classFunction, changes, this);\n\t\tObject.keys(classList).forEach(key => {\n\t\t\tif (classList[key]) {\n\t\t\t\tnode.classList.add(key);\n\t\t\t} else {\n\t\t\t\tnode.classList.remove(key);\n\t\t\t}\n\t\t});\n\t\t// console.log('ClassDirective.onChanges', classList);\n\t}\n\n}\n\nClassDirective.meta = {\n\tselector: `[[class]]`,\n};\n","import { fromEvent } from 'rxjs';\nimport { shareReplay, takeUntil } from 'rxjs/operators';\nimport Directive from '../core/directive';\nimport Module from '../module/module';\n\nconst EVENTS = ['click', 'mousedown', 'mouseup', 'touchstart', 'touchmove', 'touchend', 'keydown', 'keyup', 'input', 'change', 'loaded'];\n\nexport default class EventDirective extends Directive {\n\n\tonInit() {\n\t\tconst context = Module.getContext(this);\n\t\tconst module = context.module;\n\t\tconst node = context.node;\n\t\tconst selector = context.selector;\n\t\tconst parentInstance = context.parentInstance;\n\t\tconst event = this.event = selector.replace(/\\[|\\]|\\(|\\)/g, '');\n\t\tconst event$ = this.event$ = fromEvent(node, event).pipe(shareReplay(1));\n\t\tconst expression = node.getAttribute(`(${event})`);\n\t\tif (expression) {\n\t\t\tconst outputFunction = module.makeFunction(expression, ['$event']);\n\t\t\tevent$.pipe(\n\t\t\t\ttakeUntil(this.unsubscribe$)\n\t\t\t).subscribe(event => {\n\t\t\t\t// console.log(parentInstance);\n\t\t\t\tmodule.resolve(outputFunction, parentInstance, event);\n\t\t\t});\n\t\t} else {\n\t\t\tparentInstance[`${event}$`] = event$;\n\t\t}\n\t\t// console.log('EventDirective.onInit', 'selector', selector, 'event', event);\n\t}\n\n}\n\nEventDirective.meta = {\n\tselector: `[(${EVENTS.join(')],[(')})]`,\n};\n","import Context from '../core/context';\n// import Component from '../component/component';\n\nexport default class ForItem extends Context {\n\n\t// !!! try with payload options { key, $key, value, $value, index, count } or use onInit()\n\n\tconstructor(key, $key, value, $value, index, count, parentInstance) {\n\t\t// console.log('ForItem', arguments);\n\t\tsuper(parentInstance);\n\t\t/*\n\t\tsuper(parentInstance, {\n\t\t\t[key]: {\n\t\t\t\tget: function() {\n\t\t\t\t\treturn this.$key;\n\t\t\t\t},\n\t\t\t\tset: function(key) {\n\t\t\t\t\tthis.$key = key;\n\t\t\t\t}\n\t\t\t},\n\t\t\t[value]: {\n\t\t\t\tget: function() {\n\t\t\t\t\treturn this.$value;\n\t\t\t\t},\n\t\t\t\tset: function(value) {\n\t\t\t\t\tthis.$value = value;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\t*/\n\t\tthis[key] = $key;\n\t\tthis[value] = $value;\n\t\tthis.index = index;\n\t\tthis.count = count;\n\t}\n\n\tget first() { return this.index === 0; }\n\n\tget last() { return this.index === this.count - 1; }\n\n\tget even() { return this.index % 2 === 0; }\n\n\tget odd() { return !this.even; }\n\n}\n","import Structure from '../core/structure';\nimport Module from '../module/module';\nimport ForItem from './for.item';\n\nexport default class ForStructure extends Structure {\n\n\tonInit() {\n\t\tconst context = Module.getContext(this);\n\t\tconst module = context.module;\n\t\tconst node = context.node;\n\t\tconst forbegin = this.forbegin = document.createComment(`*for begin`);\n\t\tnode.parentNode.replaceChild(forbegin, node);\n\t\tconst forend = this.forend = document.createComment(`*for end`);\n\t\tforbegin.parentNode.insertBefore(forend, forbegin.nextSibling);\n\t\tconst expression = node.getAttribute('*for');\n\t\tnode.removeAttribute('*for');\n\t\tconst tokens = this.tokens = this.getExpressionTokens(expression);\n\t\tthis.forFunction = module.makeFunction(tokens.iterable);\n\t\tthis.instances = [];\n\t}\n\n\tonChanges(changes) {\n\t\tconst context = Module.getContext(this);\n\t\tconst module = context.module;\n\t\tconst node = context.node;\n\t\t// resolve\n\t\tconst tokens = this.tokens;\n\t\tlet result = module.resolve(this.forFunction, changes, this) || [];\n\t\tconst isArray = Array.isArray(result);\n\t\tconst array = isArray ? result : Object.keys(result);\n\t\tconst total = array.length;\n\t\tconst previous = this.instances.length;\n\t\tlet nextSibling = this.forbegin.nextSibling;\n\t\tfor (let i = 0; i < Math.max(previous, total); i++) {\n\t\t\tif (i < total) {\n\t\t\t\tconst key = isArray ? i : array[i];\n\t\t\t\tconst value = isArray ? array[key] : result[key];\n\t\t\t\tif (i < previous) {\n\t\t\t\t\t// update\n\t\t\t\t\t// const clonedNode = nextSibling;\n\t\t\t\t\tconst instance = this.instances[i];\n\t\t\t\t\tinstance[tokens.key] = key;\n\t\t\t\t\tinstance[tokens.value] = value;\n\t\t\t\t\t// module.parse(clonedNode, instance);\n\t\t\t\t\tnextSibling = nextSibling.nextSibling;\n\t\t\t\t} else {\n\t\t\t\t\t// create\n\t\t\t\t\tconst clonedNode = node.cloneNode(true);\n\t\t\t\t\tthis.forend.parentNode.insertBefore(clonedNode, this.forend);\n\t\t\t\t\tconst args = [tokens.key, key, tokens.value, value, i, total, context.parentInstance]; // !!! context.parentInstance unused?\n\t\t\t\t\tconst instance = module.makeInstance(clonedNode, ForItem, context.selector, context.parentInstance, args);\n\t\t\t\t\tconst forItemContext = Module.getContext(instance);\n\t\t\t\t\t// console.log(clonedNode, forItemContext.instance.constructor.name);\n\t\t\t\t\tmodule.compile(clonedNode, forItemContext.instance);\n\t\t\t\t\t// module.parse(clonedNode, instance);\n\t\t\t\t\tnextSibling = clonedNode.nextSibling;\n\t\t\t\t\tthis.instances.push(instance);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// remove\n\t\t\t\tconst instance = this.instances[i];\n\t\t\t\tconst context = Module.getContext(instance);\n\t\t\t\tconst node = context.node;\n\t\t\t\tnode.parentNode.removeChild(node);\n\t\t\t\tmodule.remove(node);\n\t\t\t}\n\t\t}\n\t\tthis.instances.length = array.length;\n\t\t// console.log(this.instances, tokens);\n\t}\n\n\tgetExpressionTokens(expression) {\n\t\tif (expression === null) {\n\t\t\tthrow ('invalid for');\n\t\t}\n\t\tif (expression.trim().indexOf('let ') === -1 || expression.trim().indexOf(' of ') === -1) {\n\t\t\tthrow ('invalid for');\n\t\t}\n\t\tconst expressions = expression.split(';').map(x => x.trim()).filter(x => x !== '');\n\t\tconst forExpressions = expressions[0].split(' of ').map(x => x.trim());\n\t\tlet value = forExpressions[0].replace(/\\s*let\\s*/, '');\n\t\tconst iterable = forExpressions[1];\n\t\tlet key = 'index';\n\t\tconst keyValueMatches = value.match(/\\[(.+)\\s*,\\s*(.+)\\]/);\n\t\tif (keyValueMatches) {\n\t\t\tkey = keyValueMatches[1];\n\t\t\tvalue = keyValueMatches[2];\n\t\t}\n\t\tif (expressions.length > 1) {\n\t\t\tconst indexExpressions = expressions[1].split(/\\s*let\\s*|\\s*=\\s*index/).map(x => x.trim());\n\t\t\tif (indexExpressions.length === 3) {\n\t\t\t\tkey = indexExpressions[1];\n\t\t\t}\n\t\t}\n\t\treturn { key, value, iterable };\n\t}\n\n}\n\nForStructure.meta = {\n\tselector: '[*for]',\n};\n","import Structure from '../core/structure';\nimport Module from '../module/module';\n\nexport default class IfStructure extends Structure {\n\n\tonInit() {\n\t\tconst context = Module.getContext(this);\n\t\tconst module = context.module;\n\t\tconst node = context.node;\n\t\tconst ifbegin = this.ifbegin = document.createComment(`*if begin`);\n\t\tnode.parentNode.replaceChild(ifbegin, node);\n\t\tconst ifend = this.ifend = document.createComment(`*if end`);\n\t\tifbegin.parentNode.insertBefore(ifend, ifbegin.nextSibling);\n\t\tconst expression = node.getAttribute('*if');\n\t\tthis.expression = expression;\n\t\tthis.ifFunction = module.makeFunction(expression);\n\t\tconst clonedNode = node.cloneNode(true);\n\t\tclonedNode.removeAttribute('*if');\n\t\tthis.clonedNode = clonedNode;\n\t\t// console.log('expression', expression);\n\t}\n\n\tonChanges(changes) {\n\t\tconst context = Module.getContext(this);\n\t\tconst module = context.module;\n\t\t// console.log('IfStructure.onChanges', changes, this.expression);\n\t\tconst value = module.resolve(this.ifFunction, changes, this);\n\t\tif (value) {\n\t\t\tif (!this.clonedNode.parentNode) {\n\t\t\t\tthis.ifend.parentNode.insertBefore(this.clonedNode, this.ifend);\n\t\t\t\tmodule.compile(this.clonedNode);\n\t\t\t}\n\t\t} else {\n\t\t\tif (this.clonedNode.parentNode) {\n\t\t\t\tthis.clonedNode.parentNode.removeChild(this.clonedNode);\n\t\t\t\tmodule.remove(this.clonedNode);\n\t\t\t}\n\t\t}\n\t}\n\n}\n\nIfStructure.meta = {\n\tselector: '[*if]',\n};\n","import Directive from '../core/directive';\nimport Module from '../module/module';\n\nexport default class InnerHtmlDirective extends Directive {\n\n\tonInit() {\n\t\tconst context = Module.getContext(this);\n\t\tconst node = context.node;\n\t\tconst selector = context.selector;\n\t\tconst key = selector.replace(/\\[(.+)\\]/, (...matches) => {\n\t\t\treturn matches[1];\n\t\t});\n\t\tlet expression = node.getAttribute(key);\n\t\tif (!expression) {\n\t\t\tthrow (`invalid ${key}`);\n\t\t}\n\t\tif (key === '[innerHTML]') {\n\t\t\texpression = `{{${expression}}}`;\n\t\t}\n\t\tthis.innerHtmlExpression = expression;\n\t\t// console.log('InnerHtmlDirective.onInit', node, expression, key);\n\t}\n\n\tonChanges(changes) {\n\t\tconst context = Module.getContext(this);\n\t\tconst innerHTML = context.module.evaluate(this.innerHtmlExpression, changes);\n\t\t// console.log('InnerHtmlDirective.onChanges', this.innerHtmlExpression, innerHTML);\n\t\tconst node = context.node;\n\t\tnode.innerHTML = innerHTML;\n\t}\n\n}\n\nInnerHtmlDirective.meta = {\n\tselector: `[[innerHTML]],[innerHTML]`\n};\n","export default class JsonPipe {\n\n\tstatic transform(value) {\n\t\treturn JSON.stringify(value);\n\t}\n\n}\n\nJsonPipe.meta = {\n\tname: 'json',\n};\n","import Directive from '../core/directive';\nimport Module from '../module/module';\n\nexport default class StyleDirective extends Directive {\n\n\tonInit() {\n\t\tconst context = Module.getContext(this);\n\t\tconst module = context.module;\n\t\tconst node = context.node;\n\t\tconst expression = node.getAttribute('[style]');\n\t\tthis.styleFunction = module.makeFunction(expression);\n\t\t// console.log('StyleDirective.onInit', expression);\n\t}\n\n\tonChanges(changes) {\n\t\tconst context = Module.getContext(this);\n\t\tconst module = context.module;\n\t\tconst node = context.node;\n\t\tconst style = module.resolve(this.styleFunction, changes, this);\n\t\tObject.keys(style).forEach(key => {\n\t\t\tnode.style.setProperty(key, style[key]);\n\t\t});\n\t\t// console.log('StyleDirective.onChanges', changes, style);\n\t}\n\n}\n\nStyleDirective.meta = {\n\tselector: `[[style]]`\n};\n","export default class LocalStorageService {\n\n\tstatic delete(name) {\n\t\tif (this.isLocalStorageSupported()) {\n\t\t\twindow.localStorage.removeItem(name);\n\t\t}\n\t}\n\n\tstatic exist(name) {\n\t\tif (this.isLocalStorageSupported()) {\n\t\t\treturn window.localStorage[name] !== undefined;\n\t\t}\n\t}\n\n\tstatic get(name) {\n\t\tlet value = null;\n\t\tif (this.isLocalStorageSupported() && window.localStorage[name] !== undefined) {\n\t\t\ttry {\n\t\t\t\tvalue = JSON.parse(window.localStorage[name]);\n\t\t\t} catch (e) {\n\t\t\t\tconsole.log('LocalStorageService.get.error parsing', name, e);\n\t\t\t}\n\t\t}\n\t\treturn value;\n\t}\n\n\tstatic set(name, value) {\n\t\tif (this.isLocalStorageSupported()) {\n\t\t\ttry {\n\t\t\t\tconst cache = [];\n\t\t\t\tconst json = JSON.stringify(value, function(key, value) {\n\t\t\t\t\tif (typeof value === 'object' && value !== null) {\n\t\t\t\t\t\tif (cache.indexOf(value) !== -1) {\n\t\t\t\t\t\t\t// Circular reference found, discard key\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcache.push(value);\n\t\t\t\t\t}\n\t\t\t\t\treturn value;\n\t\t\t\t});\n\t\t\t\twindow.localStorage.setItem(name, json);\n\t\t\t} catch (e) {\n\t\t\t\tconsole.log('LocalStorageService.set.error serializing', name, value, e);\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic isLocalStorageSupported() {\n\t\tif (this.supported) {\n\t\t\treturn true;\n\t\t}\n\t\tlet supported = false;\n\t\ttry {\n\t\t\tsupported = 'localStorage' in window && window.localStorage !== null;\n\t\t\tif (supported) {\n\t\t\t\twindow.localStorage.setItem('test', '1');\n\t\t\t\twindow.localStorage.removeItem('test');\n\t\t\t} else {\n\t\t\t\tsupported = false;\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tsupported = false;\n\t\t}\n\t\tthis.supported = supported;\n\t\treturn supported;\n\t}\n\n}\n","import { BehaviorSubject, of } from 'rxjs';\nimport { delay } from 'rxjs/operators';\nimport LocalStorageService from '../local-storage/local-storage.service';\n\nexport default class StoreService {\n\n\tstatic set(items) {\n\t\tLocalStorageService.set('items', items);\n\t\treturn this.get$().next(items);\n\t}\n\n\tstatic get$() {\n\t\tif (this.store$) {\n\t\t\treturn this.store$;\n\t\t}\n\t\tlet items = LocalStorageService.get('items');\n\t\tif (!items) {\n\t\t\titems = [\n\t\t\t\t{ id: 5, name: 'Cookies', date: new Date(Date.now()) },\n\t\t\t\t{ id: 4, name: 'Pizza', date: new Date(2019, 4, 4, 12) },\n\t\t\t\t{ id: 3, name: 'Pasta', date: new Date(2019, 3, 22, 12) },\n\t\t\t\t{ id: 2, name: 'Bread', date: new Date(2019, 0, 6, 12) },\n\t\t\t\t{ id: 1, name: 'Ham', date: new Date(2018, 11, 30, 12) },\n\t\t\t];\n\t\t\tLocalStorageService.set('items', items);\n\t\t}\n\t\tthis.store$ = new BehaviorSubject(items);\n\t\treturn this.store$.pipe(\n\t\t\tdelay(1) // simulate http\n\t\t);\n\t}\n\n\tstatic add$(patch) {\n\t\tconst item = Object.assign({\n\t\t\tid: Date.now(),\n\t\t\tdate: new Date(Date.now())\n\t\t}, patch);\n\t\tconst items = this.store$.getValue();\n\t\titems.unshift(item);\n\t\tthis.set(items);\n\t\treturn of(item).pipe(\n\t\t\tdelay(1) // simulate http\n\t\t);\n\t}\n\n\tstatic patch$(patch) {\n\t\tconst items = this.store$.getValue();\n\t\tconst item = items.find(x => x.id === patch.id);\n\t\tif (item) {\n\t\t\tObject.assign(item, patch);\n\t\t\tthis.set(items);\n\t\t}\n\t\treturn of(item).pipe(\n\t\t\tdelay(1) // simulate http\n\t\t);\n\t}\n\n\tstatic delete$(item) {\n\t\tconst items = this.store$.getValue();\n\t\tconst index = items.indexOf(item);\n\t\tif (index !== -1) {\n\t\t\titems.splice(index, 1);\n\t\t\tthis.set(items);\n\t\t}\n\t\treturn of(item).pipe(\n\t\t\tdelay(1) // simulate http\n\t\t);\n\t}\n\n}\n","import { takeUntil } from 'rxjs/operators';\nimport { Component, Module } from '../../src/rxcomp';\nimport StoreService from './store/store.service';\n\nexport default class AppComponent extends Component {\n\n\tonInit() {\n\t\t// context\n\t\tconst context = Module.getContext(this);\n\t\t// input\n\t\tthis.input = context.node.querySelector('.control--text');\n\t\t// items\n\t\tthis.items = [];\n\t\t// store service\n\t\tthis.store$ = StoreService.get$();\n\t\tthis.store$.pipe(\n\t\t\ttakeUntil(this.unsubscribe$)\n\t\t).subscribe(items => {\n\t\t\tthis.items = items;\n\t\t\t// onpush change detection strategy\n\t\t\tthis.pushChanges();\n\t\t});\n\t}\n\n\tonView() {\n\t\tconst context = Module.getContext(this);\n\t\t// console.log('AppComponent.onView', context.node);\n\t}\n\n\tonInput($event) {\n\t\t// console.log('AppComponent.onInput', $event, this);\n\t\tthis.pushChanges();\n\t}\n\n\tonAddItem($event) {\n\t\tif (this.input.value) {\n\t\t\tStoreService.add$({\n\t\t\t\tname: this.input.value,\n\t\t\t}).subscribe(item => {\n\t\t\t\t// console.log('AppComponent.onAddItem', item);\n\t\t\t\tthis.input.value = null;\n\t\t\t});\n\t\t}\n\t}\n\n\tonToggleItem(item) {\n\t\tStoreService.patch$({\n\t\t\tid: item.id,\n\t\t\tdone: !item.done,\n\t\t}).subscribe(item => {\n\t\t\t// console.log('AppComponent.onToggleItem', item);\n\t\t});\n\t}\n\n\tonRemoveItem(item) {\n\t\tStoreService.delete$(item).subscribe(item => {\n\t\t\t// console.log('AppComponent.onRemoveItem', item);\n\t\t});\n\t}\n\n}\n\nAppComponent.meta = {\n\tselector: '[app-component]',\n};\n","export default class DatePipe {\n\n\tstatic transform(value, locale = 'it-IT-u-ca-gregory', options = {\n\t\tdateStyle: 'short',\n\t\ttimeStyle: 'short',\n\t}) {\n\t\tconst localeDateString = new Date(value).toLocaleDateString(locale, options);\n\t\treturn localeDateString;\n\t}\n\n}\n\nDatePipe.meta = {\n\tname: 'date',\n};\n","export const colors = [\n\t{ hex: '#ffffff', background: '#ffffff', foreground: '#003adc', accent: '#212121' },\n\t{ hex: '#212121', background: '#212121', foreground: '#ffffff', accent: '#003adc' },\n\t{ hex: '#ffffff', background: '#ffffff', foreground: '#212121', accent: '#003adc' },\n\t{ hex: '#003adc', background: '#003adc', foreground: '#ffffff', accent: '#212121' },\n];\n\nexport function hexToInt(hex) {\n\treturn parseInt(hex.replace(/^#/, ''), 16);\n}\n\nexport function randomHex() {\n\treturn colors[Math.floor(Math.random() * colors.length)].hex;\n}\n\nexport function randomColor() {\n\tconst hex = randomHex();\n\treturn hexToInt(hex);\n}\n\nexport function color(index, alpha) {\n\treturn hexToRgb(colors[index % colors.length].hex, alpha);\n}\n\nexport function background(index, alpha) {\n\treturn hexToRgb(colors[index % colors.length].background, alpha);\n}\n\nexport function foreground(index, alpha) {\n\treturn hexToRgb(colors[index % colors.length].foreground, alpha);\n}\n\nexport function accent(index, alpha) {\n\treturn hexToRgb(colors[index % colors.length].accent, alpha);\n}\n\nlet index = -1;\n\nexport function nextHex() {\n\tindex++;\n\treturn colors[index % colors.length].hex;\n}\n\nexport function nextColor() {\n\tconst hex = nextHex();\n\treturn hexToInt(hex);\n}\n\nexport function hexToRgb(hex, a) {\n\tconst r = parseInt(hex.slice(1, 3), 16);\n\tconst g = parseInt(hex.slice(3, 5), 16);\n\tconst b = parseInt(hex.slice(5, 7), 16);\n\tif (a) {\n\t\treturn `rgba(${r},${g},${b},${a})`;\n\t} else {\n\t\treturn `rgb(${r},${g},${b})`;\n\t}\n}\n","import { Component } from '../../../src/rxcomp';\nimport { accent, background, foreground } from '../colors/colors';\n\nexport default class TodoItemComponent extends Component {\n\n\t// onInit() {}\n\n\tonChanges(changes) {\n\t\t// console.log('onChanges', changes);\n\t\tthis.background = background(this.item.id);\n\t\tthis.foreground = foreground(this.item.id);\n\t\tthis.accent = accent(this.item.id);\n\t}\n\n\t// onView() {}\n\n\t// onDestroy() {}\n\n\tonToggle($event) {\n\t\t// console.log('onToggle', $event);\n\t\tthis.toggle.next($event);\n\t}\n\n\tonRemove($event) {\n\t\t// console.log('onRemove', $event);\n\t\tthis.remove.next($event);\n\t}\n\n}\n\nTodoItemComponent.meta = {\n\tselector: '[todo-item-component]',\n\tinputs: ['item'],\n\toutputs: ['toggle', 'remove'],\n\t// template syntax example\n\t/*\n\ttemplate: // html // `\n\t\t<button type=\"button\" class=\"btn--toggle\" (click)=\"onToggle(item)\">\n            <i class=\"icon--check\" *if=\"item.done\"></i>\n            <i class=\"icon--circle\" *if=\"!item.done\"></i>\n            <div class=\"title\" [innerHTML]=\"item.name\"></div>\n        </button>\n        <div class=\"date\" [style]=\"{ background: backgroundColor, color: color }\" [innerHTML]=\"item.date | date : 'en-US' : { month: 'short', day: '2-digit', year: 'numeric' }\"></div>\n        <button type=\"button\" class=\"btn--remove\" (click)=\"onRemove(item)\"><i class=\"icon--remove\"></i></button>\n\t`,\n\t*/\n};\n","import { ClassDirective, EventDirective, ForStructure, IfStructure, InnerHtmlDirective, JsonPipe, Module, StyleDirective } from '../../src/rxcomp';\nimport AppComponent from './app.component';\nimport DatePipe from './date/date.pipe';\nimport TodoItemComponent from './todo-item/todo-item.component';\n\nModule.use({\n\tfactories: [\n\t\tClassDirective,\n\t\tEventDirective,\n\t\tForStructure,\n\t\tIfStructure,\n\t\tInnerHtmlDirective,\n\t\tStyleDirective,\n\t\tTodoItemComponent,\n\t],\n\tpipes: [\n\t\tDatePipe,\n\t\tJsonPipe,\n\t],\n\tbootstrap: AppComponent,\n});\n"]}