{"version":3,"sources":["docs/js/main.js","../../lib/directive/directive.js","../../lib/component/component.js","../../lib/module/module.js","../../lib/class/class.directive.js","../../lib/event/event.directive.js","../../lib/structure/structure.js","../../lib/for/for.item.js","../../lib/context/context.js","../../lib/for/for.structure.js","../../lib/if/if.structure.js","../../lib/inner-html/inner-html.directive.js","../../lib/json/json.pipe.js","../../lib/style/style.directive.js","../../src/js/local-storage/local-storage.service.js","../../src/js/store/store.service.js","../../src/js/app.component.js","../../src/js/date/date.pipe.js","../../src/js/colors/colors.js","../../src/js/todo-item/todo-item.component.js","../../src/js/main.js"],"names":["global","factory","exports","module","require","define","amd","self","rxjs","operators","this","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","_inheritsLoose","subClass","superClass","prototype","create","constructor","__proto__","Directive","meta","selector","Component","ID","CONTEXTS","Module","options","bootstrap","pipes","forEach","x","name","node","document","querySelector","root","makeInstance","window","selectors","unwrapSelectors","factories","_proto","use$","_this","of","querySelectorsAll","pipe","filter","matches","map","match","shareReplay","parentInstance","_this2","parentNode","isComponent","getParentScope","instance","defineProperties","state$","value","BehaviorSubject","unsubscribe$","Subject","pushState","next","context","setContext","inputs","makeInputs","outputs","makeOutputs","onInit","takeUntil","subscribe","state","resolveInputsOutputs","onState","parse","remove","ids","traverseDown","_i","_Object$entries","entries","_Object$entries$_i","id","complete","onDestroy","push","compile","parent","_this3","$id","undefined","_this4","parse_eval_","expression","arguments","parse_func_","makeFunction","resolve","parse_replace_","text","replace","childNodes","child","nodeType","nodeValue","replacedText","textNode","createTextNode","replaceChild","expressionFunc","payload","apply","_this5","makeInput","_this6","makeOutput","_this7","getContext","keys","inputFunction","getScope","getComponentInstanceByNode","_this8","traverseUp","optionalChaining","previous","_len","args","Array","_key","tokens","split","a","b","params","transforms","getPipesSegments","shift","trim","reduce","transform","getPipeParamsSegments","join","Function","debug","getAttribute","_this9","outputFunction","output$","tap","event","contexts_","segments","word","block","t","c","substr","indexOf","className","classList","has","attribute","hasAttribute","nodeName","toLowerCase","matchSelectors","results","template","innerHTML","callback","result","j","traversePrevious","previousSibling","traverseNext","nextSibling","find","ClassDirective","_Directive","classFunction","add","EventDirective","event$","fromEvent","Structure","ForItem","_Context","$key","$value","index","count","call","Constructor","protoProps","staticProps","get","even","Context","descriptors","parentPrototypeDescriptors","getOwnPropertyDescriptors","getPrototypeOf","parentDescriptors","_len2","_key2","assign","ForStructure","_Structure","forbegin","createComment","forend","insertBefore","removeAttribute","getExpressionTokens","forFunction","iterable","instances","isArray","array","total","Math","max","clonedNode","cloneNode","removeChild","expressions","forExpressions","keyValueMatches","indexExpressions","IfStructure","ifbegin","ifend","ifFunction","InnerHtmlDirective","innerHtmlFunction","String","JsonPipe","JSON","stringify","StyleDirective","styleFunction","style","LocalStorageService","delete","isLocalStorageSupported","localStorage","removeItem","exist","e","console","log","set","cache","json","setItem","supported","StoreService","items","get$","store$","date","Date","now","add$","patch","item","getValue","unshift","patch$","delete$","splice","AppComponent","_Component","input","onInput","$event","onAddItem","onToggleItem","done","onRemoveItem","DatePipe","locale","dateStyle","timeStyle","toLocaleDateString","colors","hex","color","alpha","r","parseInt","slice","g","TodoItemComponent","backgroundColor","onToggle","toggle","onRemove","createdInstances"],"mappings":"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","file":"docs/js/main.min.js","sourcesContent":[null,"export default class Directive {\n\n}\n\nDirective.meta = {\n\tselector: '[(directive)]',\n};\n","export default class Component {\n\n}\n\nComponent.meta = {\n\tselector: '[component]',\n};\n","import { BehaviorSubject, of , Subject } from 'rxjs';\nimport { filter, map, shareReplay, takeUntil, tap } from 'rxjs/operators';\nimport Component from '../component/component';\n\nlet ID = 0;\nconst CONTEXTS = {};\n\nexport default class Module {\n\n\tconstructor(options) {\n\t\tif (!options) {\n\t\t\tthrow ('missing options');\n\t\t}\n\t\tif (!options.bootstrap) {\n\t\t\tthrow ('missing bootstrap');\n\t\t}\n\t\tthis.options = options;\n\t\tconst pipes = {};\n\t\tif (options.pipes) {\n\t\t\toptions.pipes.forEach(x => pipes[x.meta.name] = x);\n\t\t}\n\t\tthis.pipes = pipes;\n\t\tconst bootstrap = options.bootstrap;\n\t\tthis.node = document.querySelector(bootstrap.meta.selector);\n\t\tif (!this.node) {\n\t\t\tthrow (`missing node ${bootstrap.meta.selector}`);\n\t\t}\n\t\tthis.root = this.makeInstance(this.node, bootstrap, bootstrap.meta.selector, window);\n\t\tthis.selectors = Module.unwrapSelectors(options.factories);\n\t}\n\n\tuse$() {\n\t\treturn of(Module.querySelectorsAll(this.node, this.selectors, [])).pipe(\n\t\t\tfilter(matches => matches.length > 0),\n\t\t\tmap((matches) => {\n\t\t\t\treturn matches.map(match => this.makeInstance(match.node, match.factory, match.selector));\n\t\t\t}),\n\t\t\tshareReplay(1)\n\t\t);\n\t}\n\n\tmakeInstance(node, factory, selector, parentInstance) {\n\t\tif (node.parentNode) {\n\t\t\tconst isComponent = factory.prototype instanceof Component;\n\t\t\tconst meta = factory.meta;\n\t\t\tparentInstance = parentInstance || this.getParentScope(node.parentNode);\n\t\t\tif (!parentInstance) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst instance = new factory();\n\t\t\tObject.defineProperties(instance, {\n\t\t\t\tstate$: {\n\t\t\t\t\tvalue: new BehaviorSubject(instance),\n\t\t\t\t\twritable: false,\n\t\t\t\t\tenumerable: false,\n\t\t\t\t},\n\t\t\t\tunsubscribe$: {\n\t\t\t\t\tvalue: new Subject(),\n\t\t\t\t\twritable: false,\n\t\t\t\t\tenumerable: false,\n\t\t\t\t}\n\t\t\t});\n\t\t\tinstance.pushState = function() {\n\t\t\t\tthis.state$.next(this);\n\t\t\t};\n\t\t\tconst context = Module.setContext(this, instance, parentInstance, node, factory, selector);\n\t\t\tif (isComponent) {\n\t\t\t\tcontext.inputs = this.makeInputs(meta, instance);\n\t\t\t\tcontext.outputs = this.makeOutputs(meta, instance);\n\t\t\t}\n\t\t\tif (typeof instance.onInit === 'function') {\n\t\t\t\tinstance.onInit();\n\t\t\t}\n\t\t\tif (parentInstance.state$) {\n\t\t\t\tparentInstance.state$.pipe(\n\t\t\t\t\t// filter(() => node.parentNode),\n\t\t\t\t\ttakeUntil(instance.unsubscribe$)\n\t\t\t\t).subscribe(state => {\n\t\t\t\t\tif (isComponent) {\n\t\t\t\t\t\tthis.resolveInputsOutputs(instance, state);\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof instance.onState === 'function') {\n\t\t\t\t\t\t// console.log('onState', instance.constructor.meta.selector, state);\n\t\t\t\t\t\tinstance.onState(state);\n\t\t\t\t\t\t/*\n\t\t\t\t\t\tconst context = Module.getContext(instance);\n\t\t\t\t\t\tthis.parse(context.node, instance);\n\t\t\t\t\t\t*/\n\t\t\t\t\t}\n\t\t\t\t\tinstance.pushState();\n\t\t\t\t\tif (isComponent) {\n\t\t\t\t\t\tthis.parse(node, instance);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\t/*\n\t\t\tif (instance.state$) {\n\t\t\t\tinstance.state$.pipe(\n\t\t\t\t\ttakeUntil(instance.unsubscribe$)\n\t\t\t\t).subscribe(state => {\n\t\t\t\t\tif (isComponent) {\n\t\t\t\t\t\tthis.parse(node, instance);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\t*/\n\t\t\treturn instance;\n\t\t}\n\t}\n\n\tremove(node) {\n\t\tconst ids = [];\n\t\tModule.traverseDown(node, (node) => {\n\t\t\tfor (let [id, context] of Object.entries(CONTEXTS)) {\n\t\t\t\tif (context.node === node) {\n\t\t\t\t\tconst instance = context.instance;\n\t\t\t\t\tinstance.unsubscribe$.next();\n\t\t\t\t\tinstance.unsubscribe$.complete();\n\t\t\t\t\tif (typeof instance.onDestroy === 'function') {\n\t\t\t\t\t\tinstance.onDestroy();\n\t\t\t\t\t}\n\t\t\t\t\tids.push(id);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tids.forEach(id => delete CONTEXTS[id]);\n\t\t// console.log('Module.remove', ids);\n\t\treturn node;\n\t}\n\n\tcompile(node, parent) {\n\t\tif (parent) {\n\t\t\tconst $id = ++ID;\n\t\t\tparent.$id = $id;\n\t\t\tconst context = Module.setContext(this, parent, parent.parentInstance, node, parent.constructor);\n\t\t}\n\t\tconst matches = Module.querySelectorsAll(node, this.selectors, []);\n\t\tconst instances = matches.map(match => {\n\t\t\tconst instance = this.makeInstance(match.node, match.factory, match.selector, parent);\n\t\t\tif (match.factory.prototype instanceof Component) {\n\t\t\t\tparent = undefined; // !!!\n\t\t\t}\n\t\t\treturn instance;\n\t\t}).filter(x => x !== undefined);\n\t\treturn instances;\n\t}\n\n\tparse(node, instance) {\n\t\t// console.log('node', node.childNodes.length, node);\n\t\tconst parse_eval_ = (...args) => {\n\t\t\tconst expression = args[1];\n\t\t\t// console.log('expression', expression);\n\t\t\tconst parse_func_ = this.makeFunction(expression);\n\t\t\treturn this.resolve(parse_func_, instance, instance);\n\t\t};\n\t\tconst parse_replace_ = function(text) {\n\t\t\t// console.log(text);\n\t\t\treturn text.replace(/{{2}(?!{)(.*?)}{2}/g, parse_eval_);\n\t\t};\n\t\t/*\n\t\tif (node.hasAttribute('[innerHTML]')) {\n\t\t\tconst innerHTML = `{{${node.getAttribute('[innerHTML]')}}}`;\n\t\t\tnode.innerHTML = parse_replace_(innerHTML);\n\t\t} else if (node.hasAttribute('innerHTML')) {\n\t\t\tconst innerHTML = node.getAttribute('innerHTML');\n\t\t\tnode.innerHTML = parse_replace_(innerHTML);\n\t\t} else {\n\n\t\t}\n\t\t*/\n\t\t// console.log(node, instance);\n\t\tfor (let i = 0; i < node.childNodes.length; i++) {\n\t\t\tconst child = node.childNodes[i];\n\t\t\tif (child.nodeType === 1) {\n\t\t\t\tthis.parse(child, instance);\n\t\t\t} else if (child.nodeType === 3) {\n\t\t\t\tconst text = child.nodeValue;\n\t\t\t\tconst replacedText = parse_replace_(text);\n\t\t\t\tif (text !== replacedText) {\n\t\t\t\t\t// node.setAttribute('innerHTML', text);\n\t\t\t\t\tconst textNode = document.createTextNode(replacedText);\n\t\t\t\t\tnode.replaceChild(textNode, child);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tresolve(expressionFunc, state, payload) {\n\t\treturn expressionFunc.apply(state, [payload, this]);\n\t}\n\n\tmakeInputs(meta, instance) {\n\t\tconst inputs = {};\n\t\tif (meta.inputs) {\n\t\t\tmeta.inputs.forEach((key, i) => inputs[key] = this.makeInput(instance, key));\n\t\t}\n\t\treturn inputs;\n\t}\n\n\tmakeOutputs(meta, instance) {\n\t\tconst outputs = {};\n\t\tif (meta.outputs) {\n\t\t\tmeta.outputs.forEach((key, i) => outputs[key] = this.makeOutput(instance, key));\n\t\t}\n\t\treturn outputs;\n\t}\n\n\tresolveInputsOutputs(instance, state) {\n\t\tconst context = Module.getContext(instance);\n\t\tconst parentInstance = context.parentInstance;\n\t\tconst inputs = context.inputs;\n\t\tObject.keys(inputs).forEach(key => {\n\t\t\tconst inputFunction = inputs[key];\n\t\t\tconst value = this.resolve(inputFunction, parentInstance, instance);\n\t\t\tinstance[key] = value;\n\t\t});\n\t\t/*\n\t\tconst outputs = context.outputs;\n\t\tObject.keys(outputs).forEach(key => {\n\t\t\tconst inpuoutputFunctiontFunction = outputs[key];\n\t\t\tconst value = this.resolve(outputFunction, parentInstance, null);\n\t\t\t// console.log(`setted -> ${key}`, value);\n\t\t});\n\t\t*/\n\t}\n\n\tgetScope(node) {\n\t\tif (node === document) {\n\t\t\treturn window;\n\t\t}\n\t\tconst instance = Module.getComponentInstanceByNode(node);\n\t\treturn instance;\n\t}\n\n\tgetParentScope(node) {\n\t\treturn Module.traverseUp(node, (node) => {\n\t\t\treturn this.getScope(node);\n\t\t});\n\t}\n\n\t//\n\n\toptionalChaining(expression) {\n\t\tconst regex = /(\\w+(\\?\\.))+([\\.|\\w]+)/g;\n\t\tlet previous;\n\t\texpression = expression.replace(regex, (...args) => {\n\t\t\tconst tokens = args[0].split('?.');\n\t\t\tfor (let i = 0; i < tokens.length - 1; i++) {\n\t\t\t\tconst a = i > 0 ? `(${tokens[i]} = ${previous})` : tokens[i];\n\t\t\t\tconst b = tokens[i + 1];\n\t\t\t\tprevious = i > 0 ? `${a}.${b}` : `(${a} ? ${a}.${b} : void 0)`;\n\t\t\t\t// log(previous);\n\t\t\t}\n\t\t\treturn previous || '';\n\t\t});\n\t\treturn expression;\n\t}\n\n\tmakeFunction(expression, params = ['$instance']) {\n\t\tif (!expression) {\n\t\t\treturn () => { return null; };\n\t\t}\n\t\tconst pipes = this.pipes;\n\t\tconst transforms = Module.getPipesSegments(expression);\n\t\texpression = transforms.shift().trim();\n\t\texpression = this.optionalChaining(expression);\n\t\t// console.log('expression', \"${expression}\", ${params.join(',')}, this);\n\t\t// return expression_func;\n\t\t// console.log(pipes, transforms, expression);\n\t\t// console.log(transforms.length, params);\n\t\tparams.push('module');\n\t\t// keyword 'this' represents state from func.apply(state, instance)\n\t\tif (transforms.length) {\n\t\t\texpression = transforms.reduce((expression, transform, i) => {\n\t\t\t\tconst params = Module.getPipeParamsSegments(transform);\n\t\t\t\tconst name = params.shift().trim();\n\t\t\t\tconst pipe = pipes[name];\n\t\t\t\tif (!pipe || typeof pipe.transform !== 'function') {\n\t\t\t\t\tthrow (`missing pipe ${name}`);\n\t\t\t\t}\n\t\t\t\treturn `pipes.${name}.transform(${expression},${params.join(',')})`;\n\t\t\t}, expression);\n\t\t\t// console.log('expression', expression);\n\t\t\tconst expression_func = new Function(`with(this) {\n\t\t\t\treturn (function (${params.join(',')}) {\n\t\t\t\t\tconst pipes = module.pipes;\n\t\t\t\t\treturn ${expression};\n\t\t\t\t}.bind(this)).apply(this, arguments);\n\t\t\t}`);\n\t\t\treturn expression_func;\n\t\t} else {\n\t\t\t// console.log('expression', expression);\n\t\t\tconst expression_func = new Function(this.options.debug ? `with(this) {\n\t\t\t\treturn (function (${params.join(',')}) {\n\t\t\t\t\tlet value;\n\t\t\t\t\ttry {\n\t\t\t\t\t\tvalue = ${expression};\n\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\tvalue = '!!!' + e.message;\n\t\t\t\t\t}\n\t\t\t\t\treturn value;\n\t\t\t\t}.bind(this)).apply(this, arguments);\n\t\t\t}` : `with(this) {\n\t\t\t\treturn (function (${params.join(',')}) {\n\t\t\t\t\treturn ${expression};\n\t\t\t\t}.bind(this)).apply(this, arguments);\n\t\t\t}`);\n\t\t\treturn expression_func;\n\t\t}\n\t}\n\n\tmakeInput(instance, name) {\n\t\tconst context = Module.getContext(instance);\n\t\tconst node = context.node;\n\t\tconst expression = node.getAttribute(`[${name}]`);\n\t\treturn this.makeFunction(expression);\n\t}\n\n\tmakeOutput(instance, name) {\n\t\tconst context = Module.getContext(instance);\n\t\tconst node = context.node;\n\t\tconst parentInstance = context.parentInstance;\n\t\tconst expression = node.getAttribute(`(${name})`);\n\t\tconst outputFunction = this.makeFunction(expression, ['$event']);\n\t\tconst output$ = new Subject().pipe(\n\t\t\ttap((event) => {\n\t\t\t\tthis.resolve(outputFunction, parentInstance, event);\n\t\t\t})\n\t\t);\n\t\toutput$.pipe(\n\t\t\ttakeUntil(instance.unsubscribe$)\n\t\t).subscribe();\n\t\tinstance[name] = output$;\n\t\treturn outputFunction;\n\t}\n\n\t//\n\n\tcontexts_() {\n\t\treturn CONTEXTS;\n\t}\n\n\t//\n\n\tstatic getPipesSegments(expression) {\n\t\tconst segments = [];\n\t\tlet i = 0,\n\t\t\tword = '',\n\t\t\tblock = 0;\n\t\tconst t = expression.length;\n\t\twhile (i < t) {\n\t\t\tconst c = expression.substr(i, 1);\n\t\t\tif (c === '{' || c === '(' || c === '[') {\n\t\t\t\tblock++;\n\t\t\t}\n\t\t\tif (c === '}' || c === ')' || c === ']') {\n\t\t\t\tblock--;\n\t\t\t}\n\t\t\tif (c === '|' && block === 0) {\n\t\t\t\tif (word.length) {\n\t\t\t\t\tsegments.push(word);\n\t\t\t\t}\n\t\t\t\tword = '';\n\t\t\t} else {\n\t\t\t\tword += c;\n\t\t\t}\n\t\t\ti++;\n\t\t}\n\t\tif (word.length) {\n\t\t\tsegments.push(word);\n\t\t}\n\t\treturn segments;\n\t}\n\n\tstatic getPipeParamsSegments(expression) {\n\t\tconst segments = [];\n\t\tlet i = 0,\n\t\t\tword = '',\n\t\t\tblock = 0;\n\t\tconst t = expression.length;\n\t\twhile (i < t) {\n\t\t\tconst c = expression.substr(i, 1);\n\t\t\tif (c === '{' || c === '(' || c === '[') {\n\t\t\t\tblock++;\n\t\t\t}\n\t\t\tif (c === '}' || c === ')' || c === ']') {\n\t\t\t\tblock--;\n\t\t\t}\n\t\t\tif (c === ':' && block === 0) {\n\t\t\t\tif (word.length) {\n\t\t\t\t\tsegments.push(word);\n\t\t\t\t}\n\t\t\t\tword = '';\n\t\t\t} else {\n\t\t\t\tword += c;\n\t\t\t}\n\t\t\ti++;\n\t\t}\n\t\tif (word.length) {\n\t\t\tsegments.push(word);\n\t\t}\n\t\treturn segments;\n\t}\n\n\tstatic unwrapSelectors(factories) {\n\t\tconst selectors = [];\n\t\tfactories.forEach(factory => {\n\t\t\tfactory.meta.selector.split(',').forEach(selector => {\n\t\t\t\tselector = selector.trim();\n\t\t\t\tif (selector.indexOf('.') === 0) {\n\t\t\t\t\tconst className = selector.replace(/\\./g, '');\n\t\t\t\t\tselectors.push((node) => {\n\t\t\t\t\t\tconst match = node.classList.has(className);\n\t\t\t\t\t\treturn match ? { node, factory, selector } : false;\n\t\t\t\t\t});\n\t\t\t\t} else if (selector.match(/\\[(.+)\\]/)) {\n\t\t\t\t\tconst attribute = selector.substr(1, selector.length - 2);\n\t\t\t\t\tselectors.push((node) => {\n\t\t\t\t\t\tconst match = node.hasAttribute(attribute);\n\t\t\t\t\t\treturn match ? { node, factory, selector } : false;\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tselectors.push((node) => {\n\t\t\t\t\t\tconst match = node.nodeName.toLowerCase() === selector.toLowerCase();\n\t\t\t\t\t\treturn match ? { node, factory, selector } : false;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t\treturn selectors;\n\t}\n\n\tstatic matchSelectors(node, selectors, results) {\n\t\tselectors.forEach(selector => {\n\t\t\tconst match = selector(node);\n\t\t\tif (match) {\n\t\t\t\tconst factory = match.factory;\n\t\t\t\tif (factory.prototype instanceof Component && factory.meta.template) {\n\t\t\t\t\tnode.innerHTML = factory.meta.template;\n\t\t\t\t}\n\t\t\t\tresults.push(match);\n\t\t\t}\n\t\t});\n\t\treturn results;\n\t}\n\n\tstatic querySelectorsAll(node, selectors, results) {\n\t\tif (node.nodeType === 1) {\n\t\t\tresults = this.matchSelectors(node, selectors, results);\n\t\t}\n\t\tconst childNodes = node.childNodes;\n\t\tif (childNodes) {\n\t\t\tfor (let i = 0; i < childNodes.length; i++) {\n\t\t\t\tresults = this.querySelectorsAll(childNodes[i], selectors, results);\n\t\t\t}\n\t\t}\n\t\treturn results;\n\t}\n\n\tstatic traverseUp(node, callback, i = 0) {\n\t\tif (!node) {\n\t\t\treturn;\n\t\t}\n\t\tconst result = callback(node, i);\n\t\tif (result) {\n\t\t\treturn result;\n\t\t}\n\t\treturn this.traverseUp(node.parentNode, callback, i + 1);\n\t}\n\n\tstatic traverseDown(node, callback, i = 0) {\n\t\tif (!node) {\n\t\t\treturn;\n\t\t}\n\t\tlet result = callback(node, i);\n\t\tif (result) {\n\t\t\treturn result;\n\t\t}\n\t\tif (node.nodeType === 1) {\n\t\t\tlet j = 0,\n\t\t\t\tt = node.childNodes.length;\n\t\t\twhile (j < t && !result) {\n\t\t\t\tresult = this.traverseDown(node.childNodes[j], callback, i + 1);\n\t\t\t\tj++;\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tstatic traversePrevious(node, callback, i = 0) {\n\t\tif (!node) {\n\t\t\treturn;\n\t\t}\n\t\tconst result = callback(node, i);\n\t\tif (result) {\n\t\t\treturn result;\n\t\t}\n\t\treturn this.traversePrevious(node.previousSibling, callback, i + 1);\n\t}\n\n\tstatic traverseNext(node, callback, i = 0) {\n\t\tif (!node) {\n\t\t\treturn;\n\t\t}\n\t\tconst result = callback(node, i);\n\t\tif (result) {\n\t\t\treturn result;\n\t\t}\n\t\treturn this.traverseNext(node.nextSibling, callback, i + 1);\n\t}\n\n\tstatic use$(options) {\n\t\t/*\n\t\tif (!options.factories) {\n\t\t\toptions.factories = [\n\t\t\t\tClassDirective,\n\t\t\t\tEventDirective,\n\t\t\t\tIfStructure,\n\t\t\t\tForStructure,\n\t\t\t\tStyleDirective\n\t\t\t];\n\t\t}\n\t\tif (!options.pipes) {\n\t\t\toptions.pipes = [\n\t\t\t\tJsonPipe\n\t\t\t];\n\t\t}\n\t\t*/\n\t\treturn new Module(options).use$();\n\t}\n\n\tstatic getContext(instance) {\n\t\treturn CONTEXTS[instance.$id];\n\t}\n\n\tstatic setContext(module, instance, parentInstance, node, factory, selector) {\n\t\tconst $id = ++ID;\n\t\tinstance.$id = $id;\n\t\treturn CONTEXTS[$id] = { module, instance, parentInstance, node, factory, selector };\n\t}\n\n\tstatic getComponentInstanceByNode(node) {\n\t\tconst id = Object.keys(CONTEXTS).find(id => CONTEXTS[id].node === node && CONTEXTS[id].factory.prototype instanceof Component);\n\t\tif (id) {\n\t\t\tconst context = CONTEXTS[id];\n\t\t\treturn context.instance;\n\t\t}\n\t}\n\n}\n","import Directive from '../directive/directive';\nimport Module from '../module/module';\n\nexport default class ClassDirective extends Directive {\n\n\tonInit() {\n\t\tconst context = Module.getContext(this);\n\t\tconst module = context.module;\n\t\tconst node = context.node;\n\t\tconst expression = node.getAttribute('[class]');\n\t\tthis.classFunction = module.makeFunction(expression);\n\t\t// this.classList = [...node.classList.keys()];\n\t\t// console.log('ClassDirective.onInit', this.classList, expression);\n\t}\n\n\tonState(state) {\n\t\tconst context = Module.getContext(this);\n\t\tconst module = context.module;\n\t\tconst node = context.node;\n\t\tconst classList = module.resolve(this.classFunction, state, this);\n\t\tObject.keys(classList).forEach(key => {\n\t\t\tif (classList[key]) {\n\t\t\t\tnode.classList.add(key);\n\t\t\t} else {\n\t\t\t\tnode.classList.remove(key);\n\t\t\t}\n\t\t});\n\t\t// console.log('ClassDirective.onState', classList);\n\t}\n\n}\n\nClassDirective.meta = {\n\tselector: `[[class]]`,\n};\n","import { fromEvent } from 'rxjs';\nimport { shareReplay, takeUntil } from 'rxjs/operators';\nimport Directive from '../directive/directive';\nimport Module from '../module/module';\n\nconst EVENTS = ['click', 'mousedown', 'mouseup', 'touchstart', 'touchmove', 'touchend', 'keydown', 'keyup', 'input', 'change', 'loaded'];\n\nexport default class EventDirective extends Directive {\n\n\tonInit() {\n\t\tconst context = Module.getContext(this);\n\t\tconst module = context.module;\n\t\tconst node = context.node;\n\t\tconst selector = context.selector;\n\t\tconst parentInstance = context.parentInstance;\n\t\tconst event = this.event = selector.replace(/\\[|\\]|\\(|\\)/g, '');\n\t\tconst event$ = this.event$ = fromEvent(node, event).pipe(shareReplay(1));\n\t\tconst expression = node.getAttribute(`(${event})`);\n\t\tif (expression) {\n\t\t\tconst outputFunction = module.makeFunction(expression, ['$event']);\n\t\t\tevent$.pipe(\n\t\t\t\ttakeUntil(this.unsubscribe$)\n\t\t\t).subscribe(event => {\n\t\t\t\t// console.log(parentInstance);\n\t\t\t\tmodule.resolve(outputFunction, parentInstance, event);\n\t\t\t});\n\t\t} else {\n\t\t\tparentInstance[`${event}$`] = event$;\n\t\t}\n\t\t// console.log('EventDirective.onInit', 'selector', selector, 'event', event);\n\t}\n\n}\n\nEventDirective.meta = {\n\tselector: `[(${EVENTS.join(')],[(')})]`,\n};\n","export default class Structure {\n\n}\n\nStructure.meta = {\n\tselector: '[(directive)]',\n};\n","import Context from '../context/context';\n\nexport default class ForItem extends Context {\n\n\tconstructor(key, $key, value, $value, index, count, parentInstance) {\n\t\t// console.log(key, $key, value, $value);\n\t\tsuper(parentInstance);\n\t\t/*\n\t\tsuper(parentInstance, {\n\t\t\t[key]: {\n\t\t\t\tget: function() {\n\t\t\t\t\treturn this.$key;\n\t\t\t\t},\n\t\t\t\tset: function(key) {\n\t\t\t\t\tthis.$key = key;\n\t\t\t\t}\n\t\t\t},\n\t\t\t[value]: {\n\t\t\t\tget: function() {\n\t\t\t\t\treturn this.$value;\n\t\t\t\t},\n\t\t\t\tset: function(value) {\n\t\t\t\t\tthis.$value = value;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\t*/\n\t\tthis[key] = $key;\n\t\tthis[value] = $value;\n\t\tthis.index = index;\n\t\tthis.count = count;\n\t}\n\n\tget first() { return this.index === 0; }\n\n\tget last() { return this.index === this.count - 1; }\n\n\tget even() { return this.index % 2 === 0; }\n\n\tget odd() { return !this.even; }\n\n}\n","import { BehaviorSubject, Subject } from \"rxjs\";\n\nexport default class Context {\n\n\tconstructor(parent, descriptors) {\n\t\tconst parentPrototypeDescriptors = Object.getOwnPropertyDescriptors(Object.getPrototypeOf(parent));\n\t\tdelete parentPrototypeDescriptors.constructor;\n\t\tObject.keys(parentPrototypeDescriptors).forEach(key => {\n\t\t\tconst descriptor = parentPrototypeDescriptors[key];\n\t\t\tif (typeof descriptor.value == \"function\") {\n\t\t\t\tdescriptor.value = (...args) => {\n\t\t\t\t\tparent[key].apply(parent, args);\n\t\t\t\t};\n\t\t\t}\n\t\t});\n\t\t// console.log('parentPrototypeDescriptors', parentPrototypeDescriptors);\n\t\tconst parentDescriptors = Object.getOwnPropertyDescriptors(parent);\n\t\tObject.keys(parentDescriptors).forEach(key => {\n\t\t\tconst descriptor = parentDescriptors[key];\n\t\t\tif (typeof descriptor.value == \"function\") {\n\t\t\t\tdescriptor.value = (...args) => {\n\t\t\t\t\tparent[key].apply(parent, args);\n\t\t\t\t};\n\t\t\t}\n\t\t});\n\t\t// console.log('parentDescriptors', parentDescriptors);\n\t\tObject.defineProperties(this, Object.assign(parentPrototypeDescriptors, parentDescriptors, {\n\t\t\tstate$: {\n\t\t\t\tvalue: new BehaviorSubject(this),\n\t\t\t\twritable: false,\n\t\t\t\tenumerable: false,\n\t\t\t},\n\t\t\tunsubscribe$: {\n\t\t\t\tvalue: new Subject(),\n\t\t\t\twritable: false,\n\t\t\t\tenumerable: false,\n\t\t\t}\n\t\t}, descriptors));\n\t\t/*\n\t\tthis.pushState = () => {\n\t\t\tthis.state$.next(this);\n\t\t};\n\t\t*/\n\t}\n\n\tpushState() {\n\t\tthis.state$.next(this);\n\t}\n\n}\n","import Module from '../module/module';\nimport Structure from '../structure/structure';\nimport ForItem from './for.item';\n\nexport default class ForStructure extends Structure {\n\n\tonInit() {\n\t\tconst context = Module.getContext(this);\n\t\tconst module = context.module;\n\t\tconst node = context.node;\n\t\tconst forbegin = this.forbegin = document.createComment(`*for begin`);\n\t\tnode.parentNode.replaceChild(forbegin, node);\n\t\tconst forend = this.forend = document.createComment(`*for end`);\n\t\tforbegin.parentNode.insertBefore(forend, forbegin.nextSibling);\n\t\tconst expression = node.getAttribute('*for');\n\t\tnode.removeAttribute('*for');\n\t\tconst tokens = this.tokens = this.getExpressionTokens(expression);\n\t\tthis.forFunction = module.makeFunction(tokens.iterable);\n\t\tthis.instances = [];\n\t}\n\n\tonState(state) {\n\t\tconst context = Module.getContext(this);\n\t\tconst module = context.module;\n\t\tconst node = context.node;\n\t\t// resolve\n\t\tconst tokens = this.tokens;\n\t\tlet result = module.resolve(this.forFunction, state, this) || [];\n\t\tconst isArray = Array.isArray(result);\n\t\tconst array = isArray ? result : Object.keys(result);\n\t\tconst total = array.length;\n\t\tconst previous = this.instances.length;\n\t\tlet nextSibling = this.forbegin.nextSibling;\n\t\tfor (let i = 0; i < Math.max(previous, total); i++) {\n\t\t\tif (i < total) {\n\t\t\t\tconst key = isArray ? i : array[i];\n\t\t\t\tconst value = isArray ? array[key] : result[key];\n\t\t\t\tif (i < previous) {\n\t\t\t\t\t// update\n\t\t\t\t\tconst clonedNode = nextSibling;\n\t\t\t\t\tconst instance = this.instances[i];\n\t\t\t\t\tinstance[tokens.key] = key;\n\t\t\t\t\tinstance[tokens.value] = value;\n\t\t\t\t\tinstance.pushState();\n\t\t\t\t\tmodule.parse(clonedNode, instance);\n\t\t\t\t\tnextSibling = nextSibling.nextSibling;\n\t\t\t\t} else {\n\t\t\t\t\t// create\n\t\t\t\t\tconst clonedNode = node.cloneNode(true);\n\t\t\t\t\tthis.forend.parentNode.insertBefore(clonedNode, this.forend);\n\t\t\t\t\tconst instance = new ForItem(tokens.key, key, tokens.value, value, i, total, context.parentInstance);\n\t\t\t\t\tmodule.compile(clonedNode, instance);\n\t\t\t\t\tmodule.parse(clonedNode, instance);\n\t\t\t\t\tnextSibling = clonedNode.nextSibling;\n\t\t\t\t\tthis.instances.push(instance);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// remove\n\t\t\t\tconst instance = this.instances[i];\n\t\t\t\tconst context = Module.getContext(instance);\n\t\t\t\tconst node = context.node;\n\t\t\t\tnode.parentNode.removeChild(node);\n\t\t\t\tmodule.remove(node);\n\t\t\t}\n\t\t}\n\t\tthis.instances.length = array.length;\n\t\t// console.log(this.instances, tokens);\n\t}\n\n\tgetExpressionTokens(expression) {\n\t\tif (expression === null) {\n\t\t\tthrow ('invalid for');\n\t\t}\n\t\tif (expression.trim().indexOf('let ') === -1 || expression.trim().indexOf(' of ') === -1) {\n\t\t\tthrow ('invalid for');\n\t\t}\n\t\tconst expressions = expression.split(';').map(x => x.trim()).filter(x => x !== '');\n\t\tconst forExpressions = expressions[0].split(' of ').map(x => x.trim());\n\t\tlet value = forExpressions[0].replace(/\\s*let\\s*/, '');\n\t\tconst iterable = forExpressions[1];\n\t\tlet key = 'index';\n\t\tconst keyValueMatches = value.match(/\\[(.+)\\s*,\\s*(.+)\\]/);\n\t\tif (keyValueMatches) {\n\t\t\tkey = keyValueMatches[1];\n\t\t\tvalue = keyValueMatches[2];\n\t\t}\n\t\tif (expressions.length > 1) {\n\t\t\tconst indexExpressions = expressions[1].split(/\\s*let\\s*|\\s*=\\s*index/).map(x => x.trim());\n\t\t\tif (indexExpressions.length === 3) {\n\t\t\t\tkey = indexExpressions[1];\n\t\t\t}\n\t\t}\n\t\treturn { key, value, iterable };\n\t}\n\n\t/*\n\tonState_unoptimized(state) {\n\t\tconst context = Module.getContext(this);\n\t\tconst module = context.module;\n\t\tconst node = context.node;\n\t\tconst tokens = this.tokens;\n\t\twhile (this.forbegin.nextSibling !== this.forend) {\n\t\t\tconst nextSibling = this.forbegin.nextSibling;\n\t\t\tthis.forbegin.parentNode.removeChild(nextSibling);\n\t\t\tmodule.remove(nextSibling);\n\t\t}\n\t\tconst array = module.resolve(this.forFunction, state, this).map((value, index, array) => {\n\t\t\tconst item = new ForItem(tokens.key, index, tokens.value, value, array, this.parent);\n\t\t\tconst clonedNode = node.cloneNode(true);\n\t\t\tthis.forend.parentNode.insertBefore(clonedNode, this.forend);\n\t\t\tconst instances = module.compile(clonedNode, item);\n\t\t\tmodule.parse(clonedNode, item);\n\t\t\treturn item;\n\t\t});\n\t\t// console.log('ForStructure.onState', array);\n\t}\n\t*/\n\n}\n\nForStructure.meta = {\n\tselector: '[*for]',\n};\n","import Module from '../module/module';\nimport Structure from '../structure/structure';\n\nexport default class IfStructure extends Structure {\n\n\tonInit() {\n\t\tconst context = Module.getContext(this);\n\t\tconst module = context.module;\n\t\tconst node = context.node;\n\t\tconst ifbegin = this.ifbegin = document.createComment(`*if begin`);\n\t\tnode.parentNode.replaceChild(ifbegin, node);\n\t\tconst ifend = this.ifend = document.createComment(`*if end`);\n\t\tifbegin.parentNode.insertBefore(ifend, ifbegin.nextSibling);\n\t\tconst expression = node.getAttribute('*if');\n\t\tthis.expression = expression;\n\t\tthis.ifFunction = module.makeFunction(expression);\n\t\tconst clonedNode = node.cloneNode(true);\n\t\tclonedNode.removeAttribute('*if');\n\t\tthis.clonedNode = clonedNode;\n\t\t// console.log('expression', expression);\n\t}\n\n\tonState(state) {\n\t\tconst context = Module.getContext(this);\n\t\tconst module = context.module;\n\t\t// console.log('IfStructure.onState', state, this.expression);\n\t\tconst value = module.resolve(this.ifFunction, state, this);\n\t\tif (value) {\n\t\t\tif (!this.clonedNode.parentNode) {\n\t\t\t\tthis.ifend.parentNode.insertBefore(this.clonedNode, this.ifend);\n\t\t\t\tmodule.compile(this.clonedNode);\n\t\t\t\tmodule.parse(this.clonedNode, state);\n\t\t\t}\n\t\t} else {\n\t\t\tif (this.clonedNode.parentNode) {\n\t\t\t\tthis.clonedNode.parentNode.removeChild(this.clonedNode);\n\t\t\t\tmodule.remove(this.clonedNode);\n\t\t\t}\n\t\t}\n\t}\n\n}\n\nIfStructure.meta = {\n\tselector: '[*if]',\n};\n","import Directive from '../directive/directive';\nimport Module from '../module/module';\n\nexport default class InnerHtmlDirective extends Directive {\n\n\tonInit() {\n\t\tconst context = Module.getContext(this);\n\t\tconst module = context.module;\n\t\tconst node = context.node;\n\t\tconst selector = context.selector;\n\t\tconst key = selector.replace(/\\[(.+)\\]/, (...matches) => {\n\t\t\treturn matches[1];\n\t\t});\n\t\tlet expression = node.getAttribute(key);\n\t\tif (!expression) {\n\t\t\tthrow (`invalid ${key}`);\n\t\t}\n\t\tif (key === 'innerHTML') {\n\t\t\texpression = expression.replace(/{{(.+)}}/, (...matches) => {\n\t\t\t\treturn matches[1];\n\t\t\t});\n\t\t}\n\t\tthis.innerHtmlFunction = module.makeFunction(expression);\n\t\t// console.log('InnerHtmlDirective.onInit', node, expression, selector);\n\t}\n\n\tonState(state) {\n\t\tconst context = Module.getContext(this);\n\t\tconst module = context.module;\n\t\tconst node = context.node;\n\t\tconst innerHTML = module.resolve(this.innerHtmlFunction, state, this);\n\t\tnode.innerHTML = String(innerHTML);\n\t\t// console.log('InnerHtmlDirective.onState', state, innerHTML);\n\t}\n\n}\n\nInnerHtmlDirective.meta = {\n\tselector: `[[innerHTML]],[innerHTML]`\n};\n","export default class JsonPipe {\n\n\tstatic transform(value) {\n\t\treturn JSON.stringify(value);\n\t}\n\n}\n\nJsonPipe.meta = {\n\tname: 'json',\n};\n","import Directive from '../directive/directive';\nimport Module from '../module/module';\n\nexport default class StyleDirective extends Directive {\n\n\tonInit() {\n\t\tconst context = Module.getContext(this);\n\t\tconst module = context.module;\n\t\tconst node = context.node;\n\t\tconst expression = node.getAttribute('[style]');\n\t\tthis.styleFunction = module.makeFunction(expression);\n\t\t// console.log('StyleDirective.onInit', expression);\n\t}\n\n\tonState(state) {\n\t\tconst context = Module.getContext(this);\n\t\tconst module = context.module;\n\t\tconst node = context.node;\n\t\tconst style = module.resolve(this.styleFunction, state, this);\n\t\tObject.keys(style).forEach(key => {\n\t\t\tnode.style[key] = style[key];\n\t\t});\n\t\t// console.log('StyleDirective.onState', state, style);\n\t}\n\n}\n\nStyleDirective.meta = {\n\tselector: `[[style]]`\n};\n","export default class LocalStorageService {\n\n\tstatic delete(name) {\n\t\tif (this.isLocalStorageSupported()) {\n\t\t\twindow.localStorage.removeItem(name);\n\t\t}\n\t}\n\n\tstatic exist(name) {\n\t\tif (this.isLocalStorageSupported()) {\n\t\t\treturn window.localStorage[name] !== undefined;\n\t\t}\n\t}\n\n\tstatic get(name) {\n\t\tlet value = null;\n\t\tif (this.isLocalStorageSupported() && window.localStorage[name] !== undefined) {\n\t\t\ttry {\n\t\t\t\tvalue = JSON.parse(window.localStorage[name]);\n\t\t\t} catch (e) {\n\t\t\t\tconsole.log('LocalStorageService.get.error parsing', name, e);\n\t\t\t}\n\t\t}\n\t\treturn value;\n\t}\n\n\tstatic set(name, value) {\n\t\tif (this.isLocalStorageSupported()) {\n\t\t\ttry {\n\t\t\t\tconst cache = [];\n\t\t\t\tconst json = JSON.stringify(value, function(key, value) {\n\t\t\t\t\tif (typeof value === 'object' && value !== null) {\n\t\t\t\t\t\tif (cache.indexOf(value) !== -1) {\n\t\t\t\t\t\t\t// Circular reference found, discard key\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcache.push(value);\n\t\t\t\t\t}\n\t\t\t\t\treturn value;\n\t\t\t\t});\n\t\t\t\twindow.localStorage.setItem(name, json);\n\t\t\t} catch (e) {\n\t\t\t\tconsole.log('LocalStorageService.set.error serializing', name, value, e);\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic isLocalStorageSupported() {\n\t\tif (this.supported) {\n\t\t\treturn true;\n\t\t}\n\t\tlet supported = false;\n\t\ttry {\n\t\t\tsupported = 'localStorage' in window && window.localStorage !== null;\n\t\t\tif (supported) {\n\t\t\t\twindow.localStorage.setItem('test', '1');\n\t\t\t\twindow.localStorage.removeItem('test');\n\t\t\t} else {\n\t\t\t\tsupported = false;\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tsupported = false;\n\t\t}\n\t\tthis.supported = supported;\n\t\treturn supported;\n\t}\n\n}\n","import { BehaviorSubject, of } from 'rxjs';\nimport LocalStorageService from '../local-storage/local-storage.service';\n\nexport default class StoreService {\n\n\tstatic set(items) {\n\t\tLocalStorageService.set('items', items);\n\t\treturn this.get$().next(items);\n\t}\n\n\tstatic get$() {\n\t\tif (this.store$) {\n\t\t\treturn this.store$;\n\t\t}\n\t\tlet items = LocalStorageService.get('items');\n\t\tif (!items) {\n\t\t\titems = [\n\t\t\t\t{ id: 3, name: 'cookies', date: new Date(Date.now()) },\n\t\t\t\t{ id: 2, name: 'pizza', date: new Date(2019, 3, 22, 12) },\n\t\t\t\t{ id: 1, name: 'bread', date: new Date(2019, 0, 6, 12) },\n\t\t\t];\n\t\t\tLocalStorageService.set('items', items);\n\t\t}\n\t\treturn this.store$ = new BehaviorSubject(items);\n\t}\n\n\tstatic add$(patch) {\n\t\tconst item = Object.assign({\n\t\t\tid: Date.now(),\n\t\t\tdate: new Date(Date.now())\n\t\t}, patch);\n\t\tconst items = this.store$.getValue();\n\t\titems.unshift(item);\n\t\tthis.set(items);\n\t\treturn of(item);\n\t}\n\n\tstatic patch$(patch) {\n\t\tconst items = this.store$.getValue();\n\t\tconst item = items.find(x => x.id === patch.id);\n\t\tif (item) {\n\t\t\tObject.assign(item, patch);\n\t\t\tthis.set(items);\n\t\t}\n\t\treturn of(item);\n\t}\n\n\tstatic delete$(item) {\n\t\tconst items = this.store$.getValue();\n\t\tconst index = items.indexOf(item);\n\t\tif (index !== -1) {\n\t\t\titems.splice(index, 1);\n\t\t\tthis.set(items);\n\t\t}\n\t\treturn of(item);\n\t}\n\n}\n","/*\nimport { fromEvent } from 'rxjs';\nimport { auditTime, distinctUntilChanged, map, takeUntil } from 'rxjs/operators';\n*/\nimport { takeUntil } from 'rxjs/operators';\nimport { Component, Module } from '../../lib/rxcomp';\nimport StoreService from './store/store.service';\n\nexport default class AppComponent extends Component {\n\n\tonInit() {\n\t\tconst context = Module.getContext(this);\n\t\tthis.input = context.node.querySelector('.control--text');\n\t\tthis.items = [];\n\t\tthis.store$ = StoreService.get$();\n\t\tthis.store$.pipe(\n\t\t\ttakeUntil(this.unsubscribe$)\n\t\t).subscribe(items => {\n\t\t\t// console.log('AppComponent.store$', items);\n\t\t\tthis.items = items;\n\t\t\tthis.pushState();\n\t\t});\n\t\t/*\n\t\tthis.input$().pipe(\n\t\t\ttakeUntil(this.unsubscribe$)\n\t\t).subscribe(input => {\n\t\t\t// console.log(input);\n\t\t\tthis.input = input;\n\t\t});\n\t\t*/\n\t\t// console.log('AppComponent', Object.keys(this).join(','));\n\t}\n\n\t/*\n\tinput$() {\n\t\tconst context = Module.getContext(this);\n\t\tconst input = context.node.querySelector('.control--text');\n\t\treturn fromEvent(input, 'input').pipe(\n\t\t\tmap(event => input.value),\n\t\t\tauditTime(200),\n\t\t\tdistinctUntilChanged()\n\t\t);\n\t}\n\t*/\n\n\tonInput($event) {\n\t\t// console.log('AppComponent.onInput', $event, this);\n\t\tthis.pushState();\n\t}\n\n\tonAddItem($event) {\n\t\tif (this.input.value) {\n\t\t\tStoreService.add$({\n\t\t\t\tname: this.input.value,\n\t\t\t}).subscribe(item => {\n\t\t\t\t// console.log('AppComponent.onAddItem', item);\n\t\t\t\tthis.input.value = null;\n\t\t\t});\n\t\t}\n\t}\n\n\tonToggleItem(item) {\n\t\tStoreService.patch$({\n\t\t\tid: item.id,\n\t\t\tdone: !item.done,\n\t\t}).subscribe(item => {\n\t\t\t// console.log('AppComponent.onToggleItem', item);\n\t\t});\n\t}\n\n\tonRemoveItem(item) {\n\t\tStoreService.delete$(item).subscribe(item => {\n\t\t\t// console.log('AppComponent.onRemoveItem', item);\n\t\t});\n\t}\n\n}\n\nAppComponent.meta = {\n\tselector: '[app-component]',\n};\n","\n\nexport default class DatePipe {\n\n\tstatic transform(value, locale = 'it-IT-u-ca-gregory', options = {\n\t\tdateStyle: 'short',\n\t\ttimeStyle: 'short',\n\t}) {\n\t\treturn new Date(value).toLocaleDateString(locale, options);\n\t}\n\n}\n\nDatePipe.meta = {\n\tname: 'date',\n};\n","export const colors = [\n\t{ hex: '#073B4C' },\n\t{ hex: '#EF476F' },\n\t{ hex: '#1CCC9D' },\n\t{ hex: '#118AB2' },\n\t{ hex: '#EFC156' },\n];\n\nexport function hexToInt(hex) {\n\treturn parseInt(hex.replace(/^#/, ''), 16);\n}\n\nexport function randomHex() {\n\treturn colors[Math.floor(Math.random() * colors.length)].hex;\n}\n\nexport function randomColor() {\n\tconst hex = randomHex();\n\treturn hexToInt(hex);\n}\n\nexport function color(index, alpha) {\n\treturn hexToRgb(colors[index % colors.length].hex, alpha);\n}\n\nlet index = -1;\n\nexport function nextHex() {\n\tindex++;\n\treturn colors[index % colors.length].hex;\n}\n\nexport function nextColor() {\n\tconst hex = nextHex();\n\treturn hexToInt(hex);\n}\n\nexport function hexToRgb(hex, a) {\n\tconst r = parseInt(hex.slice(1, 3), 16);\n\tconst g = parseInt(hex.slice(3, 5), 16);\n\tconst b = parseInt(hex.slice(5, 7), 16);\n\tif (a) {\n\t\treturn `rgba(${r},${g},${b},${a})`;\n\t} else {\n\t\treturn `rgb(${r},${g},${b})`;\n\t}\n}\n","import Component from '../../../lib/component/component';\nimport { color } from '../colors/colors';\n\nexport default class TodoItemComponent extends Component {\n\n\tonState(state) {\n\t\t// console.log('onState', state);\n\t\tthis.backgroundColor = color(this.item.id, 0.15);\n\t\tthis.color = color(this.item.id);\n\t}\n\n\tonToggle($event) {\n\t\t// console.log('onToggle', $event);\n\t\tthis.toggle.next($event);\n\t}\n\n\tonRemove($event) {\n\t\t// console.log('onRemove', $event);\n\t\tthis.remove.next($event);\n\t}\n\n}\n\nTodoItemComponent.meta = {\n\tselector: '[todo-item-component]',\n\tinputs: ['item'],\n\toutputs: ['toggle', 'remove'],\n\ttemplate: /* html */ `\n\t\t<button type=\"button\" class=\"btn--toggle\" [style]=\"{ color: color }\" (click)=\"onToggle(item)\">\n\t\t\t<i class=\"icon--check\" *if=\"item.done\"></i>\n\t\t\t<i class=\"icon--circle\" *if=\"!item.done\"></i>\n\t\t</button>\n\t\t<div class=\"title\" [style]=\"{ color: color }\" [innerHTML]=\"item.name\"></div>\n\t\t<div class=\"date\" [style]=\"{ background: backgroundColor, color: color }\" [innerHTML]=\"item.date | date : 'en-US' : { month: 'short', day: '2-digit', year: 'numeric' }\"></div>\n\t\t<button type=\"button\" class=\"btn--remove\" [style]=\"{ color: color }\" (click)=\"onRemove(item)\"><i class=\"icon--remove\"></i></button>\n\t`,\n};\n","import { ClassDirective, EventDirective, ForStructure, IfStructure, InnerHtmlDirective, JsonPipe, Module, StyleDirective } from '../../lib/rxcomp';\nimport AppComponent from './app.component';\nimport DatePipe from './date/date.pipe';\nimport TodoItemComponent from './todo-item/todo-item.component';\n\nModule.use$({\n\tfactories: [\n\t\tClassDirective,\n\t\tEventDirective,\n\t\tForStructure,\n\t\tIfStructure,\n\t\tInnerHtmlDirective,\n\t\tStyleDirective,\n\t\tTodoItemComponent,\n\t],\n\tpipes: [\n\t\tDatePipe,\n\t\tJsonPipe,\n\t],\n\tbootstrap: AppComponent,\n}).subscribe(createdInstances => {\n\t// console.log('createdInstances', createdInstances);\n});\n"]}