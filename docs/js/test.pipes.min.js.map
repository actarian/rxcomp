{"version":3,"sources":["docs/js/test.pipes.js","../../src/core/directive.js","../../src/core/component.js","../../src/core/context.js","../../src/module/module.js","../../src/class/class.directive.js","../../src/event/event.directive.js","../../src/core/structure.js","../../src/for/for.item.js","../../src/for/for.structure.js","../../src/if/if.structure.js","../../src/inner-html/inner-html.directive.js","../../src/core/pipe.js","../../src/json/json.pipe.js","../../src/style/style.directive.js","../../src/core.module.js","../../src/platform/platform.js","../../src/platform/browser.js","../../test/js/test.pipes.js"],"names":["global","factory","exports","module","require","define","amd","self","rxjs","operators","this","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","_inheritsLoose","subClass","superClass","prototype","create","constructor","__proto__","_setPrototypeOf","o","p","setPrototypeOf","_construct","Parent","args","Class","Reflect","construct","sham","Proxy","Date","toString","call","e","isNativeReflectConstruct","a","push","apply","instance","Function","bind","arguments","Directive","Component","RESERVED_PROPERTIES","Context","_Component","descriptors","_this","mergeDescriptors","getPrototypeOf","defineProperties","ReferenceError","_assertThisInitialized","source","properties","getOwnPropertyNames","_loop","shift","indexOf","hasOwnProperty","getOwnPropertyDescriptor","value","_len","Array","_key","ID","CONTEXTS","NODES","Module","_proto","compile","node","parentInstance","componentNode","querySelectorsAll","meta","selectors","map","match","undefined","makeInstance","selector","filter","x","_this2","parentNode","isComponent","getParentInstance","initialized","context","makeContext","changes$","BehaviorSubject","unsubscribe$","Subject","pushChanges","next","parse","setTimeout","onView","makeHosts","inputs","makeInputs","outputs","makeOutputs","onInit","pipe","takeUntil","subscribe","changes","resolveInputsOutputs","onChanges","makeFunction","expression","params","join","pipes","transforms","getPipesSegments","console","log","trim","transformOptionalChaining","reduce","transform","getPipeParamsSegments","name","getInstance","document","window","getContextByNode","_this3","traverseUp","evaluate","text","_this4","replace","parse_func_","resolve","error","message","childNodes","child","nodeType","nodeExpression","nodeValue","replacedText","textNode","createTextNode","replaceChild","expressionFunc","payload","hosts","keys","forEach","getHost","getContext","rxcompId","nodeContexts","makeInput","input","hasAttribute","getAttribute","_this5","makeOutput","_this6","outputFunction","output$","tap","event","_this7","inputFunction","previous","tokens","split","b","destroy","remove","innerHTML","nodeInnerHTML","keepInstance","keepContext","traverseDown","deleteContext","rxcompNodeId","id","keepContexts","complete","onDestroy","segments","word","block","t","c","substr","matchSelectors","results","template","callback","result","j","traversePrevious","previousSibling","traverseNext","nextSibling","current","ClassDirective","_Directive","_getContext","classFunction","_getContext2","classList","add","EventDirective","event$","fromEvent","shareReplay","Structure","ForItem","_Context","$key","$value","index","count","Constructor","protoProps","staticProps","get","even","ForStructure","_Structure","forbegin","createComment","forend","insertBefore","removeAttribute","getExpressionTokens","forFunction","iterable","instances","isArray","array","total","Math","max","clonedNode","cloneNode","forItemContext","removeChild","expressions","forExpressions","keyValueMatches","indexExpressions","IfStructure","ifbegin","ifend","ifFunction","InnerHtmlDirective","Pipe","JsonPipe","_Pipe","JSON","stringify","StyleDirective","styleFunction","style","setProperty","CoreModule","_Module","factories","declarations","concat","ORDER","Browser","_Platform","Platform","bootstrap","moduleFactory","resolveMeta","querySelector","resolvePipes","resolveFactories","sortFactories","unshift","unwrapSelectors","assign","imports","exported","importedPipes","pipeFactory","_Array$prototype$conc","importedFactories","factoryList","sort","getExpressions","matchers","c1","a2","u3","v4","a5","e6","contains","nodeName","toLowerCase","excludes","matchSelector","unmatchSelector","includes","include","exclude","isBrowser","RootComponent","time","TimePipe","options","date","getHours","getMinutes","MultPipe","_Pipe2","mult","Number","AppModule"],"mappings":"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","file":"docs/js/test.pipes.min.js","sourcesContent":[null,"export default class Directive {\n\n}\n","export default class Component {\n\n}\n","// import { BehaviorSubject, Subject } from 'rxjs';\nimport Component from './component';\n\nconst RESERVED_PROPERTIES = ['constructor', 'rxcompId', 'onInit', 'onChanges', 'onDestroy', 'pushChanges', 'changes$', 'unsubscribe$'];\n\nexport default class Context extends Component {\n\n\tconstructor(instance, descriptors = {}) {\n\t\tsuper();\n\t\tdescriptors = Context.mergeDescriptors(instance, instance, descriptors);\n\t\tdescriptors = Context.mergeDescriptors(Object.getPrototypeOf(instance), instance, descriptors);\n\t\t/*\n\t\tconst subjects = {\n\t\t\tchanges$: {\n\t\t\t\tvalue: new BehaviorSubject(this),\n\t\t\t\twritable: false,\n\t\t\t\tenumerable: false,\n\t\t\t},\n\t\t\tunsubscribe$: {\n\t\t\t\tvalue: new Subject(),\n\t\t\t\twritable: false,\n\t\t\t\tenumerable: false,\n\t\t\t}\n\t\t};\n\t\t*/\n\t\tObject.defineProperties(this, descriptors);\n\t}\n\n\tstatic mergeDescriptors(source, instance, descriptors = {}) {\n\t\tconst properties = Object.getOwnPropertyNames(source);\n\t\twhile (properties.length) {\n\t\t\tlet key = properties.shift();\n\t\t\tif (RESERVED_PROPERTIES.indexOf(key) === -1 && !descriptors.hasOwnProperty(key)) {\n\t\t\t\t// console.log('Context.mergeDescriptors', key, source[key]);\n\t\t\t\tconst descriptor = Object.getOwnPropertyDescriptor(source, key);\n\t\t\t\tif (typeof descriptor.value == \"function\") {\n\t\t\t\t\tdescriptor.value = (...args) => {\n\t\t\t\t\t\treturn instance[key].apply(instance, args);\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\tdescriptors[key] = descriptor;\n\t\t\t}\n\t\t}\n\t\treturn descriptors;\n\t}\n\n}\n","import { BehaviorSubject, Subject } from 'rxjs';\nimport { takeUntil, tap } from 'rxjs/operators';\nimport Component from '../core/component';\nimport Context from '../core/context';\n\nlet ID = 0;\nconst CONTEXTS = {};\nconst NODES = {};\n\nexport default class Module {\n\n\tcompile(node, parentInstance) {\n\t\tlet componentNode;\n\t\tconst instances = Module.querySelectorsAll(node, this.meta.selectors, []).map(match => {\n\t\t\tif (componentNode && componentNode !== match.node) {\n\t\t\t\tparentInstance = undefined;\n\t\t\t}\n\t\t\tconst instance = this.makeInstance(match.node, match.factory, match.selector, parentInstance);\n\t\t\tif (match.factory.prototype instanceof Component) {\n\t\t\t\tcomponentNode = match.node;\n\t\t\t}\n\t\t\treturn instance;\n\t\t}).filter(x => x);\n\t\t// console.log('compile', instances, node, parentInstance);\n\t\treturn instances;\n\t}\n\n\tmakeInstance(node, factory, selector, parentInstance, args) {\n\t\tif (parentInstance || node.parentNode) {\n\t\t\tconst isComponent = factory.prototype instanceof Component;\n\t\t\tconst meta = factory.meta;\n\t\t\t// collect parentInstance scope\n\t\t\tparentInstance = parentInstance || this.getParentInstance(node.parentNode);\n\t\t\tif (!parentInstance) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// creating factory instance\n\t\t\tconst instance = new factory(...(args || []));\n\t\t\t// creating instance context\n\t\t\tconst context = Module.makeContext(this, instance, parentInstance, node, factory, selector);\n\t\t\t// injecting changes$ and unsubscribe$ subjects\n\t\t\tObject.defineProperties(instance, {\n\t\t\t\tchanges$: {\n\t\t\t\t\tvalue: new BehaviorSubject(instance),\n\t\t\t\t\twritable: false,\n\t\t\t\t\tenumerable: false,\n\t\t\t\t},\n\t\t\t\tunsubscribe$: {\n\t\t\t\t\tvalue: new Subject(),\n\t\t\t\t\twritable: false,\n\t\t\t\t\tenumerable: false,\n\t\t\t\t}\n\t\t\t});\n\t\t\tlet initialized;\n\t\t\t// injecting instance pushChanges method\n\t\t\tconst module = this;\n\t\t\tinstance.pushChanges = function() {\n\t\t\t\t// console.log(new Error(`pushChanges ${instance.constructor.name}`).stack);\n\t\t\t\tthis.changes$.next(this);\n\t\t\t\t// parse component text nodes\n\t\t\t\tif (isComponent) {\n\t\t\t\t\t// console.log('Module.parse', instance.constructor.name);\n\t\t\t\t\tinitialized ? module.parse(node, instance) : setTimeout(function() { module.parse(node, instance); });\n\t\t\t\t}\n\t\t\t\t// calling onView event\n\t\t\t\tif (typeof instance.onView === 'function') {\n\t\t\t\t\t// console.log('onView', instance.constructor.name);\n\t\t\t\t\tinstance.onView();\n\t\t\t\t}\n\t\t\t};\n\t\t\t// creating component input and outputs\n\t\t\t// if (isComponent && meta) {\n\t\t\tif (meta) {\n\t\t\t\tthis.makeHosts(meta, instance, node);\n\t\t\t\tcontext.inputs = this.makeInputs(meta, instance);\n\t\t\t\tcontext.outputs = this.makeOutputs(meta, instance);\n\t\t\t}\n\t\t\t// calling onInit event\n\t\t\tif (typeof instance.onInit === 'function') {\n\t\t\t\tinstance.onInit();\n\t\t\t}\n\t\t\tinitialized = true;\n\t\t\t// subscribe to parent changes\n\t\t\tif (parentInstance.changes$) {\n\t\t\t\tparentInstance.changes$.pipe(\n\t\t\t\t\t// filter(() => node.parentNode),\n\t\t\t\t\t// debounceTime(1),\n\t\t\t\t\ttakeUntil(instance.unsubscribe$)\n\t\t\t\t).subscribe(changes => {\n\t\t\t\t\t// resolve component input outputs\n\t\t\t\t\t// if (isComponent && meta) {\n\t\t\t\t\tif (meta) {\n\t\t\t\t\t\tthis.resolveInputsOutputs(instance, changes);\n\t\t\t\t\t}\n\t\t\t\t\t// calling onChanges event with parentInstance\n\t\t\t\t\tif (typeof instance.onChanges === 'function') {\n\t\t\t\t\t\t// console.log('onChanges', instance.constructor.name);\n\t\t\t\t\t\t// console.log('onChanges', instance.constructor.meta.selector, changes);\n\t\t\t\t\t\tinstance.onChanges(changes);\n\t\t\t\t\t}\n\t\t\t\t\t// push instance changes for subscribers\n\t\t\t\t\tinstance.pushChanges();\n\t\t\t\t});\n\t\t\t}\n\t\t\t/*\n\t\t\t// parse component text nodes\n\t\t\tif (isComponent) {\n\t\t\t\tthis.parse(node, instance);\n\t\t\t}\n\t\t\t*/\n\t\t\treturn instance;\n\t\t}\n\t}\n\n\tmakeContext(instance, parentInstance, node, selector) {\n\t\tconst context = Module.makeContext(this, instance, parentInstance, node, instance.constructor, selector);\n\t\t// console.log('Module.makeContext', context, context.instance, context.node);\n\t\treturn context;\n\t}\n\n\tmakeFunction(expression, params = ['$instance']) {\n\t\tif (!expression) {\n\t\t\treturn () => { return null; };\n\t\t}\n\t\tconst args = params.join(',');\n\t\tconst pipes = this.meta.pipes;\n\t\tconst transforms = Module.getPipesSegments(expression);\n\t\tconsole.log(transforms);\n\t\texpression = transforms.shift().trim();\n\t\texpression = this.transformOptionalChaining(expression);\n\t\t// console.log(pipes, transforms, expression);\n\t\t// console.log(transforms.length, params);\n\t\t// keyword 'this' represents changes from func.apply(changes, instance)\n\t\tif (transforms.length) {\n\t\t\texpression = transforms.reduce((expression, transform, i) => {\n\t\t\t\tconst params = Module.getPipeParamsSegments(transform);\n\t\t\t\tconst name = params.shift().trim();\n\t\t\t\tconst pipe = pipes[name];\n\t\t\t\tif (!pipe || typeof pipe.transform !== 'function') {\n\t\t\t\t\tthrow (`missing pipe '${name}'`);\n\t\t\t\t}\n\t\t\t\treturn `$$pipes.${name}.transform(${expression},${params.join(',')})`;\n\t\t\t}, expression);\n\t\t\t// console.log('expression', expression);\n\t\t\tconst expression_func = new Function(`with(this) {\n\t\t\t\treturn (function (${args}, $$module) {\n\t\t\t\t\tconst $$pipes = $$module.meta.pipes;\n\t\t\t\t\treturn ${expression};\n\t\t\t\t}.bind(this)).apply(this, arguments);\n\t\t\t}`);\n\t\t\treturn expression_func;\n\t\t} else {\n\t\t\t// console.log('expression', args, expression);\n\t\t\t// console.log('${expression.replace(/\\'/g,'\"')}', this);\n\t\t\tconst expression_func = new Function(`with(this) {\n\t\t\t\treturn (function (${args}, $$module) {\n\t\t\t\t\treturn ${expression};\n\t\t\t\t}.bind(this)).apply(this, arguments);\n\t\t\t}`);\n\t\t\treturn expression_func;\n\t\t}\n\t}\n\n\tgetInstance(node) {\n\t\tif (node === document) {\n\t\t\treturn window;\n\t\t}\n\t\tconst context = getContextByNode(node);\n\t\tif (context) {\n\t\t\treturn context.instance;\n\t\t}\n\t}\n\n\tgetParentInstance(node) {\n\t\treturn Module.traverseUp(node, (node) => {\n\t\t\treturn this.getInstance(node);\n\t\t});\n\t}\n\n\tevaluate(text, instance) {\n\t\tconst parse_eval_ = (...args) => {\n\t\t\tconst expression = args[1];\n\t\t\t// console.log('expression', expression);\n\t\t\ttry {\n\t\t\t\tconst parse_func_ = this.makeFunction(expression);\n\t\t\t\treturn this.resolve(parse_func_, instance, instance);\n\t\t\t} catch (e) {\n\t\t\t\tconsole.error(e);\n\t\t\t\treturn e.message;\n\t\t\t}\n\t\t};\n\t\treturn text.replace(/\\{{2}((([^{}])|(\\{([^{}]|(\\{.*?\\}))+?\\}))*?)\\}{2}/g, parse_eval_);\n\t\t// return text.replace(/\\{{2}((([^{}])|(\\{[^{}]+?\\}))*?)\\}{2}/g, parse_eval_);\n\t}\n\n\tparse(node, instance) {\n\t\t// console.log('parse', instance.constructor.name, node);\n\t\tfor (let i = 0; i < node.childNodes.length; i++) {\n\t\t\tconst child = node.childNodes[i];\n\t\t\tif (child.nodeType === 1) {\n\t\t\t\tconst context = getContextByNode(child);\n\t\t\t\tif (!context) {\n\t\t\t\t\tthis.parse(child, instance);\n\t\t\t\t}\n\t\t\t} else if (child.nodeType === 3) {\n\t\t\t\tconst expression = child.nodeExpression || child.nodeValue;\n\t\t\t\tconst replacedText = this.evaluate(expression, instance);\n\t\t\t\tif (expression !== replacedText) {\n\t\t\t\t\tconst textNode = document.createTextNode(replacedText);\n\t\t\t\t\ttextNode.nodeExpression = expression;\n\t\t\t\t\tnode.replaceChild(textNode, child);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tresolve(expressionFunc, changes, payload) {\n\t\treturn expressionFunc.apply(changes, [payload, this]);\n\t}\n\n\tmakeHosts(meta, instance, node) {\n\t\tif (meta.hosts) {\n\t\t\tObject.keys(meta.hosts).forEach(key => {\n\t\t\t\tconst factory = meta.hosts[key];\n\t\t\t\tinstance[key] = getHost(instance, factory, node);\n\t\t\t});\n\t\t}\n\t}\n\n\tmakeInput(instance, key) {\n\t\tconst { node } = getContext(instance);\n\t\tlet input, expression = null;\n\t\tif (node.hasAttribute(key)) {\n\t\t\texpression = `'${node.getAttribute(key).replace('{{','\\'+').replace('}}','+\\'')}'`;\n\t\t} else if (node.hasAttribute(`[${key}]`)) {\n\t\t\texpression = node.getAttribute(`[${key}]`);\n\t\t}\n\t\tif (expression !== null) {\n\t\t\tinput = this.makeFunction(expression);\n\t\t}\n\t\treturn input;\n\t}\n\n\tmakeInputs(meta, instance) {\n\t\tconst inputs = {};\n\t\tif (meta.inputs) {\n\t\t\tmeta.inputs.forEach((key, i) => {\n\t\t\t\tconst input = this.makeInput(instance, key);\n\t\t\t\tif (input) {\n\t\t\t\t\tinputs[key] = input;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\treturn inputs;\n\t};\n\n\tmakeOutput(instance, key) {\n\t\tconst context = getContext(instance);\n\t\tconst node = context.node;\n\t\tconst parentInstance = context.parentInstance;\n\t\tconst expression = node.getAttribute(`(${key})`);\n\t\tconst outputFunction = this.makeFunction(expression, ['$event']);\n\t\tconst output$ = new Subject().pipe(\n\t\t\ttap((event) => {\n\t\t\t\tthis.resolve(outputFunction, parentInstance, event);\n\t\t\t})\n\t\t);\n\t\toutput$.pipe(\n\t\t\ttakeUntil(instance.unsubscribe$)\n\t\t).subscribe();\n\t\tinstance[key] = output$;\n\t\treturn outputFunction;\n\t}\n\n\tmakeOutputs(meta, instance) {\n\t\tconst outputs = {};\n\t\tif (meta.outputs) {\n\t\t\tmeta.outputs.forEach((key, i) => outputs[key] = this.makeOutput(instance, key));\n\t\t}\n\t\treturn outputs;\n\t}\n\n\tresolveInputsOutputs(instance, changes) {\n\t\tconst context = getContext(instance);\n\t\tconst parentInstance = context.parentInstance;\n\t\tconst inputs = context.inputs;\n\t\tfor (let key in inputs) {\n\t\t\tconst inputFunction = inputs[key];\n\t\t\tconst value = this.resolve(inputFunction, parentInstance, instance);\n\t\t\tinstance[key] = value;\n\t\t}\n\t\t/*\n\t\tconst outputs = context.outputs;\n\t\tfor (let key in outputs) {\n\t\t\tconst inpuoutputFunctiontFunction = outputs[key];\n\t\t\tconst value = this.resolve(outputFunction, parentInstance, null);\n\t\t\t// console.log(`setted -> ${key}`, value);\n\t\t}\n\t\t*/\n\t}\n\n\ttransformOptionalChaining(expression) {\n\t\tconst regex = /(\\w+(\\?\\.))+([\\.|\\w]+)/g;\n\t\tlet previous;\n\t\texpression = expression.replace(regex, (...args) => {\n\t\t\tconst tokens = args[0].split('?.');\n\t\t\tfor (let i = 0; i < tokens.length - 1; i++) {\n\t\t\t\tconst a = i > 0 ? `(${tokens[i]} = ${previous})` : tokens[i];\n\t\t\t\tconst b = tokens[i + 1];\n\t\t\t\tprevious = i > 0 ? `${a}.${b}` : `(${a} ? ${a}.${b} : void 0)`;\n\t\t\t\t// log(previous);\n\t\t\t}\n\t\t\treturn previous || '';\n\t\t});\n\t\treturn expression;\n\t}\n\n\tdestroy() {\n\t\tthis.remove(this.meta.node);\n\t\tthis.meta.node.innerHTML = this.meta.nodeInnerHTML;\n\t}\n\n\tremove(node, keepInstance) {\n\t\tconst keepContext = keepInstance ? getContext(keepInstance) : undefined;\n\t\tModule.traverseDown(node, (node) => {\n\t\t\tconst rxcompId = node.rxcompId;\n\t\t\tif (rxcompId) {\n\t\t\t\tconst keepContexts = Module.deleteContext(rxcompId, keepContext);\n\t\t\t\tif (keepContexts.length === 0) {\n\t\t\t\t\tdelete node.rxcompId;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\treturn node;\n\t}\n\n\tstatic makeContext(module, instance, parentInstance, node, factory, selector) {\n\t\tinstance.rxcompId = ++ID;\n\t\tconst context = { module, instance, parentInstance, node, factory, selector };\n\t\tconst rxcompNodeId = node.rxcompId = (node.rxcompId || instance.rxcompId);\n\t\tconst nodeContexts = NODES[rxcompNodeId] || (NODES[rxcompNodeId] = []);\n\t\tnodeContexts.push(context);\n\t\treturn CONTEXTS[instance.rxcompId] = context;\n\t}\n\n\tstatic deleteContext(id, keepContext) {\n\t\tconst keepContexts = [];\n\t\tconst nodeContexts = NODES[id];\n\t\tif (nodeContexts) {\n\t\t\tnodeContexts.forEach(context => {\n\t\t\t\tif (context === keepContext) {\n\t\t\t\t\tkeepContexts.push(keepContext);\n\t\t\t\t} else {\n\t\t\t\t\tconst instance = context.instance;\n\t\t\t\t\tinstance.unsubscribe$.next();\n\t\t\t\t\tinstance.unsubscribe$.complete();\n\t\t\t\t\tif (typeof instance.onDestroy === 'function') {\n\t\t\t\t\t\tinstance.onDestroy();\n\t\t\t\t\t\tdelete CONTEXTS[instance.rxcompId];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (keepContexts.length) {\n\t\t\t\tNODES[id] = keepContexts;;\n\t\t\t} else {\n\t\t\t\tdelete NODES[id];\n\t\t\t}\n\t\t}\n\t\treturn keepContexts;\n\t}\n\n\tstatic getPipesSegments(expression) {\n\t\tconst segments = [];\n\t\tlet i = 0,\n\t\t\tword = '',\n\t\t\tblock = 0;\n\t\tconst t = expression.length;\n\t\twhile (i < t) {\n\t\t\tconst c = expression.substr(i, 1);\n\t\t\tif (c === '{' || c === '(' || c === '[') {\n\t\t\t\tblock++;\n\t\t\t}\n\t\t\tif (c === '}' || c === ')' || c === ']') {\n\t\t\t\tblock--;\n\t\t\t}\n\t\t\tif (c === '|' && block === 0) {\n\t\t\t\tif (word.length) {\n\t\t\t\t\tsegments.push(word);\n\t\t\t\t}\n\t\t\t\tword = '';\n\t\t\t} else {\n\t\t\t\tword += c;\n\t\t\t}\n\t\t\ti++;\n\t\t}\n\t\tif (word.length) {\n\t\t\tsegments.push(word);\n\t\t}\n\t\treturn segments;\n\t}\n\n\tstatic getPipeParamsSegments(expression) {\n\t\tconst segments = [];\n\t\tlet i = 0,\n\t\t\tword = '',\n\t\t\tblock = 0;\n\t\tconst t = expression.length;\n\t\twhile (i < t) {\n\t\t\tconst c = expression.substr(i, 1);\n\t\t\tif (c === '{' || c === '(' || c === '[') {\n\t\t\t\tblock++;\n\t\t\t}\n\t\t\tif (c === '}' || c === ')' || c === ']') {\n\t\t\t\tblock--;\n\t\t\t}\n\t\t\tif (c === ':' && block === 0) {\n\t\t\t\tif (word.length) {\n\t\t\t\t\tsegments.push(word);\n\t\t\t\t}\n\t\t\t\tword = '';\n\t\t\t} else {\n\t\t\t\tword += c;\n\t\t\t}\n\t\t\ti++;\n\t\t}\n\t\tif (word.length) {\n\t\t\tsegments.push(word);\n\t\t}\n\t\treturn segments;\n\t}\n\n\tstatic matchSelectors(node, selectors, results) {\n\t\tfor (let i = 0; i < selectors.length; i++) {\n\t\t\tconst match = selectors[i](node);\n\t\t\tif (match) {\n\t\t\t\tconst factory = match.factory;\n\t\t\t\tif (factory.prototype instanceof Component && factory.meta.template) {\n\t\t\t\t\tnode.innerHTML = factory.meta.template;\n\t\t\t\t}\n\t\t\t\tresults.push(match);\n\t\t\t}\n\t\t}\n\t\treturn results;\n\t}\n\n\tstatic querySelectorsAll(node, selectors, results) {\n\t\tif (node.nodeType === 1) {\n\t\t\tresults = this.matchSelectors(node, selectors, results);\n\t\t\tconst childNodes = node.childNodes;\n\t\t\tfor (let i = 0; i < childNodes.length; i++) {\n\t\t\t\tresults = this.querySelectorsAll(childNodes[i], selectors, results);\n\t\t\t}\n\t\t}\n\t\treturn results;\n\t}\n\n\tstatic traverseUp(node, callback, i = 0) {\n\t\tif (!node) {\n\t\t\treturn;\n\t\t}\n\t\tconst result = callback(node, i);\n\t\tif (result) {\n\t\t\treturn result;\n\t\t}\n\t\treturn this.traverseUp(node.parentNode, callback, i + 1);\n\t}\n\n\tstatic traverseDown(node, callback, i = 0) {\n\t\tif (!node) {\n\t\t\treturn;\n\t\t}\n\t\tlet result = callback(node, i);\n\t\tif (result) {\n\t\t\treturn result;\n\t\t}\n\t\tif (node.nodeType === 1) {\n\t\t\tlet j = 0,\n\t\t\t\tt = node.childNodes.length;\n\t\t\twhile (j < t && !result) {\n\t\t\t\tresult = this.traverseDown(node.childNodes[j], callback, i + 1);\n\t\t\t\tj++;\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tstatic traversePrevious(node, callback, i = 0) {\n\t\tif (!node) {\n\t\t\treturn;\n\t\t}\n\t\tconst result = callback(node, i);\n\t\tif (result) {\n\t\t\treturn result;\n\t\t}\n\t\treturn this.traversePrevious(node.previousSibling, callback, i + 1);\n\t}\n\n\tstatic traverseNext(node, callback, i = 0) {\n\t\tif (!node) {\n\t\t\treturn;\n\t\t}\n\t\tconst result = callback(node, i);\n\t\tif (result) {\n\t\t\treturn result;\n\t\t}\n\t\treturn this.traverseNext(node.nextSibling, callback, i + 1);\n\t}\n\n}\n\nexport function getContext(instance) {\n\treturn CONTEXTS[instance.rxcompId];\n}\n\nexport function getContextByNode(node) {\n\tlet context;\n\tconst nodeContexts = NODES[node.rxcompId];\n\tif (nodeContexts) {\n\t\tcontext = nodeContexts.reduce((previous, current) => {\n\t\t\tif (current.factory.prototype instanceof Component) {\n\t\t\t\treturn current;\n\t\t\t} else if (current.factory.prototype instanceof Context) {\n\t\t\t\treturn previous ? previous : current;\n\t\t\t} else {\n\t\t\t\treturn previous;\n\t\t\t}\n\t\t}, null);\n\t\t// console.log(node.rxcompId, context);\n\t}\n\treturn context;\n}\n\nexport function getHost(instance, factory, node) {\n\tif (!node) {\n\t\tnode = getContext(instance).node;\n\t}\n\tif (node.rxcompId) {\n\t\tconst nodeContexts = NODES[node.rxcompId];\n\t\tif (nodeContexts) {\n\t\t\t// console.log(nodeContexts);\n\t\t\tfor (let i = 0; i < nodeContexts.length; i++) {\n\t\t\t\tconst context = nodeContexts[i];\n\t\t\t\tif (context.instance !== instance) {\n\t\t\t\t\t// console.log(context.instance, instance);\n\t\t\t\t\tif (context.instance instanceof factory) {\n\t\t\t\t\t\treturn context.instance;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tif (node.parentNode) {\n\t\treturn getHost(instance, factory, node.parentNode);\n\t}\n}\n","import Directive from '../core/directive';\nimport { getContext } from '../module/module';\n\nexport default class ClassDirective extends Directive {\n\n\tonInit() {\n\t\tconst { module, node } = getContext(this);\n\t\tconst expression = node.getAttribute('[class]');\n\t\tthis.classFunction = module.makeFunction(expression);\n\t\t// console.log('ClassDirective.onInit', this.classList, expression);\n\t}\n\n\tonChanges(changes) {\n\t\tconst { module, node } = getContext(this);\n\t\tconst classList = module.resolve(this.classFunction, changes, this);\n\t\tfor (let key in classList) {\n\t\t\tclassList[key] ? node.classList.add(key) : node.classList.remove(key);\n\t\t}\n\t\t// console.log('ClassDirective.onChanges', classList);\n\t}\n\n}\n\nClassDirective.meta = {\n\tselector: `[[class]]`,\n};\n","import { fromEvent } from 'rxjs';\nimport { shareReplay, takeUntil } from 'rxjs/operators';\nimport Directive from '../core/directive';\nimport { getContext } from '../module/module';\n\nconst EVENTS = ['click', 'mousedown', 'mouseup', 'touchstart', 'touchmove', 'touchend', 'keydown', 'keyup', 'input', 'change', 'loaded'];\n\nexport default class EventDirective extends Directive {\n\n\tonInit() {\n\t\tconst { module, node, parentInstance, selector } = getContext(this);\n\t\tconst event = this.event = selector.replace(/\\[|\\]|\\(|\\)/g, '');\n\t\tconst event$ = this.event$ = fromEvent(node, event).pipe(shareReplay(1));\n\t\tconst expression = node.getAttribute(`(${event})`);\n\t\tif (expression) {\n\t\t\tconst outputFunction = module.makeFunction(expression, ['$event']);\n\t\t\tevent$.pipe(\n\t\t\t\ttakeUntil(this.unsubscribe$)\n\t\t\t).subscribe(event => {\n\t\t\t\t// console.log(parentInstance);\n\t\t\t\tmodule.resolve(outputFunction, parentInstance, event);\n\t\t\t});\n\t\t} else {\n\t\t\tparentInstance[`${event}$`] = event$;\n\t\t}\n\t\t// console.log('EventDirective.onInit', 'selector', selector, 'event', event);\n\t}\n\n}\n\nEventDirective.meta = {\n\tselector: `[(${EVENTS.join(')],[(')})]`,\n};\n","export default class Structure {\n\n}\n","import Context from '../core/context';\n\nexport default class ForItem extends Context {\n\n\t// !!! try with payload options { key, $key, value, $value, index, count } or use onInit()\n\n\tconstructor(key, $key, value, $value, index, count, parentInstance) {\n\t\t// console.log('ForItem', arguments);\n\t\tsuper(parentInstance);\n\t\t/*\n\t\tsuper(parentInstance, {\n\t\t\t[key]: {\n\t\t\t\tget: function() {\n\t\t\t\t\treturn this.$key;\n\t\t\t\t},\n\t\t\t\tset: function(key) {\n\t\t\t\t\tthis.$key = key;\n\t\t\t\t}\n\t\t\t},\n\t\t\t[value]: {\n\t\t\t\tget: function() {\n\t\t\t\t\treturn this.$value;\n\t\t\t\t},\n\t\t\t\tset: function(value) {\n\t\t\t\t\tthis.$value = value;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\t*/\n\t\tthis[key] = $key;\n\t\tthis[value] = $value;\n\t\tthis.index = index;\n\t\tthis.count = count;\n\t}\n\n\tget first() { return this.index === 0; }\n\n\tget last() { return this.index === this.count - 1; }\n\n\tget even() { return this.index % 2 === 0; }\n\n\tget odd() { return !this.even; }\n\n}\n","import Structure from '../core/structure';\nimport { getContext } from '../module/module';\nimport ForItem from './for.item';\n\nexport default class ForStructure extends Structure {\n\n\tonInit() {\n\t\tconst { module, node } = getContext(this);\n\t\tconst forbegin = this.forbegin = document.createComment(`*for begin`);\n\t\tforbegin.rxcompId = node.rxcompId;\n\t\tnode.parentNode.replaceChild(forbegin, node);\n\t\tconst forend = this.forend = document.createComment(`*for end`);\n\t\tforbegin.parentNode.insertBefore(forend, forbegin.nextSibling);\n\t\tconst expression = node.getAttribute('*for');\n\t\t// this.expression = expression;\n\t\tnode.removeAttribute('*for');\n\t\tconst tokens = this.tokens = this.getExpressionTokens(expression);\n\t\tthis.forFunction = module.makeFunction(tokens.iterable);\n\t\tthis.instances = [];\n\t}\n\n\tonChanges(changes) {\n\t\tconst context = getContext(this);\n\t\tconst module = context.module;\n\t\tconst node = context.node;\n\t\t// resolve\n\t\tconst tokens = this.tokens;\n\t\tlet result = module.resolve(this.forFunction, changes, this) || [];\n\t\tconst isArray = Array.isArray(result);\n\t\tconst array = isArray ? result : Object.keys(result);\n\t\tconst total = array.length;\n\t\tconst previous = this.instances.length;\n\t\t// let nextSibling = this.forbegin.nextSibling;\n\t\tfor (let i = 0; i < Math.max(previous, total); i++) {\n\t\t\tif (i < total) {\n\t\t\t\tconst key = isArray ? i : array[i];\n\t\t\t\tconst value = isArray ? array[key] : result[key];\n\t\t\t\tif (i < previous) {\n\t\t\t\t\t// update\n\t\t\t\t\tconst instance = this.instances[i];\n\t\t\t\t\tinstance[tokens.key] = key;\n\t\t\t\t\tinstance[tokens.value] = value;\n\t\t\t\t\t/*\n\t\t\t\t\tif (!nextSibling) {\n\t\t\t\t\t\tconst context = getContext(instance);\n\t\t\t\t\t\tconst node = context.node;\n\t\t\t\t\t\tthis.forend.parentNode.insertBefore(node, this.forend);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnextSibling = nextSibling.nextSibling;\n\t\t\t\t\t}\n\t\t\t\t\t*/\n\t\t\t\t} else {\n\t\t\t\t\t// create\n\t\t\t\t\tconst clonedNode = node.cloneNode(true);\n\t\t\t\t\tdelete clonedNode.rxcompId;\n\t\t\t\t\tthis.forend.parentNode.insertBefore(clonedNode, this.forend);\n\t\t\t\t\tconst args = [tokens.key, key, tokens.value, value, i, total, context.parentInstance]; // !!! context.parentInstance unused?\n\t\t\t\t\tconst instance = module.makeInstance(clonedNode, ForItem, context.selector, context.parentInstance, args);\n\t\t\t\t\tconst forItemContext = getContext(instance);\n\t\t\t\t\t// console.log('ForStructure', clonedNode, forItemContext.instance.constructor.name);\n\t\t\t\t\tmodule.compile(clonedNode, forItemContext.instance);\n\t\t\t\t\t// nextSibling = clonedNode.nextSibling;\n\t\t\t\t\tthis.instances.push(instance);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// remove\n\t\t\t\tconst instance = this.instances[i];\n\t\t\t\tconst { node } = getContext(instance);\n\t\t\t\tnode.parentNode.removeChild(node);\n\t\t\t\tmodule.remove(node);\n\t\t\t}\n\t\t}\n\t\tthis.instances.length = array.length;\n\t\t// console.log('ForStructure', this.instances, tokens);\n\t}\n\n\tgetExpressionTokens(expression) {\n\t\tif (expression === null) {\n\t\t\tthrow ('invalid for');\n\t\t}\n\t\tif (expression.trim().indexOf('let ') === -1 || expression.trim().indexOf(' of ') === -1) {\n\t\t\tthrow ('invalid for');\n\t\t}\n\t\tconst expressions = expression.split(';').map(x => x.trim()).filter(x => x !== '');\n\t\tconst forExpressions = expressions[0].split(' of ').map(x => x.trim());\n\t\tlet value = forExpressions[0].replace(/\\s*let\\s*/, '');\n\t\tconst iterable = forExpressions[1];\n\t\tlet key = 'index';\n\t\tconst keyValueMatches = value.match(/\\[(.+)\\s*,\\s*(.+)\\]/);\n\t\tif (keyValueMatches) {\n\t\t\tkey = keyValueMatches[1];\n\t\t\tvalue = keyValueMatches[2];\n\t\t}\n\t\tif (expressions.length > 1) {\n\t\t\tconst indexExpressions = expressions[1].split(/\\s*let\\s*|\\s*=\\s*index/).map(x => x.trim());\n\t\t\tif (indexExpressions.length === 3) {\n\t\t\t\tkey = indexExpressions[1];\n\t\t\t}\n\t\t}\n\t\treturn { key, value, iterable };\n\t}\n\n}\n\nForStructure.meta = {\n\tselector: '[*for]',\n};\n","import Structure from '../core/structure';\nimport { getContext } from '../module/module';\n\nexport default class IfStructure extends Structure {\n\n\tonInit() {\n\t\tconst { module, node } = getContext(this);\n\t\tconst ifbegin = this.ifbegin = document.createComment(`*if begin`);\n\t\tifbegin.rxcompId = node.rxcompId;\n\t\tnode.parentNode.replaceChild(ifbegin, node);\n\t\tconst ifend = this.ifend = document.createComment(`*if end`);\n\t\tifbegin.parentNode.insertBefore(ifend, ifbegin.nextSibling);\n\t\tconst expression = node.getAttribute('*if');\n\t\tthis.ifFunction = module.makeFunction(expression);\n\t\tconst clonedNode = node.cloneNode(true);\n\t\tclonedNode.removeAttribute('*if');\n\t\tthis.clonedNode = clonedNode;\n\t\tthis.node = clonedNode.cloneNode(true);\n\t\t// console.log('IfStructure.expression', expression);\n\t}\n\n\tonChanges(changes) {\n\t\tconst { module } = getContext(this);\n\t\t// console.log('IfStructure.onChanges', changes);\n\t\tconst value = module.resolve(this.ifFunction, changes, this);\n\t\tconst node = this.node;\n\t\tif (value) {\n\t\t\tif (!node.parentNode) {\n\t\t\t\tthis.ifend.parentNode.insertBefore(node, this.ifend);\n\t\t\t\tmodule.compile(node);\n\t\t\t}\n\t\t} else {\n\t\t\tif (node.parentNode) {\n\t\t\t\tmodule.remove(node, this);\n\t\t\t\tnode.parentNode.removeChild(node);\n\t\t\t\tthis.node = this.clonedNode.cloneNode(true);\n\t\t\t}\n\t\t}\n\t}\n\n}\n\nIfStructure.meta = {\n\tselector: '[*if]',\n};\n","import Directive from '../core/directive';\nimport { getContext } from '../module/module';\n\nexport default class InnerHtmlDirective extends Directive {\n\n\tonChanges(changes) {\n\t\tconst { node } = getContext(this);\n\t\tnode.innerHTML = this.innerHTML;\n\t}\n\n}\n\nInnerHtmlDirective.meta = {\n\tselector: `[innerHTML]`,\n\tinputs: ['innerHTML'],\n};\n","export default class Pipe {\n\n\tstatic transform(value) {\n\t\treturn value;\n\t}\n\n}\n","import Pipe from \"../core/pipe\";\n\nexport default class JsonPipe extends Pipe {\n\n\tstatic transform(value) {\n\t\treturn JSON.stringify(value, null, '\\t');\n\t}\n\n}\n\nJsonPipe.meta = {\n\tname: 'json',\n};\n","import Directive from '../core/directive';\nimport { getContext } from '../module/module';\n\nexport default class StyleDirective extends Directive {\n\n\tonInit() {\n\t\tconst { module, node } = getContext(this);\n\t\tconst expression = node.getAttribute('[style]');\n\t\tthis.styleFunction = module.makeFunction(expression);\n\t\t// console.log('StyleDirective.onInit', expression);\n\t}\n\n\tonChanges(changes) {\n\t\tconst { module, node } = getContext(this);\n\t\tconst style = module.resolve(this.styleFunction, changes, this);\n\t\tfor (let key in style) {\n\t\t\tnode.style.setProperty(key, style[key]);\n\t\t}\n\t\t// console.log('StyleDirective.onChanges', changes, style);\n\t}\n\n}\n\nStyleDirective.meta = {\n\tselector: `[[style]]`\n};\n","import ClassDirective from './class/class.directive';\nimport EventDirective from './event/event.directive';\nimport ForStructure from './for/for.structure';\nimport IfStructure from './if/if.structure';\nimport InnerHtmlDirective from './inner-html/inner-html.directive';\nimport JsonPipe from './json/json.pipe';\nimport Module from './module/module';\nimport StyleDirective from './style/style.directive';\n\nexport default class CoreModule extends Module {}\nconst factories = [\n\tClassDirective,\n\tEventDirective,\n\tForStructure,\n\tIfStructure,\n\tInnerHtmlDirective,\n\tStyleDirective,\n];\nconst pipes = [\n\tJsonPipe,\n];\nCoreModule.meta = {\n\tdeclarations: [\n\t\t...factories,\n\t\t...pipes,\n\t],\n\texports: [\n\t\t...factories,\n\t\t...pipes,\n\t]\n};\n","import Component from '../core/component';\nimport Directive from '../core/directive';\nimport Pipe from '../core/pipe';\nimport Structure from '../core/structure';\n\nconst ORDER = [Structure, Component, Directive];\n\nexport default class Platform {\n\n\tstatic bootstrap(moduleFactory) {\n\t\tconst meta = this.resolveMeta(moduleFactory);\n\t\tconst bootstrap = meta.bootstrap;\n\t\tif (!bootstrap) {\n\t\t\tthrow ('missing bootstrap');\n\t\t}\n\t\tconst node = meta.node = this.querySelector(bootstrap.meta.selector);\n\t\tif (!node) {\n\t\t\tthrow (`missing node ${bootstrap.meta.selector}`);\n\t\t}\n\t\tmeta.nodeInnerHTML = node.innerHTML;\n\t\tconst pipes = meta.pipes = this.resolvePipes(meta);\n\t\tconst factories = meta.factories = this.resolveFactories(meta);\n\t\tthis.sortFactories(factories);\n\t\tfactories.unshift(bootstrap);\n\t\tconst selectors = meta.selectors = this.unwrapSelectors(factories);\n\t\tconst module = new moduleFactory();\n\t\tmodule.meta = meta;\n\t\tconst instances = module.compile(node, window);\n\t\tconst root = instances[0];\n\t\t// if (root instanceof module.meta.bootstrap) {\n\t\troot.pushChanges();\n\t\t// }\n\t\treturn module;\n\t}\n\n\tstatic querySelector(selector) {\n\t\treturn document.querySelector(selector);\n\t}\n\n\tstatic resolveMeta(moduleFactory) {\n\t\tconst meta = Object.assign({ imports: [], declarations: [], pipes: [], exports: [] }, moduleFactory.meta);\n\t\tmeta.imports = meta.imports.map(moduleFactory => this.resolveMeta(moduleFactory));\n\t\treturn meta;\n\t}\n\n\tstatic resolvePipes(meta, exported) {\n\t\tconst importedPipes = meta.imports.map(meta => this.resolvePipes(meta, true));\n\t\tconst pipes = {};\n\t\tconst pipeList = (exported ? meta.exports : meta.declarations).filter(x => x.prototype instanceof Pipe);\n\t\tpipeList.forEach(pipeFactory => pipes[pipeFactory.meta.name] = pipeFactory);\n\t\treturn Object.assign({}, ...importedPipes, pipes);\n\t}\n\n\tstatic resolveFactories(meta, exported) {\n\t\tconst importedFactories = meta.imports.map(meta => this.resolveFactories(meta, true));\n\t\tconst factoryList = (exported ? meta.exports : meta.declarations).filter(x => (x.prototype instanceof Structure || x.prototype instanceof Component || x.prototype instanceof Directive));\n\t\treturn Array.prototype.concat.call(factoryList, ...importedFactories);\n\t}\n\n\tstatic sortFactories(factories) {\n\t\tfactories.sort((a, b) => {\n\t\t\tconst ai = ORDER.reduce((p, c, i) => a.prototype instanceof c ? i : p, -1);\n\t\t\tconst bi = ORDER.reduce((p, c, i) => b.prototype instanceof c ? i : p, -1);\n\t\t\t// return ai - bi;\n\t\t\tconst o = ai - bi;\n\t\t\tif (o === 0) {\n\t\t\t\treturn (a.meta.hosts ? 1 : 0) - (b.meta.hosts ? 1 : 0);\n\t\t\t}\n\t\t\treturn o;\n\t\t});\n\t}\n\n\tstatic getExpressions(selector) {\n\t\tlet matchers = [];\n\t\tselector.replace(/\\.([\\w\\-\\_]+)|\\[(.+?\\]*)(\\=)(.*?)\\]|\\[(.+?\\]*)\\]|([\\w\\-\\_]+)/g, function(value, c1, a2, u3, v4, a5, e6) {\n\t\t\tif (c1) {\n\t\t\t\tmatchers.push(function(node) {\n\t\t\t\t\treturn node.classList.contains(c1);\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (a2) {\n\t\t\t\tmatchers.push(function(node) {\n\t\t\t\t\treturn (node.hasAttribute(a2) && node.getAttribute(a2) === v4) ||\n\t\t\t\t\t\t(node.hasAttribute(`[${a2}]`) && node.getAttribute(`[${a2}]`) === v4);\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (a5) {\n\t\t\t\tmatchers.push(function(node) {\n\t\t\t\t\treturn node.hasAttribute(a5) || node.hasAttribute(`[${a5}]`);\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (e6) {\n\t\t\t\tmatchers.push(function(node) {\n\t\t\t\t\treturn node.nodeName.toLowerCase() === e6.toLowerCase();\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\treturn matchers;\n\t}\n\n\tstatic unwrapSelectors(factories) {\n\t\tconst selectors = [];\n\t\tfactories.forEach(factory => {\n\t\t\tfactory.meta.selector.split(',').forEach(selector => {\n\t\t\t\tselector = selector.trim();\n\t\t\t\tlet excludes = [];\n\t\t\t\tconst matchSelector = selector.replace(/\\:not\\((.+?)\\)/g, (value, unmatchSelector) => {\n\t\t\t\t\texcludes = this.getExpressions(unmatchSelector);\n\t\t\t\t\treturn '';\n\t\t\t\t});\n\t\t\t\tconst includes = this.getExpressions(matchSelector);\n\t\t\t\tselectors.push((node) => {\n\t\t\t\t\tconst include = includes.reduce((result, e) => {\n\t\t\t\t\t\treturn result && e(node);\n\t\t\t\t\t}, true);\n\t\t\t\t\tconst exclude = excludes.reduce((result, e) => {\n\t\t\t\t\t\treturn result || e(node);\n\t\t\t\t\t}, false);\n\t\t\t\t\tif (include && !exclude) {\n\t\t\t\t\t\treturn { node, factory, selector };\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t\treturn selectors;\n\t}\n\n\tstatic isBrowser() {\n\t\treturn window;\n\t}\n\n\t// static isServer() {}\n\n}\n","import Platform from './platform';\n\nexport default class Browser extends Platform {}\n","import { Browser, Component, CoreModule, Module, Pipe } from '../../src/rxcomp';\n\nclass RootComponent extends Component {\n\tonInit() {\n\t\tthis.time = new Date();\n\t\tthis.value = 2;\n\t}\n}\nRootComponent.meta = {\n\tselector: '[root-component]',\n};\n\nclass TimePipe extends Pipe {\n\tstatic transform(value, options = 1) {\n\t\tconst date = new Date(value);\n\t\treturn `${date.getHours()}:${date.getMinutes()}`;\n\t}\n}\nTimePipe.meta = {\n\tname: 'time',\n};\n\nclass MultPipe extends Pipe {\n\tstatic transform(value, mult = 2) {\n\t\treturn Number(value) * Number(mult);\n\t}\n}\nMultPipe.meta = {\n\tname: 'mult',\n};\n\nclass AppModule extends Module {}\nAppModule.meta = {\n\timports: [\n\t\tCoreModule\n\t],\n\tdeclarations: [\n\t\tTimePipe,\n\t\tMultPipe\n\t],\n\tbootstrap: RootComponent,\n};\n\nBrowser.bootstrap(AppModule);\n"]}