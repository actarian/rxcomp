/**
 * @license rxcomp v1.0.0-alpha.5
 * (c) 2019 Luca Zampetti <lzampetti@gmail.com>
 * License: MIT
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("rxjs"),require("rxjs/operators")):"function"==typeof define&&define.amd?define("main",["rxjs","rxjs/operators"],e):e((t=t||self).rxjs,t.rxjs.operators)}(this,(function(t,e){"use strict";function n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function r(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function i(t,e,n){return(i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var i=new(Function.bind.apply(t,r));return n&&o(i,n.prototype),i}).apply(null,arguments)}var s=function(){},a=function(){},u=["constructor","rxcompId","onInit","onChanges","onDestroy","pushChanges","changes$","unsubscribe$"],c=function(t){function e(n,r){var o;return void 0===r&&(r={}),o=t.call(this)||this,r=e.mergeDescriptors(n,n,r),r=e.mergeDescriptors(Object.getPrototypeOf(n),n,r),Object.defineProperties(function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(o),r),o}return r(e,t),e.mergeDescriptors=function(t,e,n){void 0===n&&(n={});for(var r=Object.getOwnPropertyNames(t),o=function(){var o=r.shift();if(-1===u.indexOf(o)&&!n.hasOwnProperty(o)){var i=Object.getOwnPropertyDescriptor(t,o);"function"==typeof i.value&&(i.value=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];e[o].apply(e,n)}),n[o]=i}};r.length;)o();return n},e}(a),f=function(){},p=0,l={},h={},d=[f,a,s],v=[],m=function(){function n(t){if(!t)throw"missing options";if(!t.bootstrap)throw"missing bootstrap";this.options=t;var e={};t.pipes&&t.pipes.forEach((function(t){return e[t.meta.name]=t})),this.pipes=e;var r=t.bootstrap,o=this.node=document.querySelector(r.meta.selector);if(this.nodeInnerHTML=o.innerHTML,!o)throw"missing node "+r.meta.selector;t.factories.sort((function(t,e){return d.reduce((function(e,n,r){return t.prototype instanceof n?r:e}),-1)-d.reduce((function(t,n,r){return e.prototype instanceof n?r:t}),-1)})),t.factories.unshift(r),this.selectors=n.unwrapSelectors(t.factories),this.compile(o,window)[0].pushChanges()}var r=n.prototype;return r.makeContext=function(t,e,r,o){return n.makeContext(this,t,e,r,t.constructor,o)},r.makeInstance=function(r,o,s,u,c){var f=this;if(u||r.parentNode){var p=o.prototype instanceof a,l=o.meta;if(!(u=u||this.getParentInstance(r)))return;var h,d=i(o,c||[]);Object.defineProperties(d,{changes$:{value:new t.BehaviorSubject(d),writable:!1,enumerable:!1},unsubscribe$:{value:new t.Subject,writable:!1,enumerable:!1}});var v=this;d.pushChanges=function(){this.changes$.next(this),p&&(h?v.parse(r,d):setTimeout((function(){v.parse(r,d)}))),"function"==typeof d.onView&&d.onView()};var m=n.makeContext(this,d,u,r,o,s);return p&&l&&(m.inputs=this.makeInputs(l,d),m.outputs=this.makeOutputs(l,d)),"function"==typeof d.onInit&&d.onInit(),h=!0,u.changes$&&u.changes$.pipe(e.takeUntil(d.unsubscribe$)).subscribe((function(t){p&&l&&f.resolveInputsOutputs(d,t),"function"==typeof d.onChanges&&d.onChanges(t),d.pushChanges()})),d}},r.makeFunction=function(t,e){if(void 0===e&&(e=["$instance"]),!t)return function(){return null};var r=e.join(","),o=this.pipes,i=n.getPipesSegments(t);return t=i.shift().trim(),t=this.transformOptionalChaining(t),i.length?(t=i.reduce((function(t,e,r){var i=n.getPipeParamsSegments(e),s=i.shift().trim(),a=o[s];if(!a||"function"!=typeof a.transform)throw"missing pipe "+s;return"$$pipes."+s+".transform("+t+","+i.join(",")+")"}),t),new Function("with(this) {\n\t\t\t\treturn (function ("+r+", $$module) {\n\t\t\t\t\tconst $$pipes = $$module.pipes;\n\t\t\t\t\treturn "+t+";\n\t\t\t\t}.bind(this)).apply(this, arguments);\n\t\t\t}")):new Function("with(this) {\n\t\t\t\treturn (function ("+r+", $$module) {\n\t\t\t\t\treturn "+t+";\n\t\t\t\t}.bind(this)).apply(this, arguments);\n\t\t\t}")},r.makeInput=function(t,e){var r=n.getContext(t).node.getAttribute("["+e+"]");return this.makeFunction(r)},r.makeOutput=function(r,o){var i=this,s=n.getContext(r),a=s.node,u=s.parentInstance,c=a.getAttribute("("+o+")"),f=this.makeFunction(c,["$event"]),p=(new t.Subject).pipe(e.tap((function(t){i.resolve(f,u,t)})));return p.pipe(e.takeUntil(r.unsubscribe$)).subscribe(),r[o]=p,f},r.remove=function(t){for(n.traverseDown(t,(function(t){for(var e in l){var n=l[e];if(n.node===t){var r=n.instance;r.unsubscribe$.next(),r.unsubscribe$.complete(),"function"==typeof r.onDestroy&&r.onDestroy(),delete t.dataset.rxcompId,v.push(e)}}}));v.length;)n.deleteContext(v.shift());return t},r.destroy=function(){this.remove(this.node),this.node.innerHTML=this.nodeInnerHTML},r.evaluate=function(t,e){var n=this;return t.replace(/\{{2}((([^{}])|(\{([^{}]|(\{.*?\}))+?\}))*?)\}{2}/g,(function(){var t=arguments.length<=1?void 0:arguments[1];try{var r=n.makeFunction(t);return n.resolve(r,e,e)}catch(t){return console.error(t),t.message}}))},r.parse=function(t,e){for(var r=0;r<t.childNodes.length;r++){var o=t.childNodes[r];if(1===o.nodeType)n.getContextByNode(o)||this.parse(o,e);else if(3===o.nodeType){var i=o.nodeExpression||o.nodeValue,s=this.evaluate(i,e);if(i!==s){o.nodeExpression=o.nodeExpression||i;var a=document.createTextNode(s);t.replaceChild(a,o)}}}},r.resolve=function(t,e,n){return t.apply(e,[n,this])},r.makeInputs=function(t,e){var n=this,r={};return t.inputs&&t.inputs.forEach((function(t,o){return r[t]=n.makeInput(e,t)})),r},r.makeOutputs=function(t,e){var n=this,r={};return t.outputs&&t.outputs.forEach((function(t,o){return r[t]=n.makeOutput(e,t)})),r},r.resolveInputsOutputs=function(t,e){var r=n.getContext(t),o=r.parentInstance,i=r.inputs;for(var s in i){var a=i[s],u=this.resolve(a,o,t);t[s]=u}},r.getInstance=function(t){if(t===document)return window;var e=n.getContextByNode(t);return e?e.instance:void 0},r.getParentInstance=function(t){var e=this;return n.traverseUp(t,(function(t){return e.getInstance(t)}))},r.transformOptionalChaining=function(t){var e;return t=t.replace(/(\w+(\?\.))+([\.|\w]+)/g,(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var o=n[0].split("?."),i=0;i<o.length-1;i++){var s=i>0?"("+o[i]+" = "+e+")":o[i],a=o[i+1];e=i>0?s+"."+a:"("+s+" ? "+s+"."+a+" : void 0)"}return e||""}))},r.compile=function(t,e){var r=this;return n.querySelectorsAll(t,this.selectors,[]).map((function(t){var n=r.makeInstance(t.node,t.factory,t.selector,e);return t.factory.prototype instanceof a&&(e=void 0),n})).filter((function(t){return t}))},n.use=function(t){return new n(t)},n.getPipesSegments=function(t){for(var e=[],n=0,r="",o=0,i=t.length;n<i;){var s=t.substr(n,1);"{"!==s&&"("!==s&&"["!==s||o++,"}"!==s&&")"!==s&&"]"!==s||o--,"|"===s&&0===o?(r.length&&e.push(r),r=""):r+=s,n++}return r.length&&e.push(r),e},n.getPipeParamsSegments=function(t){for(var e=[],n=0,r="",o=0,i=t.length;n<i;){var s=t.substr(n,1);"{"!==s&&"("!==s&&"["!==s||o++,"}"!==s&&")"!==s&&"]"!==s||o--,":"===s&&0===o?(r.length&&e.push(r),r=""):r+=s,n++}return r.length&&e.push(r),e},n.unwrapSelectors=function(t){var e=[];return t.forEach((function(t){t.meta.selector.split(",").forEach((function(n){if(0===(n=n.trim()).indexOf(".")){var r=n.replace(/\./g,"");e.push((function(e){return!!e.classList.has(r)&&{node:e,factory:t,selector:n}}))}else if(n.match(/\[(.+)\]/)){var o=n.substr(1,n.length-2);e.push((function(e){return!!e.hasAttribute(o)&&{node:e,factory:t,selector:n}}))}else e.push((function(e){return!!(e.nodeName.toLowerCase()===n.toLowerCase())&&{node:e,factory:t,selector:n}}))}))})),e},n.matchSelectors=function(t,e,n){for(var r=0;r<e.length;r++){var o=e[r](t);if(o){var i=o.factory;i.prototype instanceof a&&i.meta.template&&(t.innerHTML=i.meta.template),n.push(o)}}return n},n.querySelectorsAll=function(t,e,n){1===t.nodeType&&(n=this.matchSelectors(t,e,n));var r=t.childNodes;if(r)for(var o=0;o<r.length;o++)n=this.querySelectorsAll(r[o],e,n);return n},n.traverseUp=function(t,e,n){if(void 0===n&&(n=0),t){var r=e(t,n);return r||this.traverseUp(t.parentNode,e,n+1)}},n.traverseDown=function(t,e,n){if(void 0===n&&(n=0),t){var r=e(t,n);if(r)return r;if(1===t.nodeType)for(var o=0,i=t.childNodes.length;o<i&&!r;)r=this.traverseDown(t.childNodes[o],e,n+1),o++;return r}},n.traversePrevious=function(t,e,n){if(void 0===n&&(n=0),t){var r=e(t,n);return r||this.traversePrevious(t.previousSibling,e,n+1)}},n.traverseNext=function(t,e,n){if(void 0===n&&(n=0),t){var r=e(t,n);return r||this.traverseNext(t.nextSibling,e,n+1)}},n.getContext=function(t){return l[t.rxcompId]},n.makeContext=function(t,e,n,r,o,i){e.rxcompId=++p;var s={module:t,instance:e,parentInstance:n,node:r,factory:o,selector:i},a=r.dataset.rxcompId=r.dataset.rxcompId||++p;return(h[a]||(h[a]=[])).push(s),l[e.rxcompId]=s},n.deleteContext=function(t){var e=l[t],n=h[e.node.dataset.rxcompId];if(n){var r=n.indexOf(e);-1!==r&&n.splice(r,1)}delete l[t]},n.getContextByNode=function(t){var e,n=h[t.dataset.rxcompId];return n&&(e=n.reduce((function(e,n){return n.node===t&&n.factory.prototype instanceof a?e&&n.factory.prototype instanceof c?e:n:e}),null)),e},n}(),g=function(t){function e(){return t.apply(this,arguments)||this}r(e,t);var n=e.prototype;return n.onInit=function(){var t=m.getContext(this),e=t.module,n=t.node.getAttribute("[class]");this.classFunction=e.makeFunction(n)},n.onChanges=function(t){var e=m.getContext(this),n=e.module,r=e.node,o=n.resolve(this.classFunction,t,this);for(var i in o)o[i]?r.classList.add(i):r.classList.remove(i)},e}(s);g.meta={selector:"[[class]]"};var y=function(n){function o(){return n.apply(this,arguments)||this}return r(o,n),o.prototype.onInit=function(){var n=m.getContext(this),r=n.module,o=n.node,i=n.selector,s=n.parentInstance,a=this.event=i.replace(/\[|\]|\(|\)/g,""),u=this.event$=t.fromEvent(o,a).pipe(e.shareReplay(1)),c=o.getAttribute("("+a+")");if(c){var f=r.makeFunction(c,["$event"]);u.pipe(e.takeUntil(this.unsubscribe$)).subscribe((function(t){r.resolve(f,s,t)}))}else s[a+"$"]=u},o}(s);y.meta={selector:"[("+["click","mousedown","mouseup","touchstart","touchmove","touchend","keydown","keyup","input","change","loaded"].join(")],[(")+")]"};var b=function(t){function e(e,n,r,o,i,s,a){var u;return(u=t.call(this,a)||this)[e]=n,u[r]=o,u.index=i,u.count=s,u}var o,i,s;return r(e,t),o=e,(i=[{key:"first",get:function(){return 0===this.index}},{key:"last",get:function(){return this.index===this.count-1}},{key:"even",get:function(){return this.index%2==0}},{key:"odd",get:function(){return!this.even}}])&&n(o.prototype,i),s&&n(o,s),e}(c),x=function(t){function e(){return t.apply(this,arguments)||this}r(e,t);var n=e.prototype;return n.onInit=function(){var t=m.getContext(this),e=t.module,n=t.node,r=this.forbegin=document.createComment("*for begin");n.parentNode.replaceChild(r,n);var o=this.forend=document.createComment("*for end");r.parentNode.insertBefore(o,r.nextSibling);var i=n.getAttribute("*for");n.removeAttribute("*for");var s=this.tokens=this.getExpressionTokens(i);this.forFunction=e.makeFunction(s.iterable),this.instances=[]},n.onChanges=function(t){for(var e=m.getContext(this),n=e.module,r=e.node,o=this.tokens,i=n.resolve(this.forFunction,t,this)||[],s=Array.isArray(i),a=s?i:Object.keys(i),u=a.length,c=this.instances.length,f=0;f<Math.max(c,u);f++)if(f<u){var p=s?f:a[f],l=s?a[p]:i[p];if(f<c){var h=this.instances[f];h[o.key]=p,h[o.value]=l}else{var d=r.cloneNode(!0);delete d.dataset.rxcompId,this.forend.parentNode.insertBefore(d,this.forend);var v=[o.key,p,o.value,l,f,u,e.parentInstance],g=n.makeInstance(d,b,e.selector,e.parentInstance,v),y=m.getContext(g);n.compile(d,y.instance),this.instances.push(g)}}else{var x=this.instances[f],w=m.getContext(x).node;w.parentNode.removeChild(w),n.remove(w)}this.instances.length=a.length},n.getExpressionTokens=function(t){if(null===t)throw"invalid for";if(-1===t.trim().indexOf("let ")||-1===t.trim().indexOf(" of "))throw"invalid for";var e=t.split(";").map((function(t){return t.trim()})).filter((function(t){return""!==t})),n=e[0].split(" of ").map((function(t){return t.trim()})),r=n[0].replace(/\s*let\s*/,""),o=n[1],i="index",s=r.match(/\[(.+)\s*,\s*(.+)\]/);if(s&&(i=s[1],r=s[2]),e.length>1){var a=e[1].split(/\s*let\s*|\s*=\s*index/).map((function(t){return t.trim()}));3===a.length&&(i=a[1])}return{key:i,value:r,iterable:o}},e}(f);x.meta={selector:"[*for]"};var w=function(t){function e(){return t.apply(this,arguments)||this}r(e,t);var n=e.prototype;return n.onInit=function(){var t=m.getContext(this),e=t.module,n=t.node,r=this.ifbegin=document.createComment("*if begin");n.parentNode.replaceChild(r,n);var o=this.ifend=document.createComment("*if end");r.parentNode.insertBefore(o,r.nextSibling);var i=n.getAttribute("*if");this.expression=i,this.ifFunction=e.makeFunction(i);var s=n.cloneNode(!0);s.removeAttribute("*if"),this.clonedNode=s},n.onChanges=function(t){var e=m.getContext(this).module;e.resolve(this.ifFunction,t,this)?this.clonedNode.parentNode||(this.ifend.parentNode.insertBefore(this.clonedNode,this.ifend),e.compile(this.clonedNode)):this.clonedNode.parentNode&&(this.clonedNode.parentNode.removeChild(this.clonedNode),e.remove(this.clonedNode))},e}(f);w.meta={selector:"[*if]"};var C=function(t){function e(){return t.apply(this,arguments)||this}r(e,t);var n=e.prototype;return n.onInit=function(){var t=m.getContext(this),e=t.node,n=t.selector.replace(/\[(.+)\]/,(function(){return arguments.length<=1?void 0:arguments[1]})),r=e.getAttribute(n);if(!r)throw"invalid "+n;"[innerHTML]"===n&&(r="{{"+r+"}}"),this.innerHtmlExpression=r},n.onChanges=function(t){var e=m.getContext(this),n=e.module.evaluate(this.innerHtmlExpression,t);e.node.innerHTML=n},e}(s);C.meta={selector:"[[innerHTML]],[innerHTML]"};var I=function(){function t(){}return t.transform=function(t){return JSON.stringify(t)},t}();I.meta={name:"json"};var k=function(t){function e(){return t.apply(this,arguments)||this}r(e,t);var n=e.prototype;return n.onInit=function(){var t=m.getContext(this),e=t.module,n=t.node.getAttribute("[style]");this.styleFunction=e.makeFunction(n)},n.onChanges=function(t){var e=m.getContext(this),n=e.module,r=e.node,o=n.resolve(this.styleFunction,t,this);for(var i in o)r.style.setProperty(i,o[i])},e}(s);k.meta={selector:"[[style]]"};var S=function(){function t(){}return t.delete=function(t){this.isLocalStorageSupported()&&window.localStorage.removeItem(t)},t.exist=function(t){if(this.isLocalStorageSupported())return void 0!==window.localStorage[t]},t.get=function(t){var e=null;if(this.isLocalStorageSupported()&&void 0!==window.localStorage[t])try{e=JSON.parse(window.localStorage[t])}catch(e){console.log("LocalStorageService.get.error parsing",t,e)}return e},t.set=function(t,e){if(this.isLocalStorageSupported())try{var n=[],r=JSON.stringify(e,(function(t,e){if("object"==typeof e&&null!==e){if(-1!==n.indexOf(e))return;n.push(e)}return e}));window.localStorage.setItem(t,r)}catch(n){console.log("LocalStorageService.set.error serializing",t,e,n)}},t.isLocalStorageSupported=function(){if(this.supported)return!0;var t=!1;try{(t="localStorage"in window&&null!==window.localStorage)?(window.localStorage.setItem("test","1"),window.localStorage.removeItem("test")):t=!1}catch(e){t=!1}return this.supported=t,t},t}(),$=function(){function n(){}return n.set=function(t){return S.set("items",t),this.get$().next(t)},n.get$=function(){if(this.store$)return this.store$;var n=S.get("items");return n||(n=[{id:5,name:"Cookies",date:new Date(Date.now())},{id:4,name:"Pizza",date:new Date(2019,4,4,12)},{id:3,name:"Pasta",date:new Date(2019,3,22,12)},{id:2,name:"Bread",date:new Date(2019,0,6,12)},{id:1,name:"Ham",date:new Date(2018,11,30,12)}],S.set("items",n)),this.store$=new t.BehaviorSubject(n),this.store$.pipe(e.delay(1))},n.add$=function(n){var r=Object.assign({id:Date.now(),date:new Date(Date.now())},n),o=this.store$.getValue();return o.unshift(r),this.set(o),t.of(r).pipe(e.delay(1))},n.patch$=function(n){var r=this.store$.getValue(),o=r.find((function(t){return t.id===n.id}));return o&&(Object.assign(o,n),this.set(r)),t.of(o).pipe(e.delay(1))},n.delete$=function(n){var r=this.store$.getValue(),o=r.indexOf(n);return-1!==o&&(r.splice(o,1),this.set(r)),t.of(n).pipe(e.delay(1))},n}(),N=function(t){function n(){return t.apply(this,arguments)||this}r(n,t);var o=n.prototype;return o.onInit=function(){var t=this,n=m.getContext(this);this.input=n.node.querySelector(".control--text"),this.items=[],this.store$=$.get$(),this.store$.pipe(e.takeUntil(this.unsubscribe$)).subscribe((function(e){t.items=e,t.pushChanges()}))},o.onView=function(){m.getContext(this)},o.onInput=function(t){this.pushChanges()},o.onAddItem=function(t){var e=this;this.input.value&&$.add$({name:this.input.value}).subscribe((function(t){e.input.value=null}))},o.onToggleItem=function(t){$.patch$({id:t.id,done:!t.done}).subscribe((function(t){}))},o.onRemoveItem=function(t){$.delete$(t).subscribe((function(t){}))},n}(a);N.meta={selector:"[app-component]"};var O=function(){function t(){}return t.transform=function(t,e,n){return void 0===e&&(e="it-IT-u-ca-gregory"),void 0===n&&(n={dateStyle:"short",timeStyle:"short"}),new Date(t).toLocaleDateString(e,n)},t}();O.meta={name:"date"};var j=[{hex:"#ffffff",background:"#ffffff",foreground:"#003adc",accent:"#212121"},{hex:"#212121",background:"#212121",foreground:"#ffffff",accent:"#003adc"},{hex:"#ffffff",background:"#ffffff",foreground:"#212121",accent:"#003adc"},{hex:"#003adc",background:"#003adc",foreground:"#ffffff",accent:"#212121"}];function D(t,e){var n=parseInt(t.slice(1,3),16),r=parseInt(t.slice(3,5),16),o=parseInt(t.slice(5,7),16);return e?"rgba("+n+","+r+","+o+","+e+")":"rgb("+n+","+r+","+o+")"}var L=function(t){function e(){return t.apply(this,arguments)||this}r(e,t);var n=e.prototype;return n.onChanges=function(t){var e,n;this.background=(e=this.item.id,D(j[e%j.length].background,n)),this.foreground=function(t,e){return D(j[t%j.length].foreground,e)}(this.item.id),this.accent=function(t,e){return D(j[t%j.length].accent,e)}(this.item.id)},n.onToggle=function(t){this.toggle.next(t)},n.onRemove=function(t){this.remove.next(t)},e}(a);L.meta={selector:"[todo-item-component]",inputs:["item"],outputs:["toggle","remove"]},m.use({factories:[g,y,x,w,C,k,L],pipes:[O,I],bootstrap:N})}));
//# sourceMappingURL=main.min.js.map