{"version":3,"sources":["dist/rxcomp.js","../src/core/directive.js","../src/core/component.js","../src/core/context.js","../src/core/structure.js","../src/module/module.js","../src/class/class.directive.js","../src/event/event.directive.js","../src/for/for.item.js","../src/for/for.structure.js","../src/if/if.structure.js","../src/inner-html/inner-html.directive.js","../src/json/json.pipe.js","../src/style/style.directive.js"],"names":["global","factory","exports","module","require","define","amd","self","rxcomp","rxjs","operators","this","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","_inheritsLoose","subClass","superClass","prototype","create","constructor","__proto__","_setPrototypeOf","o","p","setPrototypeOf","_construct","Parent","args","Class","Reflect","construct","sham","Proxy","Date","toString","call","e","isNativeReflectConstruct","a","push","apply","instance","Function","bind","arguments","Directive","Component","RESERVED_PROPERTIES","Context","_Component","descriptors","_this","mergeDescriptors","getPrototypeOf","defineProperties","ReferenceError","_assertThisInitialized","source","getOwnPropertyNames","forEach","indexOf","hasOwnProperty","getOwnPropertyDescriptor","value","_len","Array","_key","Structure","ID","CONTEXTS","NODES","ORDER","Module","options","bootstrap","pipes","x","meta","name","node","document","querySelector","selector","factories","sort","b","reduce","c","unshift","selectors","unwrapSelectors","nodes$","Subject","unsubscribe$","_proto","makeContext","parentInstance","makeInstance","parentNode","isComponent","getParentInstance","changes$","BehaviorSubject","pushChanges","next","parse","onView","context","inputs","makeInputs","outputs","makeOutputs","onInit","pipe","takeUntil","subscribe","changes","resolveInputsOutputs","onChanges","makeFunction","expression","params","join","transforms","getPipesSegments","shift","trim","transformOptionalChaining","transform","getPipeParamsSegments","makeInput","getContext","getAttribute","makeOutput","_this2","outputFunction","output$","tap","event","resolve","remove","ids","traverseDown","_i","_Object$entries","entries","_Object$entries$_i","id","complete","onDestroy","deleteContext","destroy","evaluate","text","_this3","replace","undefined","parse_func_","console","error","message","childNodes","child","nodeType","getContextByNode","nodeExpression","nodeValue","replacedText","textNode","createTextNode","replaceChild","expressionFunc","payload","_this4","_this5","_this6","keys","inputFunction","getInstance","window","_this7","traverseUp","previous","tokens","split","compile","_this8","querySelectorsAll","map","match","filter","use","segments","word","block","t","substr","className","classList","has","attribute","hasAttribute","nodeName","toLowerCase","matchSelectors","results","template","innerHTML","callback","result","j","traversePrevious","previousSibling","traverseNext","nextSibling","rxcompId","rxcompNodeId","dataset","nodeContexts","index","splice","current","ClassDirective","_Directive","classFunction","add","EventDirective","event$","fromEvent","shareReplay","ForItem","_Context","$key","$value","count","Constructor","protoProps","staticProps","get","even","ForStructure","_Structure","forbegin","createComment","forend","insertBefore","removeAttribute","getExpressionTokens","forFunction","iterable","instances","isArray","array","total","Math","max","clonedNode","cloneNode","forItemContext","removeChild","expressions","forExpressions","keyValueMatches","indexExpressions","IfStructure","ifbegin","ifend","ifFunction","InnerHtmlDirective","innerHtmlExpression","JsonPipe","JSON","stringify","StyleDirective","styleFunction","style"],"mappings":"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","file":"dist/rxcomp.min.js","sourcesContent":[null,"export default class Directive {\n\n}\n","export default class Component {\n\n}\n","// import { BehaviorSubject, Subject } from 'rxjs';\nimport Component from './component';\n\nconst RESERVED_PROPERTIES = ['constructor', 'rxcompId', 'onInit', 'onChanges', 'onDestroy', 'pushChanges', 'changes$', 'unsubscribe$'];\n\nexport default class Context extends Component {\n\n\tconstructor(instance, descriptors = {}) {\n\t\tsuper();\n\t\tdescriptors = Context.mergeDescriptors(instance, instance, descriptors);\n\t\tdescriptors = Context.mergeDescriptors(Object.getPrototypeOf(instance), instance, descriptors);\n\t\t/*\n\t\tconst subjects = {\n\t\t\tchanges$: {\n\t\t\t\tvalue: new BehaviorSubject(this),\n\t\t\t\twritable: false,\n\t\t\t\tenumerable: false,\n\t\t\t},\n\t\t\tunsubscribe$: {\n\t\t\t\tvalue: new Subject(),\n\t\t\t\twritable: false,\n\t\t\t\tenumerable: false,\n\t\t\t}\n\t\t};\n\t\t*/\n\t\tObject.defineProperties(this, descriptors);\n\t}\n\n\tstatic mergeDescriptors(source, instance, descriptors = {}) {\n\t\tconst properties = Object.getOwnPropertyNames(source);\n\t\tproperties.forEach(key => {\n\t\t\tif (RESERVED_PROPERTIES.indexOf(key) === -1 && !descriptors.hasOwnProperty(key)) {\n\t\t\t\t// console.log('Context.mergeDescriptors', key, source[key]);\n\t\t\t\tconst descriptor = Object.getOwnPropertyDescriptor(source, key);\n\t\t\t\tif (typeof descriptor.value == \"function\") {\n\t\t\t\t\tdescriptor.value = (...args) => {\n\t\t\t\t\t\tinstance[key].apply(instance, args);\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\tdescriptors[key] = descriptor;\n\t\t\t}\n\t\t});\n\t\treturn descriptors;\n\t}\n\n}\n","export default class Structure {\n\n}\n","import { BehaviorSubject, Subject } from 'rxjs';\nimport { takeUntil, tap } from 'rxjs/operators';\nimport Component from '../core/component';\nimport Context from '../core/context';\nimport Directive from '../core/directive';\nimport Structure from '../core/structure';\n\nlet ID = 0;\nconst CONTEXTS = {};\nconst NODES = {};\nconst ORDER = [Structure, Component, Directive];\n\nexport default class Module {\n\n\tconstructor(options) {\n\t\tif (!options) {\n\t\t\tthrow ('missing options');\n\t\t}\n\t\tif (!options.bootstrap) {\n\t\t\tthrow ('missing bootstrap');\n\t\t}\n\t\tthis.options = options;\n\t\tconst pipes = {};\n\t\tif (options.pipes) {\n\t\t\toptions.pipes.forEach(x => pipes[x.meta.name] = x);\n\t\t}\n\t\tthis.pipes = pipes;\n\t\tconst bootstrap = options.bootstrap;\n\t\tthis.node = document.querySelector(bootstrap.meta.selector);\n\t\tif (!this.node) {\n\t\t\tthrow (`missing node ${bootstrap.meta.selector}`);\n\t\t}\n\t\toptions.factories.sort((a, b) => {\n\t\t\tconst ai = ORDER.reduce((p, c, i) => a.prototype instanceof c ? i : p, -1);\n\t\t\tconst bi = ORDER.reduce((p, c, i) => b.prototype instanceof c ? i : p, -1);\n\t\t\treturn ai - bi;\n\t\t});\n\t\toptions.factories.unshift(bootstrap);\n\t\tthis.selectors = Module.unwrapSelectors(options.factories);\n\t\tthis.nodes$ = new Subject();\n\t\tthis.unsubscribe$ = new Subject();\n\t\t// this.root = this.makeInstance(this.node, bootstrap, bootstrap.meta.selector, window);\n\t}\n\n\tmakeContext(instance, parentInstance, node, selector) {\n\t\tconst context = Module.makeContext(this, instance, parentInstance, node, instance.constructor, selector);\n\t\t// console.log('Module.makeContext', context, context.instance, context.node);\n\t\treturn context;\n\t}\n\n\tmakeInstance(node, factory, selector, parentInstance, args) {\n\t\tif (parentInstance || node.parentNode) {\n\t\t\tconst isComponent = factory.prototype instanceof Component;\n\t\t\tconst meta = factory.meta;\n\t\t\t// collect parentInstance scope\n\t\t\tparentInstance = parentInstance || this.getParentInstance(node.parentNode);\n\t\t\tif (!parentInstance) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// creating factory instance\n\t\t\tconst instance = new factory(...(args || []));\n\t\t\t// injecting changes$ and unsubscribe$ subjects\n\t\t\tObject.defineProperties(instance, {\n\t\t\t\tchanges$: {\n\t\t\t\t\tvalue: new BehaviorSubject(instance),\n\t\t\t\t\twritable: false,\n\t\t\t\t\tenumerable: false,\n\t\t\t\t},\n\t\t\t\tunsubscribe$: {\n\t\t\t\t\tvalue: new Subject(),\n\t\t\t\t\twritable: false,\n\t\t\t\t\tenumerable: false,\n\t\t\t\t}\n\t\t\t});\n\t\t\t// injecting instance pushChanges method\n\t\t\tconst module = this;\n\t\t\tinstance.pushChanges = function() {\n\t\t\t\t/*\n\t\t\t\tif (isComponent) {\n\t\t\t\t\tmodule.parse(node, instance);\n\t\t\t\t}\n\t\t\t\t*/\n\t\t\t\t/*\n\t\t\t\tconsole.log(new Error(`pushChanges ${instance.constructor.name}`).stack);\n\t\t\t\t*/\n\t\t\t\tthis.changes$.next(this);\n\t\t\t\t// parse component text nodes\n\t\t\t\tif (isComponent) {\n\t\t\t\t\t// console.log('Module.parse', instance.constructor.name);\n\t\t\t\t\tmodule.parse(node, instance);\n\t\t\t\t}\n\t\t\t\t// calling onView event\n\t\t\t\tif (typeof instance.onView === 'function') {\n\t\t\t\t\t// console.log('onView', instance.constructor.name);\n\t\t\t\t\tinstance.onView();\n\t\t\t\t}\n\t\t\t};\n\t\t\t// creating instance context\n\t\t\tconst context = Module.makeContext(this, instance, parentInstance, node, factory, selector);\n\t\t\t// creating component input and outputs\n\t\t\tif (isComponent && meta) {\n\t\t\t\tcontext.inputs = this.makeInputs(meta, instance);\n\t\t\t\tcontext.outputs = this.makeOutputs(meta, instance);\n\t\t\t}\n\t\t\t// calling onInit event\n\t\t\tif (typeof instance.onInit === 'function') {\n\t\t\t\tinstance.onInit();\n\t\t\t}\n\t\t\t// subscribe to parent changes\n\t\t\tif (parentInstance.changes$) {\n\t\t\t\tparentInstance.changes$.pipe(\n\t\t\t\t\t// filter(() => node.parentNode),\n\t\t\t\t\ttakeUntil(instance.unsubscribe$)\n\t\t\t\t).subscribe(changes => {\n\t\t\t\t\t// resolve component input outputs\n\t\t\t\t\tif (isComponent && meta) {\n\t\t\t\t\t\tthis.resolveInputsOutputs(instance, changes);\n\t\t\t\t\t}\n\t\t\t\t\t// calling onChanges event with parentInstance\n\t\t\t\t\tif (typeof instance.onChanges === 'function') {\n\t\t\t\t\t\t// console.log('onChanges', instance.constructor.name);\n\t\t\t\t\t\t// console.log('onChanges', instance.constructor.meta.selector, changes);\n\t\t\t\t\t\tinstance.onChanges(changes);\n\t\t\t\t\t}\n\t\t\t\t\t// push instance changes for subscribers\n\t\t\t\t\tinstance.pushChanges();\n\t\t\t\t});\n\t\t\t}\n\t\t\t/*\n\t\t\t// parse component text nodes\n\t\t\tif (isComponent) {\n\t\t\t\tthis.parse(node, instance);\n\t\t\t}\n\t\t\t*/\n\t\t\treturn instance;\n\t\t}\n\t}\n\n\tmakeFunction(expression, params = ['$instance']) {\n\t\tif (!expression) {\n\t\t\treturn () => { return null; };\n\t\t}\n\t\tconst args = params.join(',');\n\t\tconst pipes = this.pipes;\n\t\tconst transforms = Module.getPipesSegments(expression);\n\t\texpression = transforms.shift().trim();\n\t\texpression = this.transformOptionalChaining(expression);\n\t\t// console.log(pipes, transforms, expression);\n\t\t// console.log(transforms.length, params);\n\t\t// keyword 'this' represents changes from func.apply(changes, instance)\n\t\tif (transforms.length) {\n\t\t\texpression = transforms.reduce((expression, transform, i) => {\n\t\t\t\tconst params = Module.getPipeParamsSegments(transform);\n\t\t\t\tconst name = params.shift().trim();\n\t\t\t\tconst pipe = pipes[name];\n\t\t\t\tif (!pipe || typeof pipe.transform !== 'function') {\n\t\t\t\t\tthrow (`missing pipe ${name}`);\n\t\t\t\t}\n\t\t\t\treturn `$$pipes.${name}.transform(${expression},${params.join(',')})`;\n\t\t\t}, expression);\n\t\t\t// console.log('expression', expression);\n\t\t\tconst expression_func = new Function(`with(this) {\n\t\t\t\treturn (function (${args}, $$module) {\n\t\t\t\t\tconst $$pipes = $$module.pipes;\n\t\t\t\t\treturn ${expression};\n\t\t\t\t}.bind(this)).apply(this, arguments);\n\t\t\t}`);\n\t\t\treturn expression_func;\n\t\t} else {\n\t\t\t// console.log('expression', args, expression);\n\t\t\t// console.log('${expression.replace(/\\'/g,'\"')}', this);\n\t\t\tconst expression_func = new Function(`with(this) {\n\t\t\t\treturn (function (${args}, $$module) {\n\t\t\t\t\treturn ${expression};\n\t\t\t\t}.bind(this)).apply(this, arguments);\n\t\t\t}`);\n\t\t\treturn expression_func;\n\t\t}\n\t}\n\n\tmakeInput(instance, name) {\n\t\tconst context = Module.getContext(instance);\n\t\tconst node = context.node;\n\t\tconst expression = node.getAttribute(`[${name}]`);\n\t\treturn this.makeFunction(expression);\n\t}\n\n\tmakeOutput(instance, name) {\n\t\tconst context = Module.getContext(instance);\n\t\tconst node = context.node;\n\t\tconst parentInstance = context.parentInstance;\n\t\tconst expression = node.getAttribute(`(${name})`);\n\t\tconst outputFunction = this.makeFunction(expression, ['$event']);\n\t\tconst output$ = new Subject().pipe(\n\t\t\ttap((event) => {\n\t\t\t\tthis.resolve(outputFunction, parentInstance, event);\n\t\t\t})\n\t\t);\n\t\toutput$.pipe(\n\t\t\ttakeUntil(instance.unsubscribe$)\n\t\t).subscribe();\n\t\tinstance[name] = output$;\n\t\treturn outputFunction;\n\t}\n\n\tremove(node) {\n\t\tconst ids = [];\n\t\tModule.traverseDown(node, (node) => {\n\t\t\tfor (let [id, context] of Object.entries(CONTEXTS)) {\n\t\t\t\tif (context.node === node) {\n\t\t\t\t\tconst instance = context.instance;\n\t\t\t\t\tinstance.unsubscribe$.next();\n\t\t\t\t\tinstance.unsubscribe$.complete();\n\t\t\t\t\tif (typeof instance.onDestroy === 'function') {\n\t\t\t\t\t\tinstance.onDestroy();\n\t\t\t\t\t}\n\t\t\t\t\tids.push(id);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tids.forEach(id => Module.deleteContext(id));\n\t\t// console.log('Module.remove', ids);\n\t\treturn node;\n\t}\n\n\tdestroy() {\n\t\tthis.remove(this.node);\n\t\tthis.unsubscribe$.next();\n\t\tthis.unsubscribe$.complete();\n\t}\n\n\tevaluate(text, instance) {\n\t\tconst parse_eval_ = (...args) => {\n\t\t\tconst expression = args[1];\n\t\t\t// console.log('expression', expression);\n\t\t\ttry {\n\t\t\t\tconst parse_func_ = this.makeFunction(expression);\n\t\t\t\treturn this.resolve(parse_func_, instance, instance);\n\t\t\t} catch (e) {\n\t\t\t\tconsole.error(e);\n\t\t\t\treturn e.message;\n\t\t\t}\n\t\t};\n\t\treturn text.replace(/\\{{2}((([^{}])|(\\{([^{}]|(\\{.*?\\}))+?\\}))*?)\\}{2}/g, parse_eval_);\n\t\t// return text.replace(/\\{{2}((([^{}])|(\\{[^{}]+?\\}))*?)\\}{2}/g, parse_eval_);\n\t}\n\n\tparse(node, instance) {\n\t\t// console.log('parse', instance.constructor.name, node);\n\t\tfor (let i = 0; i < node.childNodes.length; i++) {\n\t\t\tconst child = node.childNodes[i];\n\t\t\tif (child.nodeType === 1) {\n\t\t\t\tconst context = Module.getContextByNode(child);\n\t\t\t\tif (!context) {\n\t\t\t\t\tthis.parse(child, instance);\n\t\t\t\t}\n\t\t\t} else if (child.nodeType === 3) {\n\t\t\t\tconst expression = child.nodeExpression || child.nodeValue;\n\t\t\t\tconst replacedText = this.evaluate(expression, instance);\n\t\t\t\t// console.log(instance.constructor.name, expression, replacedText);\n\t\t\t\tif (expression !== replacedText) {\n\t\t\t\t\tchild.nodeExpression = child.nodeExpression || expression;\n\t\t\t\t\tconst textNode = document.createTextNode(replacedText);\n\t\t\t\t\tnode.replaceChild(textNode, child);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tresolve(expressionFunc, changes, payload) {\n\t\treturn expressionFunc.apply(changes, [payload, this]);\n\t}\n\n\tmakeInputs(meta, instance) {\n\t\tconst inputs = {};\n\t\tif (meta.inputs) {\n\t\t\tmeta.inputs.forEach((key, i) => inputs[key] = this.makeInput(instance, key));\n\t\t}\n\t\treturn inputs;\n\t}\n\n\tmakeOutputs(meta, instance) {\n\t\tconst outputs = {};\n\t\tif (meta.outputs) {\n\t\t\tmeta.outputs.forEach((key, i) => outputs[key] = this.makeOutput(instance, key));\n\t\t}\n\t\treturn outputs;\n\t}\n\n\tresolveInputsOutputs(instance, changes) {\n\t\tconst context = Module.getContext(instance);\n\t\tconst parentInstance = context.parentInstance;\n\t\tconst inputs = context.inputs;\n\t\tObject.keys(inputs).forEach(key => {\n\t\t\tconst inputFunction = inputs[key];\n\t\t\tconst value = this.resolve(inputFunction, parentInstance, instance);\n\t\t\tinstance[key] = value;\n\t\t});\n\t\t/*\n\t\tconst outputs = context.outputs;\n\t\tObject.keys(outputs).forEach(key => {\n\t\t\tconst inpuoutputFunctiontFunction = outputs[key];\n\t\t\tconst value = this.resolve(outputFunction, parentInstance, null);\n\t\t\t// console.log(`setted -> ${key}`, value);\n\t\t});\n\t\t*/\n\t}\n\n\tgetInstance(node) {\n\t\tif (node === document) {\n\t\t\treturn window;\n\t\t}\n\t\tconst context = Module.getContextByNode(node);\n\t\tif (context) {\n\t\t\treturn context.instance;\n\t\t}\n\t}\n\n\tgetParentInstance(node) {\n\t\treturn Module.traverseUp(node, (node) => {\n\t\t\treturn this.getInstance(node);\n\t\t});\n\t}\n\n\ttransformOptionalChaining(expression) {\n\t\tconst regex = /(\\w+(\\?\\.))+([\\.|\\w]+)/g;\n\t\tlet previous;\n\t\texpression = expression.replace(regex, (...args) => {\n\t\t\tconst tokens = args[0].split('?.');\n\t\t\tfor (let i = 0; i < tokens.length - 1; i++) {\n\t\t\t\tconst a = i > 0 ? `(${tokens[i]} = ${previous})` : tokens[i];\n\t\t\t\tconst b = tokens[i + 1];\n\t\t\t\tprevious = i > 0 ? `${a}.${b}` : `(${a} ? ${a}.${b} : void 0)`;\n\t\t\t\t// log(previous);\n\t\t\t}\n\t\t\treturn previous || '';\n\t\t});\n\t\treturn expression;\n\t}\n\n\tcompile(node, parentInstance) {\n\t\tconst instances = Module.querySelectorsAll(node, this.selectors, []).map(match => {\n\t\t\tconst instance = this.makeInstance(match.node, match.factory, match.selector, parentInstance);\n\t\t\tif (match.factory.prototype instanceof Component) {\n\t\t\t\tparentInstance = undefined;\n\t\t\t}\n\t\t\treturn instance;\n\t\t}).filter(x => x);\n\t\t// console.log('compile', instances, node, parentInstance);\n\t\treturn instances;\n\t}\n\n\tstatic use(options) {\n\t\tconst module = new Module(options);\n\t\tconst instances = module.compile(module.node, window);\n\t\tconst instance = instances[0];\n\t\t// if (instance instanceof module.options.bootstrap) {\n\t\tinstance.pushChanges();\n\t\t// }\n\t\treturn module;\n\t}\n\n\tstatic getPipesSegments(expression) {\n\t\tconst segments = [];\n\t\tlet i = 0,\n\t\t\tword = '',\n\t\t\tblock = 0;\n\t\tconst t = expression.length;\n\t\twhile (i < t) {\n\t\t\tconst c = expression.substr(i, 1);\n\t\t\tif (c === '{' || c === '(' || c === '[') {\n\t\t\t\tblock++;\n\t\t\t}\n\t\t\tif (c === '}' || c === ')' || c === ']') {\n\t\t\t\tblock--;\n\t\t\t}\n\t\t\tif (c === '|' && block === 0) {\n\t\t\t\tif (word.length) {\n\t\t\t\t\tsegments.push(word);\n\t\t\t\t}\n\t\t\t\tword = '';\n\t\t\t} else {\n\t\t\t\tword += c;\n\t\t\t}\n\t\t\ti++;\n\t\t}\n\t\tif (word.length) {\n\t\t\tsegments.push(word);\n\t\t}\n\t\treturn segments;\n\t}\n\n\tstatic getPipeParamsSegments(expression) {\n\t\tconst segments = [];\n\t\tlet i = 0,\n\t\t\tword = '',\n\t\t\tblock = 0;\n\t\tconst t = expression.length;\n\t\twhile (i < t) {\n\t\t\tconst c = expression.substr(i, 1);\n\t\t\tif (c === '{' || c === '(' || c === '[') {\n\t\t\t\tblock++;\n\t\t\t}\n\t\t\tif (c === '}' || c === ')' || c === ']') {\n\t\t\t\tblock--;\n\t\t\t}\n\t\t\tif (c === ':' && block === 0) {\n\t\t\t\tif (word.length) {\n\t\t\t\t\tsegments.push(word);\n\t\t\t\t}\n\t\t\t\tword = '';\n\t\t\t} else {\n\t\t\t\tword += c;\n\t\t\t}\n\t\t\ti++;\n\t\t}\n\t\tif (word.length) {\n\t\t\tsegments.push(word);\n\t\t}\n\t\treturn segments;\n\t}\n\n\tstatic unwrapSelectors(factories) {\n\t\tconst selectors = [];\n\t\tfactories.forEach(factory => {\n\t\t\tfactory.meta.selector.split(',').forEach(selector => {\n\t\t\t\tselector = selector.trim();\n\t\t\t\tif (selector.indexOf('.') === 0) {\n\t\t\t\t\tconst className = selector.replace(/\\./g, '');\n\t\t\t\t\tselectors.push((node) => {\n\t\t\t\t\t\tconst match = node.classList.has(className);\n\t\t\t\t\t\treturn match ? { node, factory, selector } : false;\n\t\t\t\t\t});\n\t\t\t\t} else if (selector.match(/\\[(.+)\\]/)) {\n\t\t\t\t\tconst attribute = selector.substr(1, selector.length - 2);\n\t\t\t\t\tselectors.push((node) => {\n\t\t\t\t\t\tconst match = node.hasAttribute(attribute);\n\t\t\t\t\t\treturn match ? { node, factory, selector } : false;\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tselectors.push((node) => {\n\t\t\t\t\t\tconst match = node.nodeName.toLowerCase() === selector.toLowerCase();\n\t\t\t\t\t\treturn match ? { node, factory, selector } : false;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t\treturn selectors;\n\t}\n\n\tstatic matchSelectors(node, selectors, results) {\n\t\tselectors.forEach(selector => {\n\t\t\tconst match = selector(node);\n\t\t\tif (match) {\n\t\t\t\tconst factory = match.factory;\n\t\t\t\tif (factory.prototype instanceof Component && factory.meta.template) {\n\t\t\t\t\tnode.innerHTML = factory.meta.template;\n\t\t\t\t}\n\t\t\t\tresults.push(match);\n\t\t\t}\n\t\t});\n\t\treturn results;\n\t}\n\n\tstatic querySelectorsAll(node, selectors, results) {\n\t\tif (node.nodeType === 1) {\n\t\t\tresults = this.matchSelectors(node, selectors, results);\n\t\t}\n\t\tconst childNodes = node.childNodes;\n\t\tif (childNodes) {\n\t\t\tfor (let i = 0; i < childNodes.length; i++) {\n\t\t\t\tresults = this.querySelectorsAll(childNodes[i], selectors, results);\n\t\t\t}\n\t\t}\n\t\treturn results;\n\t}\n\n\tstatic traverseUp(node, callback, i = 0) {\n\t\tif (!node) {\n\t\t\treturn;\n\t\t}\n\t\tconst result = callback(node, i);\n\t\tif (result) {\n\t\t\treturn result;\n\t\t}\n\t\treturn this.traverseUp(node.parentNode, callback, i + 1);\n\t}\n\n\tstatic traverseDown(node, callback, i = 0) {\n\t\tif (!node) {\n\t\t\treturn;\n\t\t}\n\t\tlet result = callback(node, i);\n\t\tif (result) {\n\t\t\treturn result;\n\t\t}\n\t\tif (node.nodeType === 1) {\n\t\t\tlet j = 0,\n\t\t\t\tt = node.childNodes.length;\n\t\t\twhile (j < t && !result) {\n\t\t\t\tresult = this.traverseDown(node.childNodes[j], callback, i + 1);\n\t\t\t\tj++;\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tstatic traversePrevious(node, callback, i = 0) {\n\t\tif (!node) {\n\t\t\treturn;\n\t\t}\n\t\tconst result = callback(node, i);\n\t\tif (result) {\n\t\t\treturn result;\n\t\t}\n\t\treturn this.traversePrevious(node.previousSibling, callback, i + 1);\n\t}\n\n\tstatic traverseNext(node, callback, i = 0) {\n\t\tif (!node) {\n\t\t\treturn;\n\t\t}\n\t\tconst result = callback(node, i);\n\t\tif (result) {\n\t\t\treturn result;\n\t\t}\n\t\treturn this.traverseNext(node.nextSibling, callback, i + 1);\n\t}\n\n\tstatic getContext(instance) {\n\t\treturn CONTEXTS[instance.rxcompId];\n\t}\n\n\tstatic makeContext(module, instance, parentInstance, node, factory, selector) {\n\t\tinstance.rxcompId = ++ID;\n\t\tconst context = { module, instance, parentInstance, node, factory, selector };\n\t\tconst rxcompNodeId = node.dataset.rxcompId = (node.dataset.rxcompId || ++ID);\n\t\tconst nodeContexts = NODES[rxcompNodeId] || (NODES[rxcompNodeId] = []);\n\t\tnodeContexts.push(context);\n\t\treturn CONTEXTS[instance.rxcompId] = context;\n\t}\n\n\tstatic deleteContext(id) {\n\t\tconst context = CONTEXTS[id];\n\t\tconst nodeContexts = NODES[context.node.dataset.id];\n\t\tif (nodeContexts) {\n\t\t\tconst index = nodeContexts.indexOf(context);\n\t\t\tif (index !== -1) {\n\t\t\t\tnodeContexts.splice(index, 1);\n\t\t\t}\n\t\t}\n\t\tdelete CONTEXTS[id];\n\t}\n\n\tstatic getContextByNode(node) {\n\t\tlet context;\n\t\tconst nodeContexts = NODES[node.dataset.rxcompId];\n\t\tif (nodeContexts) {\n\t\t\tcontext = nodeContexts.reduce((previous, current) => {\n\t\t\t\tif (current.node === node && current.factory.prototype instanceof Component) {\n\t\t\t\t\tif (previous && current.factory.prototype instanceof Context) {\n\t\t\t\t\t\treturn previous;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn current;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\treturn previous;\n\t\t\t\t}\n\t\t\t}, null);\n\t\t}\n\t\treturn context;\n\t\t/*\n\t\tconst context = Object.keys(CONTEXTS).reduce((previous, id) => {\n\t\t\tconst current = CONTEXTS[id];\n\t\t\tif (current.node === node && current.factory.prototype instanceof Component) {\n\t\t\t\tif (previous && current.factory.prototype instanceof Context) {\n\t\t\t\t\treturn previous;\n\t\t\t\t} else {\n\t\t\t\t\treturn current;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn previous;\n\t\t\t}\n\t\t}, null);\n\t\t\treturn context;\n\t\t*/\n\t\t/*\n\t\tlet id = Object.keys(CONTEXTS).find(id => CONTEXTS[id].node === node && CONTEXTS[id].factory.prototype instanceof Component);\n\t\tif (id) {\n\t\t\tconst context = CONTEXTS[id];\n\t\t\treturn context;\n\t\t}\n\t\t*/\n\t}\n\n}\n","import Directive from '../core/directive';\nimport Module from '../module/module';\n\nexport default class ClassDirective extends Directive {\n\n\tonInit() {\n\t\tconst context = Module.getContext(this);\n\t\tconst module = context.module;\n\t\tconst node = context.node;\n\t\tconst expression = node.getAttribute('[class]');\n\t\tthis.classFunction = module.makeFunction(expression);\n\t\t// this.classList = [...node.classList.keys()];\n\t\t// console.log('ClassDirective.onInit', this.classList, expression);\n\t}\n\n\tonChanges(changes) {\n\t\tconst context = Module.getContext(this);\n\t\tconst module = context.module;\n\t\tconst node = context.node;\n\t\tconst classList = module.resolve(this.classFunction, changes, this);\n\t\tObject.keys(classList).forEach(key => {\n\t\t\tif (classList[key]) {\n\t\t\t\tnode.classList.add(key);\n\t\t\t} else {\n\t\t\t\tnode.classList.remove(key);\n\t\t\t}\n\t\t});\n\t\t// console.log('ClassDirective.onChanges', classList);\n\t}\n\n}\n\nClassDirective.meta = {\n\tselector: `[[class]]`,\n};\n","import { fromEvent } from 'rxjs';\nimport { shareReplay, takeUntil } from 'rxjs/operators';\nimport Directive from '../core/directive';\nimport Module from '../module/module';\n\nconst EVENTS = ['click', 'mousedown', 'mouseup', 'touchstart', 'touchmove', 'touchend', 'keydown', 'keyup', 'input', 'change', 'loaded'];\n\nexport default class EventDirective extends Directive {\n\n\tonInit() {\n\t\tconst context = Module.getContext(this);\n\t\tconst module = context.module;\n\t\tconst node = context.node;\n\t\tconst selector = context.selector;\n\t\tconst parentInstance = context.parentInstance;\n\t\tconst event = this.event = selector.replace(/\\[|\\]|\\(|\\)/g, '');\n\t\tconst event$ = this.event$ = fromEvent(node, event).pipe(shareReplay(1));\n\t\tconst expression = node.getAttribute(`(${event})`);\n\t\tif (expression) {\n\t\t\tconst outputFunction = module.makeFunction(expression, ['$event']);\n\t\t\tevent$.pipe(\n\t\t\t\ttakeUntil(this.unsubscribe$)\n\t\t\t).subscribe(event => {\n\t\t\t\t// console.log(parentInstance);\n\t\t\t\tmodule.resolve(outputFunction, parentInstance, event);\n\t\t\t});\n\t\t} else {\n\t\t\tparentInstance[`${event}$`] = event$;\n\t\t}\n\t\t// console.log('EventDirective.onInit', 'selector', selector, 'event', event);\n\t}\n\n}\n\nEventDirective.meta = {\n\tselector: `[(${EVENTS.join(')],[(')})]`,\n};\n","import Context from '../core/context';\n// import Component from '../component/component';\n\nexport default class ForItem extends Context {\n\n\t// !!! try with payload options { key, $key, value, $value, index, count } or use onInit()\n\n\tconstructor(key, $key, value, $value, index, count, parentInstance) {\n\t\t// console.log('ForItem', arguments);\n\t\tsuper(parentInstance);\n\t\t/*\n\t\tsuper(parentInstance, {\n\t\t\t[key]: {\n\t\t\t\tget: function() {\n\t\t\t\t\treturn this.$key;\n\t\t\t\t},\n\t\t\t\tset: function(key) {\n\t\t\t\t\tthis.$key = key;\n\t\t\t\t}\n\t\t\t},\n\t\t\t[value]: {\n\t\t\t\tget: function() {\n\t\t\t\t\treturn this.$value;\n\t\t\t\t},\n\t\t\t\tset: function(value) {\n\t\t\t\t\tthis.$value = value;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\t*/\n\t\tthis[key] = $key;\n\t\tthis[value] = $value;\n\t\tthis.index = index;\n\t\tthis.count = count;\n\t}\n\n\tget first() { return this.index === 0; }\n\n\tget last() { return this.index === this.count - 1; }\n\n\tget even() { return this.index % 2 === 0; }\n\n\tget odd() { return !this.even; }\n\n}\n","import Structure from '../core/structure';\nimport Module from '../module/module';\nimport ForItem from './for.item';\n\nexport default class ForStructure extends Structure {\n\n\tonInit() {\n\t\tconst context = Module.getContext(this);\n\t\tconst module = context.module;\n\t\tconst node = context.node;\n\t\tconst forbegin = this.forbegin = document.createComment(`*for begin`);\n\t\tnode.parentNode.replaceChild(forbegin, node);\n\t\tconst forend = this.forend = document.createComment(`*for end`);\n\t\tforbegin.parentNode.insertBefore(forend, forbegin.nextSibling);\n\t\tconst expression = node.getAttribute('*for');\n\t\tnode.removeAttribute('*for');\n\t\tconst tokens = this.tokens = this.getExpressionTokens(expression);\n\t\tthis.forFunction = module.makeFunction(tokens.iterable);\n\t\tthis.instances = [];\n\t}\n\n\tonChanges(changes) {\n\t\tconst context = Module.getContext(this);\n\t\tconst module = context.module;\n\t\tconst node = context.node;\n\t\t// resolve\n\t\tconst tokens = this.tokens;\n\t\tlet result = module.resolve(this.forFunction, changes, this) || [];\n\t\tconst isArray = Array.isArray(result);\n\t\tconst array = isArray ? result : Object.keys(result);\n\t\tconst total = array.length;\n\t\tconst previous = this.instances.length;\n\t\tlet nextSibling = this.forbegin.nextSibling;\n\t\tfor (let i = 0; i < Math.max(previous, total); i++) {\n\t\t\tif (i < total) {\n\t\t\t\tconst key = isArray ? i : array[i];\n\t\t\t\tconst value = isArray ? array[key] : result[key];\n\t\t\t\tif (i < previous) {\n\t\t\t\t\t// update\n\t\t\t\t\t// const clonedNode = nextSibling;\n\t\t\t\t\tconst instance = this.instances[i];\n\t\t\t\t\tinstance[tokens.key] = key;\n\t\t\t\t\tinstance[tokens.value] = value;\n\t\t\t\t\t// module.parse(clonedNode, instance);\n\t\t\t\t\tnextSibling = nextSibling.nextSibling;\n\t\t\t\t} else {\n\t\t\t\t\t// create\n\t\t\t\t\tconst clonedNode = node.cloneNode(true);\n\t\t\t\t\tthis.forend.parentNode.insertBefore(clonedNode, this.forend);\n\t\t\t\t\tconst args = [tokens.key, key, tokens.value, value, i, total, context.parentInstance]; // !!! context.parentInstance unused?\n\t\t\t\t\tconst instance = module.makeInstance(clonedNode, ForItem, context.selector, context.parentInstance, args);\n\t\t\t\t\tconst forItemContext = Module.getContext(instance);\n\t\t\t\t\t// console.log(clonedNode, forItemContext.instance.constructor.name);\n\t\t\t\t\tmodule.compile(clonedNode, forItemContext.instance);\n\t\t\t\t\t// module.parse(clonedNode, instance);\n\t\t\t\t\tnextSibling = clonedNode.nextSibling;\n\t\t\t\t\tthis.instances.push(instance);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// remove\n\t\t\t\tconst instance = this.instances[i];\n\t\t\t\tconst context = Module.getContext(instance);\n\t\t\t\tconst node = context.node;\n\t\t\t\tnode.parentNode.removeChild(node);\n\t\t\t\tmodule.remove(node);\n\t\t\t}\n\t\t}\n\t\tthis.instances.length = array.length;\n\t\t// console.log(this.instances, tokens);\n\t}\n\n\tgetExpressionTokens(expression) {\n\t\tif (expression === null) {\n\t\t\tthrow ('invalid for');\n\t\t}\n\t\tif (expression.trim().indexOf('let ') === -1 || expression.trim().indexOf(' of ') === -1) {\n\t\t\tthrow ('invalid for');\n\t\t}\n\t\tconst expressions = expression.split(';').map(x => x.trim()).filter(x => x !== '');\n\t\tconst forExpressions = expressions[0].split(' of ').map(x => x.trim());\n\t\tlet value = forExpressions[0].replace(/\\s*let\\s*/, '');\n\t\tconst iterable = forExpressions[1];\n\t\tlet key = 'index';\n\t\tconst keyValueMatches = value.match(/\\[(.+)\\s*,\\s*(.+)\\]/);\n\t\tif (keyValueMatches) {\n\t\t\tkey = keyValueMatches[1];\n\t\t\tvalue = keyValueMatches[2];\n\t\t}\n\t\tif (expressions.length > 1) {\n\t\t\tconst indexExpressions = expressions[1].split(/\\s*let\\s*|\\s*=\\s*index/).map(x => x.trim());\n\t\t\tif (indexExpressions.length === 3) {\n\t\t\t\tkey = indexExpressions[1];\n\t\t\t}\n\t\t}\n\t\treturn { key, value, iterable };\n\t}\n\n}\n\nForStructure.meta = {\n\tselector: '[*for]',\n};\n","import Structure from '../core/structure';\nimport Module from '../module/module';\n\nexport default class IfStructure extends Structure {\n\n\tonInit() {\n\t\tconst context = Module.getContext(this);\n\t\tconst module = context.module;\n\t\tconst node = context.node;\n\t\tconst ifbegin = this.ifbegin = document.createComment(`*if begin`);\n\t\tnode.parentNode.replaceChild(ifbegin, node);\n\t\tconst ifend = this.ifend = document.createComment(`*if end`);\n\t\tifbegin.parentNode.insertBefore(ifend, ifbegin.nextSibling);\n\t\tconst expression = node.getAttribute('*if');\n\t\tthis.expression = expression;\n\t\tthis.ifFunction = module.makeFunction(expression);\n\t\tconst clonedNode = node.cloneNode(true);\n\t\tclonedNode.removeAttribute('*if');\n\t\tthis.clonedNode = clonedNode;\n\t\t// console.log('expression', expression);\n\t}\n\n\tonChanges(changes) {\n\t\tconst context = Module.getContext(this);\n\t\tconst module = context.module;\n\t\t// console.log('IfStructure.onChanges', changes, this.expression);\n\t\tconst value = module.resolve(this.ifFunction, changes, this);\n\t\tif (value) {\n\t\t\tif (!this.clonedNode.parentNode) {\n\t\t\t\tthis.ifend.parentNode.insertBefore(this.clonedNode, this.ifend);\n\t\t\t\tmodule.compile(this.clonedNode);\n\t\t\t}\n\t\t} else {\n\t\t\tif (this.clonedNode.parentNode) {\n\t\t\t\tthis.clonedNode.parentNode.removeChild(this.clonedNode);\n\t\t\t\tmodule.remove(this.clonedNode);\n\t\t\t}\n\t\t}\n\t}\n\n}\n\nIfStructure.meta = {\n\tselector: '[*if]',\n};\n","import Directive from '../core/directive';\nimport Module from '../module/module';\n\nexport default class InnerHtmlDirective extends Directive {\n\n\tonInit() {\n\t\tconst context = Module.getContext(this);\n\t\tconst node = context.node;\n\t\tconst selector = context.selector;\n\t\tconst key = selector.replace(/\\[(.+)\\]/, (...matches) => {\n\t\t\treturn matches[1];\n\t\t});\n\t\tlet expression = node.getAttribute(key);\n\t\tif (!expression) {\n\t\t\tthrow (`invalid ${key}`);\n\t\t}\n\t\tif (key === '[innerHTML]') {\n\t\t\texpression = `{{${expression}}}`;\n\t\t}\n\t\tthis.innerHtmlExpression = expression;\n\t\t// console.log('InnerHtmlDirective.onInit', node, expression, key);\n\t}\n\n\tonChanges(changes) {\n\t\tconst context = Module.getContext(this);\n\t\tconst innerHTML = context.module.evaluate(this.innerHtmlExpression, changes);\n\t\t// console.log('InnerHtmlDirective.onChanges', this.innerHtmlExpression, innerHTML);\n\t\tconst node = context.node;\n\t\tnode.innerHTML = innerHTML;\n\t}\n\n}\n\nInnerHtmlDirective.meta = {\n\tselector: `[[innerHTML]],[innerHTML]`\n};\n","export default class JsonPipe {\n\n\tstatic transform(value) {\n\t\treturn JSON.stringify(value);\n\t}\n\n}\n\nJsonPipe.meta = {\n\tname: 'json',\n};\n","import Directive from '../core/directive';\nimport Module from '../module/module';\n\nexport default class StyleDirective extends Directive {\n\n\tonInit() {\n\t\tconst context = Module.getContext(this);\n\t\tconst module = context.module;\n\t\tconst node = context.node;\n\t\tconst expression = node.getAttribute('[style]');\n\t\tthis.styleFunction = module.makeFunction(expression);\n\t\t// console.log('StyleDirective.onInit', expression);\n\t}\n\n\tonChanges(changes) {\n\t\tconst context = Module.getContext(this);\n\t\tconst module = context.module;\n\t\tconst node = context.node;\n\t\tconst style = module.resolve(this.styleFunction, changes, this);\n\t\tObject.keys(style).forEach(key => {\n\t\t\tnode.style[key] = style[key];\n\t\t});\n\t\t// console.log('StyleDirective.onChanges', changes, style);\n\t}\n\n}\n\nStyleDirective.meta = {\n\tselector: `[[style]]`\n};\n"]}